/*! 京东商城 jimi 2017-06-30 11:01 */
function cleanBr(str){return str.replace(/\r\n|\n/g," ")}function parseURLParam(){var obj=new Object,param=window.location.search;if(!param)return obj;"?"==param[0]&&(param=param.substring(1,param.length));for(var skuId,list=param.split("&"),i=0;i<list.length;i++){if(0==list[i].indexOf("source")){var source=list[i].split("=")[1];obj.source=source}if(0==list[i].indexOf("productId")&&(skuId=parseInt(list[i].split("=")[1]),obj.productId=skuId),0==list[i].indexOf("testAddress")&&(obj.testAddress=decodeURIComponent(list[i].split("=")[1])),0==list[i].indexOf("pagetype")){var pagetype=list[i].split("=")[1];obj.pagetype=pagetype}if(0==list[i].indexOf("pagevalue")){var pagevalue=list[i].split("=")[1];obj.pagevalue=pagevalue}if(0==list[i].indexOf("c3")){var c3=list[i].split("=")[1];obj.c3=c3}if(0==list[i].indexOf("orderId")){var orderId=list[i].split("=")[1];obj.orderId=orderId}if(0==list[i].indexOf("venderId")){var venderId=list[i].split("=")[1];obj.venderId=venderId}if(0==list[i].indexOf("promotionId")){var promotionId=list[i].split("=")[1];obj.promotionId=promotionId}if(0==list[i].indexOf("terminal")){var terminal=list[i].split("=")[1];obj.terminal=terminal}if(0==list[i].indexOf("invitingUser")){var invitingUser=list[i].split("=")[1];obj.invitingUser=invitingUser}if(0==list[i].indexOf("chatId")){var chatId=list[i].split("=")[1];obj.chatId=chatId}if(0==list[i].indexOf("entry")){var entry=list[i].split("=")[1];obj.entry=entry}if(0==list[i].indexOf("referer")){var referer=list[i].split("=")[1];obj.referer=referer}}return obj}function ReplaceTags(xStr){return xStr=xStr.replace(/<\/?[^>]+>/gi,"")}function replaceSpecialChart(inputStr){var temp=inputStr;return null!=temp&&(temp=temp.replaceAll("<","&lt;"),temp=temp.replaceAll(">","&gt;"),temp=temp.replaceAll('"',"&quot;")),temp}function getPosition(ele){return{top:$(ele).offset().top,left:$(ele).offset().left}}function isCustomerEntrance(){return"customer"==window.entrance}function windowclose(){var browserName=navigator.appName;if("Netscape"==browserName){$(document).attr("title","\u65b0\u7684\u6807\u7b7e\u9875"),window.open("","_self",""),window.close(),window.location.replace("about:blank");var opened=window.open("about:blank","_self");opened.opener=null,opened.close()}else window.opener=null,window.open("","_top"),window.close()}function statisticAjaxReq(url,data,sucessHandle,errorHandle){return data=$.extend(data,{source:window.jimiSource}),$.ajax({url:url,type:"post",dataType:"json",data:data,success:sucessHandle,error:errorHandle})}function sendSpReq(data){data=$.extend(data,{source:window.jimiSource,__:$.cookie("_robotAccess_"),_:(new Date).getTime()}),$('<img src="//sp-jimi.jd.com/userAction/insert?'+$.param(data)+'"/>')}function getLastestMonthOrder(callback){function callSuccess(data){if(data&&data.state&&data.data){data.refreshContent=data.switchWare=!1;var newAnswer=new AnswerFactory.createAnswer("orderList",data),ele=$("#orderListDiv");newAnswer.show(ele,!1,!1),$(window).trigger("resize")}else $("#orderListDiv").html('<div class="jimi-noOrder-jumbotron"><p>\u60a8\u6700\u8fd1\u6ca1\u6709\u8ba2\u5355\u54e6\uff5e</p></div>');callback&&callback(data)}var isLogin=package("v.login").isLogin();isLogin&&$.ajax({type:"get",url:"/lastestMonthOrder/getLatestMonthOrderList.action?t="+(new Date).getTime(),success:callSuccess,dataType:"json"})}function getProductInfo(){function callSuccess(data){if(data&&data.state){var newAnswer=new AnswerFactory.createAnswer(data.resultType,data),ele=$("#productDetailDiv");newAnswer.show(ele,!1,!1);var param=skipImParamBuild(data.wareDetailsBean),skipURL="//chat.jd.com/index.action?"+param;$(".service-online").find("a").attr("href",skipURL),$.ajax({type:"get",url:"//chat1.jd.com/api/checkChat?pid="+productId,dataType:"jsonp",success:function(data){1!=data.code&&3!=data.code?$(".service-online").hide():$(".service-online").show()},error:function(data){$(".service-online").hide()}}),$(window).trigger("resize")}}$.ajax({type:"get",url:"/product/getProductInfo.action?t="+(new Date).getTime(),data:{productId:productId},success:callSuccess,dataType:"json"})}function skipImParamBuild(data){var param="pid="+data.wid+"&";if(data.imageurl){for(var imageURL=data.imageurl,re=/http:\/\/img.*.360buyimg.com\/n[^\/]*\/(.*)/gi,r="";r=re.exec(imageURL);)imageURL=r[1];param=param+"imgUrl="+encodeURI(encodeURI(imageURL))+"&"}if(data.wmeprice&&(param=param+"price="+encodeURI(encodeURI(data.wmeprice))+"&"),data.stock&&(param=param+"stock="+encodeURI(encodeURI(data.stock))+"&"),data.averageScore&&(param=param+"score="+encodeURI(encodeURI(data.averageScore))+"&"),data.commentNum&&(param=param+"commentNum="+encodeURI(encodeURI(data.commentNum))+"&"),data.slogan&&(param=param+"advertiseWord="+encodeURI(encodeURI(data.slogan))+"&"),data.goodRate){var evaluationRate=data.goodRate,index=evaluationRate.indexOf("%");evaluationRate=evaluationRate.substring(0,index),param=param+"evaluationRate="+encodeURI(encodeURI(evaluationRate))+"&"}return data.service&&(param=param+"services="+encodeURI(encodeURI(data.service))+"&"),data.wname&&(param=param+"wname="+encodeURI(encodeURI(data.wname))),param}function showMes(name,message,obj){if("\u6211"==name){var question=new AnswerFactory.createAnswer("question",message),ele=$("#chatcontent");question.show(ele,!0,!0),$("#text-in").val("")}else if("JIMI"==name){var data={answer:message,fe:!0},answer=new AnswerFactory.createAnswer("common",data),ele=$("#chatcontent");answer.show(ele,!0,!0)}setScroll()}function replaceMsg(message,item){item.find(".mm .wel").html(message),setScroll()}function setScroll(){var $nano=$(".l-area-content .nano");if($nano.nanoScroller({alwaysVisible:!0}),$nano.nanoScroller({scroll:"bottom"}),$(".l-area-content").find(".normal").length>0&&"block"==$(".pane").css("display")){var $thumb=$(".l-area-content .thumb"),$normal=$(".l-area-content .normal");$normal.hide(),$thumb.show(),$(".top-banner").addClass("has-thumb");var view=package("v.adjustView");view.config({minHeight:200,container:0,chatcontent:154,inputWidth:16}),view.adaptHeight()}}function scrollTo(node,parent,justify){var $nano=$(".l-area-content .nano"),justify=justify||10;$nano.nanoScroller({alwaysVisible:!0,scrollTop:node.get(0).offsetTop+parent.get(0).offsetTop+justify})}function autoScroll(){var $lastDiv=$("#chatcontent>div:last"),lastTop=getPosition($lastDiv).top+$lastDiv.height(),inputTop=getPosition($(".edit-block")).top;lastTop>inputTop&&inputTop+110>lastTop&&setScroll()}function _restartVoluntary(){voluntarySocket||(voluntaryTimer&&(clearTimeout(voluntaryTimer),voluntaryTimer=null),voluntaryTimer=setTimeout(function(){package("v.socket").voluntary(),voluntarySocket=!0},6e4))}function add(){var strInput=$.trim($("#text-in").val());if(1==$("#sugguestions").is(":visible")){var sugs=$("#sugguestions .hover");if(1==sugs.length)return void sugs.find("a").trigger("click")}if(strInput.length>100){var $tips=$(".input-tips");return void($($tips).is(":animated")||$($tips).animate({top:"-28px"},120).animate({top:"-25px"},120).animate({top:"-28px"},100).animate({top:"-25px"},100))}oldQuestion==defaultInput&&$("#text-in").val(strInput.replaceAll(defaultInput,""));var tempStrInput=strInput.replace(/<.*?>/g,"");tempStrInput=replaceSpecialChart(tempStrInput),0!=tempStrInput.length&&tempStrInput!=defaultInput?(oldQuestion="",showMes("\u6211",tempStrInput),sendRequest(tempStrInput,0)):$("#text-in").focus(),$("#sugguestions").hide(),_restartVoluntary(),voluntarySocket=!0}function sendClick(type,id,showMsg,commandNo,sceneNo,faqShowSequence,ele,feedbackFAQItem,callBack,answer){var $this=$(ele),cateId=$this.data("cateid"),classifyName=$this.data("classifyname"),originquestion=($this.data("modelname"),$this.parent().data("requesttext"));if(cateId||classifyName){var affixQuestions={},$questions=$this.parent().find(".common-question-bg");affixQuestions.index=faqShowSequence-1;var $parent=$this.parent();affixQuestions.classifyName=$parent.data("classifyname"),affixQuestions.question=originquestion,affixQuestions.list=[],_.each($questions,function(dom){var $dom=$(dom);affixQuestions.list.push({question:$dom.html(),cateId:$dom.data("cateid"),classifyName:$dom.data("classifyname"),modelName:$dom.data("modelname")})}),affixParam={affixQuestions:msJSON.stringify(affixQuestions)}}$("#sugguestions").hide(),$("#text-in").focus(),$("#text-in").val("");var temp=showMsg;if(temp=temp.replaceAll("&lt;","<"),temp=temp.replaceAll("&gt;",">"),temp=temp.replaceAll("&quot;",'"'),temp=temp.replaceAll("&qpos;","'"),temp=temp.replaceAll("&nbsp;"," "),oldQuestion="",showMes("\u6211",temp),callBack){var content={session_id:package("v.login").sessionId||"",query_click_flag:"1",faq_info:showMsg||"",faq_time:(new Date).format("yyyy-MM-dd hh:mm:ss"),user_query:window.inputString||"",create_time:(new Date).format("yyyy-MM-dd hh:mm:ss")};$.ajax({type:"get",url:"//chat-dc.jd.com/sendMsg/send.html?typeCode=JimiSearchStaticMessage&content="+JSON.stringify(content),success:{}})}if(answer){affixParam=null,showMes("JIMI",answer);var content={click_ques:temp,answer:answer,sessionid:package("v.login").sessionId||"",messageid:window.messageid||""};return void $.ajax({type:"get",url:"//chat-dc.jd.com/sendMsg/send.html?typeCode=jimi_faq_feedback&content="+JSON.stringify(content),success:{}})}if(!commandNo){var askContent=faqShowSequence+"\u3001"+showMsg+"&&&id="+id;return void sendRequest(showMsg,type,askContent,commandNo,"","","","",feedbackFAQItem)}type&&faqShowSequence&&(showMsg=faqShowSequence+"\u3001"+showMsg),sceneNo?sendRequest(id,type,showMsg,commandNo,sceneNo,"","","",feedbackFAQItem):sendRequest(id,type,showMsg,commandNo,"","","","",feedbackFAQItem)}function sendData(groupid,sid,question,answer,a){$(a).addClass("pchecked");var postData={groupId:groupid,sid:sid};0!=answer&&(postData.answer=answer),$.ajax({type:"post",url:"/preFaq/click.action",data:postData,success:{}});var temp1,temp=question;if(0!=answer){var temp1=answer;temp1=temp1.replaceAll("&lt;","<"),temp1=temp1.replaceAll("&gt;",">"),temp1=temp1.replaceAll("&quot;",'"'),temp1=temp1.replaceAll("&qpos;","'"),temp1=temp1.replaceAll("&nbsp;"," ")}temp=temp.replaceAll("&lt;","<"),temp=temp.replaceAll("&gt;",">"),temp=temp.replaceAll("&quot;",'"'),temp=temp.replaceAll("&qpos;","'"),temp=temp.replaceAll("&nbsp;"," "),oldQuestion="",showMes("\u6211",temp),0!=answer?setTimeout(function(){showMes("JIMI",temp1)},500):sendRequest(question,0)}function sendRequest(requestText,render,showMsg,commandNo,sceneNo,isCon,$replaceMsg,callback,feedbackFAQItem){function errorAlert(){$("#text-in").focus()}var text=requestText.toString();text=text.replaceAll("&lt;","<"),text=text.replaceAll("&gt;",">"),text=text.replaceAll("&quot;",'"'),text=text.replaceAll("&qpos;","'"),text=text.replaceAll("&nbsp;"," "),text=text.replaceAll("&nbsp;"," "),text=text.replace(/<\/?.+?>/g,""),text=text.replaceAll("<","&lt;"),text=text.replaceAll(">","&gt;");var promotionId=$("#promotionId").val(),urlParamObj=parseURLParam(),testAddress=urlParamObj.testAddress,feedbackAnswerInfo=$.extend({},window.feedbackAnswerInfo);switch(delete window.feedbackAnswerInfo,render){case 0:var postData={requestText:text,askContent:showMsg,commandNo:commandNo,sceneNo:sceneNo,correctUse:isCon,promotionId:promotionId,productId:void 0==productId?"":productId,testAddress:testAddress,pagetype:window.pagetype||"",pagevalue:window.pagevalue||"",terminal:window.terminal||"",venderId:window.venderId||"",orderId:window.orderId||"",c3:window.c3||"",feedbackFAQItem:feedbackFAQItem,variables:window.variables};feedbackAnswerInfo&&null!=feedbackAnswerInfo.interactiveId&&(postData.info=JSON.stringify(feedbackAnswerInfo),feedbackAnswerInfo=void 0),Form.formData&&(postData.form=Form.formData),source1?postData.source=source1:postData.source=jimiSource||"",affixParam&&(_.extend(postData,affixParam),affixParam=null),$.ajax({type:"post",url:"/ask/ask.action?t="+(new Date).getTime(),data:postData,success:function(ret){var package=window["package"]||function(){throw new Error("the function package is not undefined")}(),res=JSON.parse(ret.data);res.answers.type=!1,window.messageid=ret.msgid;var tid,version;if(res.hasOwnProperty("tid")&&(tid=res.tid),res.hasOwnProperty("chatinfo")&&res.chatinfo.hasOwnProperty("version")&&(version=res.chatinfo.version),"string"==typeof res.data&&(res=JSON.parse(res.data)),/^\{.*\}$/.test(res.answers.answer)){var tempAnswer=JSON.parse(res.answers.answer);res.answers.answer=tempAnswer}res.answers.hasOwnProperty("ext_property")||(res.answers.ext_property={}),tid&&(res.answers.ext_property.tid=tid),version&&(res.answers.ext_property.version=version),res.answers.requestText=text;var ext_property="undefined"!=typeof res.answers.ext_property?res.answers.ext_property:{};return ext_property.inviteFlag&&(isShowSatisfyModal=!0),ext_property.feedbackType&&"openFaq-feedback"==ext_property.feedbackType?(res.answers.type=!0,void package("v.componentAnswer").callbackSuccess2(res,$replaceMsg)):(void 0!=ext_property.add_post_answer&&(res.answers.extra=ext_property.add_post_answer),void 0!=window.entry&&void 0!=window.chatId&&(21==res.answers.answer_note?res.answers.answer=res.answers.answer.replace(/(\?entry=[^\"]*)/,"?entry="+window.entry+"&chatId="+window.chatId):12==res.answers.answer_note&&/.*chat.*jd\.com.*/.test(res.answers.answer)&&(res.answers.answer=res.answers.answer.replace(/(\?entry=[^\"]*)/,"?entry="+window.entry+"&chatId="+window.chatId))),void package("v.componentAnswer").callbackSuccess2(res,$replaceMsg))},error:errorAlert,dataType:"JSON"});break;case 1:var postData={id:text,askContent:showMsg,commandNo:commandNo,source:jimiSource||"",productId:void 0==productId?"":productId};"commandForSearchByFaqId"==commandNo&&_.extend(postData,{input:$("#sugguestions").data("input"),data:msJSON.stringify($("#sugguestions").data("data"))}),sceneNo&&(postData.sceneNo=sceneNo),$.ajax({type:"post",url:"/faqAsk/getFaqAnswerByFaqId.action?t="+(new Date).getTime(),data:postData,success:function(ret){var res=JSON.parse(ret.data);package("v.componentAnswer").callbackSuccess2(res,$replaceMsg)},error:errorAlert,dataType:"JSON"});break;case 2:var urlParamObj=parseURLParam(),testAddress=urlParamObj.testAddress;$.ajax({type:"post",url:"/ask/welcome.action?t="+(new Date).getTime(),success:function(ret){var ret=ret||{};ret.resultTypebak=ret.resultType,ret.requestText=text,ret.askContent=showMsg,ret.commandNo=sceneNo,ret.sceneNo=sceneNo,ret.source=jimiSource||"",ret.refreshContent=ret.switchWare=!1},data:{productId:void 0==productId?"":productId,cateId:void 0==cateId?"":cateId,source:jimiSource||"",commandNo:"greetingCommand",testAddress:testAddress},error:errorAlert,dataType:"JSON"}),$.ajax({type:"post",url:"/dataStatistic/initDataStatistic.action?t="+(new Date).getTime(),dataType:"JSON",data:{productId:void 0==productId?"":productId,source:jimiSource||""},success:function(ret){}});break;case 3:var ele=$("#chatcontent");$.ajax({type:"post",url:"/welcome/openSentence.action",success:function(data){if(1==data.code){var ret=JSON.parse(data.data);if(ret.answers.open_content){var openRet={};openRet.ptype="p_plain_text_answer",openRet.answers={},openRet.answers.answer=JSON.parse(ret.answers.open_content).content;var openAnswer=AnswerFactory.createAnswer(openRet);openAnswer.show(ele,!0,!0)}if(ret.answers.answer){var answer=AnswerFactory.createAnswer(ret);answer.show(ele,!0,!0)}}},data:{source:jimiSource||"",productId:productId||""},error:errorAlert,dataType:"JSON"})}source1&&(window.jimiSource=source1)}function callbackSuccess(data,$replaceMsg){if("p_component_answer"==data.ptype)return void handleCompAnswer(data);var answer,ele=$("#chatcontent");answer=AnswerFactory.createAnswer(data.ptype,data.answers),$replaceMsg&&$replaceMsg.removeClass().html(""),callback&&callback(data.answer),answer.show($replaceMsg||ele,!0,!0),setScroll()}function handleCompAnswer(data){var result1=data.answers.answer,result2=JSON.parse(result1),result3=result2.dataMap,tmpl=result2.html;$.template("template",unescape(tmpl));var html=$("<div></div>").append($.tmpl("template",result3)).html();showMes("JIMI",html)}function preFaq(result){var answer,ele=$("#chatcontent");$.ajax({type:"GET",url:"/preFaq/get.action",dataType:"JSON",data:{productId:void 0==productId?"":productId,source:window.jimiSource||"",orderId:window.orderId||"",c3:window.c3||""},success:function(data){data.success&&data.questions&&data.questions.length>0?(_.extend(data,{initword:result.answer}),answer=AnswerFactory.createAnswer("preFaq",data),answer.show(ele,!0,!0)):(_.extend(data,{initword:result.answer}),answer=AnswerFactory.createAnswer("preFaq",data),answer.show(ele,!0,!0))},error:function(){var empty={};_.extend(empty,{initword:result.answer}),answer=AnswerFactory.createAnswer("preFaq",empty),answer.show(ele,!0,!0)}})}function triggerLandImg(para,url){var pointUrl=url||"//chat-dc.jd.com/sendMsg/send.html",img=new Image,src=pointUrl+"?typeCode="+para.typeCode+"&content="+para.content;img.src=src,img.style.display="none",document.body.appendChild(img)}function triggerLandfill(para,url){var pointUrl=url||"//chat-dc.jd.com/sendMsg/send.html",src=pointUrl+"?typeCode="+para.typeCode+"&content="+para.content;$.ajax({url:src,dataType:"jsonp"},function(){})}function cardPoint(data){var data=data||{};$(".f-card").off().on("click",".c-link",function(){var $q=$(this),parLst=$q.parents(".f-card"),param={},c_content="";param.event_time=(new Date).getTime(),param.event_type=1,param.component_type=$q.attr("data-type"),param.component_id=$q.attr("data-id"),param.component_location=$q.attr("data-position"),param.card_id=parLst.attr("data-id"),c_content=0==param.component_type?$q.find("img").attr("src"):$q.text(),param.component_content=c_content,param.card_type=data.type,param.cid=data.sessionId,param.user_pin=data.pin,param.uuid=data.opensentenceUUID,param.source=window.jimiSource,param.version="jimi-web";var dataPara={typeCode:"jimi_dc_wrkf_2_log_question_cards",content:JSON.stringify(param)};triggerLandImg(dataPara)})}function fastEntryPoint(data){var data=data||{};$(".fast-entry").off().on("click",".f-link-a",function(){var $q=$(this),param={};param.event_time=(new Date).getTime(),param.event_type=1,param.entry_type=$q.attr("data-type"),param.entry_content=$q.text(),param.location=$q.attr("data-position"),param.source=window.jimiSource,param.version="jimi-web",param.cid=data.sessionId,param.user_pin=data.pin;var dataPara={typeCode:"jimi_dc_wrkf_2_log_quick_entry",content:JSON.stringify(param)};triggerLandImg(dataPara)})}String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s*|\s*$/g,"")}),String.prototype.replaceAll||(String.prototype.replaceAll=function(s1,s2){return this.replace(new RegExp(s1,"gm"),s2)}),package("v.shortcut.Dispatching",[],function(require,exports,moudle){return function($,window){function district(dom,onSccess,onShow,onInit){$.ajax({type:"post",url:"/delivery/deliveryInitAddress.action?t="+(new Date).getTime(),dataType:"json",scriptCharset:"utf-8"}).success(function(json){var initData=[],initCodeArr=[],areaData=json.data;areaData.province&&(initData.push(areaData.province),initCodeArr.push(areaData.province.selected.id)),areaData.city&&(initData.push(areaData.city),initCodeArr.push(areaData.city.selected.id)),areaData.area&&(initData.push(areaData.area),initCodeArr.push(areaData.area.selected.id)),areaData.fouth&&(initData.push(areaData.fouth),initCodeArr.push(areaData.fouth.selected.id)),panda.ready(function(require,exports,module){var district=new panda.widget.manager.get(require("widget.District"),{target:panda.query(dom),url:"/delivery/getNextArea.action",select:1,level:4,title:areaData.address,initData:initData,initCode:initCodeArr,mouseLeaveHide:!0,onShow:function(){"function"==typeof onShow&&onShow()},onClose:function(){$(".j_dispatchingBottom").remove()},format:function(response){eval("response="+response);var data=[];if(response&&response.data)for(var i=0;i<response.data.length;i++){var area=response.data[i];data.push({name:area.name,id:area.id})}return"function"==typeof onInit&&onInit(),data},success:function(code,display){"function"==typeof onSccess&&onSccess(code,display)},debug:!1})})})}exports.drawMsgCod=function(dom){district(dom,function(code,display){$(dom).find(".text div").html(display.join(""))},null,function(){$(dom).find(".j_content").is(":hidden")&&$(dom).find(".text").trigger("click")})},exports.drawBuyConsult=function(dom,$select){district(dom,function(code,display){var result=display.join("");$(dom).find(".text div").html(result),$select.find(".text>div").html(result),$select.data("code",code),exports.searchService(code)},null,function(){$(dom).find(".j_content").is(":hidden")&&$(dom).find(".text").trigger("click")})},exports.draw=function(json){var id="districtarea";district($("#"+id)[0],function(code,display){$("#"+id).data("code",code),$(".text div","#"+id).html(display.join("")),$(".j_dispatchingBottom").remove(),exports.searchService(code)})},exports.searchService=function(code){var codeArr=code,nameArr=["provinceId","cityId","areaId","fouthId"];if(codeArr){var param={};$.each(codeArr,function(i,v){param[nameArr[i]]=v}),$.ajax({type:"post",url:"/delivery/delivery.action?t="+(new Date).getTime(),data:param,dataType:"json",scriptCharset:"utf-8"}).success(function(json){var goodsqarea=$("#district-result");goodsqarea.html(""),json.type="service",json.id="j_service"+(new Date).getTime();var html=(package("%7B%7Bif%20type%20%3D%3D%20%22goodsServiceGuide%22%20%7D%7D%3Cul%20class%3D%22jimi-goodsquery%22%20xmlns%3D%22http%3A//www.w3.org/1999/html%22%3E%3Cli%3E%u8BF7%u8F93%u5165%26nbsp%3B%3Clabel%20class%3D%22red%22%3E%u5546%u54C1%u94FE%u63A5%3C/label%3E%26nbsp%3B%u6216%26nbsp%3B%3Clabel%20class%3D%22red%22%3E%u5546%u54C1%u7F16%u53F7%3C/label%3E%uFF0CJIMI%u5C06%u5E2E%u60A8%u67E5%u8BE2%u8BE5%u5546%u54C1%u4EAB%u53D7%u7684%u552E%u540E%u670D%u52A1%u3002%3C/li%3E%3Cli%20class%3D%22linkURL%22%3E%u5546%u54C1%u94FE%u63A5%uFF0C%u4F8B%u5982%3Ahttp%3A//item.jd.com/939616.html%3C/li%3E%3Cli%3E%u5546%u54C1%u7F16%u53F7%uFF0C%u5982%u4F55%u67E5%u770B%uFF1F%3C/li%3E%3Cli%3E1.%u6253%u5F00%u5546%u54C1%u9875%u9762%3C/li%3E%3Cli%3E2.%u5F80%u4E0B%u62C9%u9875%u9762%uFF0C%u67E5%u770B%u201C%u5546%u54C1%u4ECB%u7ECD%u201D%u4E2D%u7684%u5546%u54C1%u7F16%u53F7%3C/li%3E%3C/ul%3E%7B%7Belse%20type%20%3D%3D%20%22idError%22%7D%7D%3Cul%20class%3D%22jimi-goodsquery%22%3E%3Cli%3E%u60A8%u8F93%u5165%u7684%u5546%u54C1%u7F16%u53F7%u4E0D%u6B63%u786E%uFF0CJIMI%u8BC6%u522B%u4E0D%u4E86%u5462%3C/li%3E%3Cli%3E%u60A8%u8BD5%u8BD5%u91CD%u65B0%u67E5%u8BE2%u540E%u518D%u8F93%u5165%uFF1F%3C/li%3E%3Cli%3E1.%u6253%u5F00%u5546%u54C1%u9875%u9762%3C/li%3E%3Cli%3E2.%u5F80%u4E0B%u62C9%u9875%u9762%uFF0C%u67E5%u770B%3Clabel%20class%3D%22bold%22%3E%u5546%u54C1%u4ECB%u7ECD%3C/label%3E%u4E2D%u7684%u5546%u54C1%u7F16%u53F7%3C/li%3E%3Cli%3E%u5982%u679C%u60A8%u8FD8%u662F%u627E%u4E0D%u5230%u5546%u54C1%u7F16%u53F7%uFF0C%u53EF%u4EE5%u8054%u7CFB%20%3Ca%20class%3D%22blue%22%20onclick%3D%22transformOut%28%29%22%3E%u4EBA%u5DE5%u5BA2%u670D%3C/a%3E%20%u5594%u3002%3C/li%3E%3C/ul%3E%7B%7Belse%20type%20%3D%3D%20%22wareAfsDetailJumpError%22%7D%7D%3Cul%20class%3D%22jimi-goodsquery%22%3E%3Cli%3E%u60A8%u60F3%u67E5%u8BE2%u5546%u54C1884641%u7684%u4EC0%u4E48%u4FE1%u606F%u5462%uFF1F%3C/li%3E%3Cli%20class%3D%22blue%22%3E%u5546%u54C1%u57FA%u672C%u4FE1%u606F%3C/li%3E%3Cli%20class%3D%22blue%22%3E%u5546%u54C1%u4FC3%u9500%u4FE1%u606F%3C/li%3E%3Cli%20class%3D%22blue%22%3E%u552E%u540E%u670D%u52A1%3C/li%3E%3C/ul%3E%7B%7Belse%20type%20%3D%3D%20%22goodsService%22%7D%7D%3Cul%20class%3D%22jimi-goodsquery%22%20style%3D%22width%3A%20410px%22%3E%3Cli%3E%u60A8%u6240%u67E5%u8BE2%u7684%u5546%u54C1%u662F%uFF1A%3C/li%3E%3Cli%20class%3D%22image%22%3E%3Cimg%20src%3D%22/jimi/img/goods-image.png%22%20width%3D%2250px%22%20height%3D%2250px%22%3E%3Cspan%20class%3D%22blue%22%3E%u6C83%u5BB6%20%u590F%u88C5%u5706%u9886%u65E0%u8896%u80CC%u5FC3%u88D9%u5047%u4E24%u4EF6%u5957%u4F18%u8D28%u96EA%u7EBA%u8FDE%u8863%u88D9%206516%20%u6854%u8272%u706B%u70ED%u652F%u6301%u8D27%u5230%u4ED8%u6B3E%uFF01%3C/span%3E%3C/li%3E%3Cli%3E%u672C%u4EA7%u54C1%u5168%u56FD%u8054%u4FDD%uFF0C%u4EAB%u53D7%u4E09%u5305%u670D%u52A1%uFF0C%u8D28%u4FDD%u671F%u4E3A%uFF1A%u4E8C%u5E74%u8D28%u4FDD%3C/li%3E%3Cli%3E%u5982%u56E0%u8D28%u91CF%u95EE%u9898%u6216%u6545%u969C%uFF0C%u51ED%u5382%u5546%u7EF4%u4FEE%u4E2D%u5FC3%u6216%u7279%u7EA6%u7EF4%u4FEE%u70B9%u7684%u8D28%u91CF%u68C0%u6D4B%u8BC1%u660E%uFF0C%u4EAB%u53D77%u65E5%u5185%u9000%u8D27%uFF0C15%u65E5%u5185%u6362%u8D27%uFF0C15%u65E5%u4EE5%u4E0A%u5728%u8D28%u4FDD%u671F%u5185%u4EAB%u53D7%u514D%u8D39%u4FDD%u4FEE%u7B49%u4E09%u8D39%u4FDD%u4FEE%u7B49%u4E09%u5305%u670D%u52A1%uFF01%3C/li%3E%3Cli%3E%u552E%u540E%u670D%u52A1%u7535%u8BDD%uFF1A400-820-8387%3C/li%3E%3Cli%3E%u54C1%u724C%u5B98%u65B9%u7F51%u7AD9%uFF1A%3Ca%20class%3D%22blue%22%20target%3D%22_blank%22%20href%3D%22%23%22%3Ehttp%3A//www.fujisu.com/cn/%3C/a%3E%3C/li%3E%3C/ul%3E%7B%7Belse%20type%20%3D%3D%20%22JDGoodsService%22%7D%7D%3Cul%20class%3D%22jimi-goodsquery%22%20style%3D%22width%3A%20410px%22%3E%3Cli%3E%u60A8%u6240%u67E5%u8BE2%u7684%u5546%u54C1%u662F%uFF1A%3C/li%3E%3Cli%20class%3D%22image%22%3E%3Cimg%20src%3D%22/jimi/img/goods-image.png%22%20width%3D%2250px%22%20height%3D%2250px%22%3E%3Cspan%20class%3D%22blue%22%3E%u6C83%u5BB6%20%u590F%u88C5%u5706%u9886%u65E0%u8896%u80CC%u5FC3%u88D9%u5047%u4E24%u4EF6%u5957%u4F18%u8D28%u96EA%u7EBA%u8FDE%u8863%u88D9%206516%20%u6854%u8272%u706B%u70ED%u652F%u6301%u8D27%u5230%u4ED8%u6B3E%uFF01%3C/span%3E%3C/li%3E%3Cli%3E%u60A8%u67E5%u8BE2%u7684%u5546%u54C1%u4EAB%u53D7%3Clabel%20class%3D%22red%22%3E%u4EAC%u4E1C%u81EA%u8425%3C/label%3E%u5546%u54C1%u552E%u540E%u670D%u52A1%uFF0C%3Clabel%20class%3D%22blue%22%3E%u67E5%u770B%u552E%u540E%u670D%u52A1%u8BE6%u60C5%3C/label%3E%3C/li%3E%3C/ul%3E%7B%7Belse%20type%20%3D%3D%20%22threeGoodsService%22%7D%7D%3Cul%20class%3D%22jimi-goodsquery%22%20style%3D%22width%3A%20410px%22%3E%3Cli%3E%u60A8%u6240%u67E5%u8BE2%u7684%u5546%u54C1%u662F%uFF1A%3C/li%3E%3Cli%20class%3D%22image%22%3E%3Cimg%20src%3D%22/jimi/img/goods-image.png%22%20width%3D%2250px%22%20height%3D%2250px%22%3E%3Cspan%20class%3D%22blue%22%3E%u6C83%u5BB6%20%u590F%u88C5%u5706%u9886%u65E0%u8896%u80CC%u5FC3%u88D9%u5047%u4E24%u4EF6%u5957%u4F18%u8D28%u96EA%u7EBA%u8FDE%u8863%u88D9%206516%20%u6854%u8272%u706B%u70ED%u652F%u6301%u8D27%u5230%u4ED8%u6B3E%uFF01%3C/span%3E%3C/li%3E%3Cli%3E%u60A8%u67E5%u8BE2%u7684%u5546%u54C1%u4EAB%u53D7%3Clabel%20class%3D%22red%22%3E%u7B2C%u4E09%u65B9%u5356%u5BB6%3C/label%3E%u5546%u54C1%u552E%u540E%u670D%u52A1%uFF0C%u67E5%u770B%u552E%u540E%u670D%u52A1%u8BE6%u60C5%3Cbr%3E%u60A8%u4E5F%u53EF%u4EE5%u54A8%u8BE2%3Clabel%20class%3D%22red%22%3E%u5356%u5BB6%u5BA2%u670D%3C/label%3E%u5594%u3002%3C/li%3E%3C/ul%3E%7B%7Belse%20type%20%3D%3D%20%22service%22%7D%7D%3Cdiv%20class%3D%22jimi-chat-title%22%3E%u8BE5%u5730%u533A%u652F%u6301%u7684%u914D%u9001%u670D%u52A1%uFF1A%3C/div%3E%7B%7Beach%20data%7D%7D%3Cdiv%20class%3D%22delivery-detail%20clearfix%22%3E%7B%7Bif%20deliveryServiceName%20%3D%3D%20%22211%u9650%u65F6%u8FBE%22%7D%7D%3Cdiv%20class%3D%22delivery-detail-img1%20fl%22%3E%3C/div%3E%7B%7Belse%20deliveryServiceName%20%3D%3D%20%22%u5927%u5BB6%u7535211%22%7D%7D%3Cdiv%20class%3D%22delivery-detail-img6%20fl%22%3E%3C/div%3E%7B%7Belse%20deliveryServiceName%20%3D%3D%20%22%u8D27%u5230%u4ED8%u6B3E%22%7D%7D%3Cdiv%20class%3D%22delivery-detail-img2%20fl%22%3E%3C/div%3E%7B%7Belse%20deliveryServiceName%20%3D%3D%20%22%u5B9A%u65F6%u8FBE%22%7D%7D%3Cdiv%20class%3D%22delivery-detail-img7%20fl%22%3E%3C/div%3E%7B%7Belse%20deliveryServiceName%20%3D%3D%20%22%u5F00%u7BB1%u9A8C%u673A%22%7D%7D%3Cdiv%20class%3D%22delivery-detail-img3%20fl%22%3E%3C/div%3E%7B%7Belse%20deliveryServiceName%20%3D%3D%20%22%u81EA%u63D0%22%7D%7D%3Cdiv%20class%3D%22delivery-detail-img8%20fl%22%3E%3C/div%3E%7B%7Belse%20deliveryServiceName%20%3D%3D%20%22%u591C%u95F4%u914D%22%7D%7D%3Cdiv%20class%3D%22delivery-detail-img4%20fl%22%3E%3C/div%3E%7B%7Belse%20deliveryServiceName%20%3D%3D%20%22%u6781%u901F%u8FBE%22%7D%7D%3Cdiv%20class%3D%22delivery-detail-img9%20fl%22%3E%3C/div%3E%7B%7Belse%20deliveryServiceName%20%3D%3D%20%22%u7B2C%u4E09%u65B9%u914D%u9001%22%7D%7D%3Cdiv%20class%3D%22delivery-detail-img10%20fl%22%3E%3C/div%3E%7B%7Belse%20deliveryServiceName%20%3D%3D%20%22%u552E%u540E%u5230%u5BB6%22%7D%7D%3Cdiv%20class%3D%22delivery-detail-img11%20fl%22%3E%3C/div%3E%7B%7Belse%20deliveryServiceName%20%3D%3D%20%22%u514D%u8FD0%u8D39%22%7D%7D%3Cdiv%20class%3D%22delivery-detail-img12%20fl%22%3E%3C/div%3E%7B%7Belse%20deliveryServiceName%20%3D%3D%20%22%u5FEB%u901F%u9000%u6B3E%22%7D%7D%3Cdiv%20class%3D%22delivery-detail-img13%20fl%22%3E%3C/div%3E%7B%7Belse%20deliveryServiceName%20%3D%3D%20%22%u4EAC%u4E1C%u914D%u9001%22%7D%7D%3Cdiv%20class%3D%22delivery-detail-img14%20fl%22%3E%3C/div%3E%7B%7Belse%20deliveryServiceName%20%3D%3D%20%22%u5148%u6B3E%u9001%u4EAC%u8C46%22%7D%7D%3Cdiv%20class%3D%22delivery-detail-img15%20fl%22%3E%3C/div%3E%7B%7Belse%7D%7D%3Cdiv%20class%3D%22delivery-detail-img1%20fl%22%3E%3C/div%3E%7B%7B/if%7D%7D%20%3Cp%20class%3D%22title%22%3E%3Ca%20href%3D%22%24%7BdeliveryServiceDetailURL%7D%22%20target%3D%22_blank%22%3E%24%7BdeliveryServiceName%7D%3C/a%3E%3C/p%3E%3Cp%3E%24%7BdeliveryServiceExplain%7D%3C/p%3E%3C/div%3E%7B%7B/each%7D%7D%20%7B%7B/if%7D%7D"),$("<div></div>").append($.tmpl("template",json)).html());goodsqarea.html(html),$(window).trigger("resize")})}},exports.init=function(){var $distMsg=$("#districtarea-msg");exports.drawMsgCod($distMsg[0]),$("[data-type=district-cod]").live("click",function(event){$distMsg.is(":hidden")&&($distMsg.find(".j_content").hide(),$distMsg.show());var x=event.clientX,y=event.clientY,wHeight=$(window).height(),wWidth=$(window).width(),jHeight=$distMsg.find(".j_content").height();$distMsg.find(".j_content").width();$distMsg.find(".text").trigger("click"),y+230>wHeight?$distMsg.css("top",y-jHeight-70+"px"):$distMsg.css("top",y-10+"px"),x+430>wWidth?$distMsg.css("left",x-20+"px"):$distMsg.css("left",x+320+"px")}),$("#district-consult").length||$("body").append('<div id="district-consult"></div>');var $districtConsult=$("#district-consult").hide(),interval=null,intervalWait=5e3;interval=setInterval(function(){var $districtSelect=$("#district-consult-select");$districtSelect.length&&(exports.drawBuyConsult($districtConsult[0],$("#district-consult-select")),clearInterval(interval)),intervalWait-=100,0>=intervalWait&&clearInterval(interval)},100);var hideWhenMouseleave=!0;$(document).on("click","#district-consult a[data-value]",function(){hideWhenMouseleave=!1}),$("#district-consult-select").live("mouseenter",function(event){if(hideWhenMouseleave=!0,$districtConsult.is(":hidden")&&($districtConsult.find(".j_content").hide(),$districtConsult.show()),!$districtConsult.find(".j_content").is(":visible")){var $this=$(this),offset=$this.offset();$districtConsult.find(".text").trigger("click"),$districtConsult.css("top",offset.top+2),$districtConsult.css("left",offset.left+$this.width()-50);var $whiteLine=$districtConsult.find(".district-line");$whiteLine.length||($whiteLine=$('<div class="district-line"></div>').appendTo($districtConsult.find(".j_content"))),$whiteLine.width($this.width()-2);var needHide=!1;$this.unbind("mouseleave").bind("mouseleave",function(){needHide=!0,hideCtl()}).unbind("mouseenter").bind("mouseenter",function(){needHide=!1}),$districtConsult.unbind("mouseleave").bind("mouseleave",function(){needHide=!0,hideCtl()}).unbind("mouseenter").bind("mouseenter",function(){needHide=!1});var hideTimeout=null,hideCtl=function(){clearTimeout(hideTimeout),hideTimeout=setTimeout(function(){needHide&&hideWhenMouseleave&&($districtConsult.hide(),clearTimeout(offsetHideTimeout))},50)},offsetHideTimeout=null;!function(){var func=arguments.callee;clearTimeout(offsetHideTimeout),offsetHideTimeout=setTimeout(function(){var currentOffset=$this.offset();offset.top!=currentOffset.top||offset.left!=currentOffset.left?($districtConsult.hide(),clearTimeout(offsetHideTimeout)):func()},50)}()}})},exports.district=district}(jQuery,window),exports}),package("v.follow",[],function(require,exports,moudle){
return function($,window,document){exports.getStatus=function($ele){var productIds=[];if($ele.find("a.note-btn").each(function(){var wid=$(this).attr("title","\u52a0\u5173\u6ce8").attr("productid");wid&&productIds.push(wid)}),productIds.length>0){var url="//follow.soa.jd.com/product/batchIsFollow?productIds="+productIds.join(",")+"&callback=?";$.getJSON(url,function(re){if(re.success){var query=[];for(var wid in re.data)re.data[wid]&&query.push("[productid="+wid+"]");query.length>0&&$ele.find("a.note-btn").filter(query.join(",")).addClass("noted").html("\u5df2\u5173\u6ce8").attr("title","\u5df2\u5173\u6ce8")}})}},function(){$(document).on("click",".isAddNote",function(){var ele=$(this);ele.blur();var wid=ele.attr("productId");if(ele.hasClass("noted")){if(window.confirm("\u786e\u5b9a\u8981\u53d6\u6d88\u5173\u6ce8\u8be5\u5546\u54c1\u5417\uff1f")){var url="//t.jd.com/product/cancelFollow.action?productId="+wid+"&callback=?";$.getJSON(url),$(this).removeClass("noted").html("\u52a0\u5173\u6ce8").attr("title","\u52a0\u5173\u6ce8")}}else{var url="//t.jd.com/product/followProduct.action?productId="+wid;$('<img style="display:none" src="'+url+'"/>').appendTo("body").remove(),$(this).addClass("noted").html("\u5df2\u5173\u6ce8").attr("title","\u5df2\u5173\u6ce8")}})}()}(jQuery,window,document),exports}),package("v.login",[],function(require,exports,moudle){return function($,window,document){function getPet(){$.ajax({type:"get",url:"/isShowPet.action",dataType:"json",success:function(res){1==res.isShowPet?(package("v.myjimi.adopt").init(""),isMyJimi=!0,$("#container #grkj").hide(),$("#embed #grkj").show(),$("#lyjimi").show()):(package("v.myspace").init(),$("#container #grkj").show(),$("#lyjimi").hide())},error:function(){package("v.myspace").init(),$("#lyjimi").hide()}})}function getUserState(){$.ajax({type:"get",url:"/ask/getUserState.action?t="+(new Date).getTime(),dataType:"json",success:function(res){if(window.userState=res,res){if($msgTipsParent.find(".jimi-noLogin-msgTips").length>0){$("#chatcontent .jimi-noLogin-blank").remove(),$msgTipsParent.find(".jimi-noLogin-msgTips").remove(),$jumbotronTipsParent.find(".jimi-noLogin-jumbotron").remove(),exports.getOrder(),getPet();var $lstLogin=$("#chatcontent .jimi_lists:last").find("[data-module='"+module+"']");if($lstLogin.length){var $replaceMsg=$("#chatcontent .jimi_lists:last"),question=$lstLogin.data("question");sendRequest(question,0,void 0,void 0,void 0,void 0,$replaceMsg)}else exports.delAllMsgTips()}}else $.inArray(jimiSource||"other",window.noLoginSourceList)>-1&&0==$msgTipsParent.find(".jimi-noLogin-msgTips").length&&(exports.showNoLoginTips(),getPet(),$(".masking-guide-start").length>0&&($(".masking-guide-start").remove(),$("#masterDiv").hide()))}})}function init(){getPet(),exports.getLoginStatus(),getUserState(),setInterval(getUserState,1e4)}var module="v.login",$jumbotronTipsParent=$("#orderListDiv").show(),$msgTipsParent=$(".l-area .l-area-content .nano"),loginHtml1='<a href="javascript:;" clstag="JIMI|keycount|home2014|dl1" data-module="'+module+'" data-func="showLoginDialog">\u767b\u5f55</a>',loginHtml2='<a href="javascript:;" clstag="JIMI|keycount|home2014|dl2" data-module="'+module+'" data-func="showLoginDialog">\u767b\u5f55</a>',msgTips='<div class="jimi-noLogin-msgTips"><p>\u60a8\u8fd8\u672a\u767b\u5f55\uff0c\u767b\u5f55\u4e4b\u540eJIMI\u66f4\u61c2\u60a8\uff0c\u8bf7\u70b9\u51fb'+loginHtml1+"</p></div>",orderTips='<div class="jimi-noLogin-jumbotron"><p>\u60a8\u8fd8\u672a\u767b\u5f55\uff0cJIMI\u6682\u65f6\u65e0\u6cd5\u67e5\u8be2\u5230\u60a8\u7684\u6700\u8fd1\u8ba2\u5355\uff0c\u8bf7\u70b9\u51fb'+loginHtml2+"</p></div>";exports.getUserImageUrl=function(){$.ajax({type:"get",url:"/imageUrl.action",dataType:"json",success:function(data){exports.userImageUrl=data.userImageUrl,$(".popup-teach .header_img_hover").css("backgroundImage","url("+data.userImageUrl+")")},error:function(){exports.userImageUrl="//static.360buyimg.com/jimi/img/defaultUserImage/defaultImgLarge.png"}})};var statisticUI=function(type){statisticAjaxReq("/newData/dataAction.action",{type:type})},logMsgLogin=function(type,question,answer){statisticAjaxReq("/newData/questionTriggerLoginAction.action",{type:type,question:question,answer:answer})};exports.isLogin=function(){return"1"==window.isLogin},exports.getOrder=function(){getLastestMonthOrder()},exports.showNoLoginTips=function(){$jumbotronTipsParent.html(orderTips),$msgTipsParent.find(".jimi-noLogin-msgTips").remove(),$msgTipsParent.append(msgTips),sendRequest("welcome",2,void 0,void 0,void 0,void 0,$("<p>")),0==$("#chatcontent .jimi-noLogin-blank").length&&$("#chatcontent").prepend('<div class="jimi-noLogin-blank" style="height: 30px;"></div>'),exports.getUserImageUrl()},exports.delAllMsgTips=function(){$("#chatcontent .jimi_lists").has("[data-module='"+module+"']").remove()},exports.delOldMsgTips=function(){$("#chatcontent .jimi_lists").has("[data-module='"+module+"']").slice(0,-1).remove()},exports.showLoginDialog=function(callback,hideThickcloser){var question=$(this).data("question"),isOrderTips="JIMI|keycount|home2014|dl2"==$(this).attr("clstag"),isWelcomeTips="JIMI|keycount|home2014|dl3"==$(this).attr("clstag"),$replaceMsg=$("#chatcontent .jimi_lists").has($(this)),msgTrigger=!0;if(!question){var $lstLogin=$("#chatcontent .jimi_lists:last").find("[data-module='"+module+"']");$lstLogin.length&&($replaceMsg=$("#chatcontent .jimi_lists:last"),question=$lstLogin.data("question"),msgTrigger=!1)}if(question&&(logMsgLogin(1,question),msgTrigger&&statisticUI(38)),jdModelCallCenter.settings.fn=callback||function(){if(window.isLogin="1",getPet(),$("#chatcontent .jimi-noLogin-blank").remove(),$msgTipsParent.find(".jimi-noLogin-msgTips").remove(),$jumbotronTipsParent.find(".jimi-noLogin-jumbotron").remove(),exports.getOrder(),exports.getUserImageUrl(),$("#chatcontent .jimi_lists").has(".visitor").remove(),$(".rightframe").attr("src",$(".rightframe").attr("src")),question){var recordLoginSuccess=function(answer){logMsgLogin(2,question,answer),msgTrigger&&statisticUI(42)};sendRequest(question,0,void 0,void 0,void 0,void 0,$replaceMsg,recordLoginSuccess)}else{var $firstJimiTalks=$("#chatcontent .jimi_lists");$firstJimiTalks.each(function(){var $this=$(this);/usergrade\.jd\.com/.test($this.find("a").attr("href"))&&$this.remove()}),sendRequest("welcome",2),statisticUI(isOrderTips?40:isWelcomeTips?41:39),exports.delAllMsgTips()}},jdModelCallCenter.login(),hideThickcloser)var interval=setInterval(function(){var $thickcloser=$("#thickcloser");$thickcloser.length&&($thickcloser.remove(),clearInterval(interval))},50)},exports.getLoginStatus=function(){var indexParam={t:(new Date).getTime()},postdata={};postdata.source=window.jimiSource,postdata.productId=window.productId,postdata.chatId=window.chatId,postdata.referer=window.referer,window.loginRequest=!1,$.ajax({type:"get",url:"/indexJson.action?"+$.param(indexParam),data:postdata,dataType:"json",success:function(res){res.idelPushInterval&&(window.idleTime=parseInt(res.idelPushInterval)),window.noLoginSourceList=JSON.parse(res.noLoginSourceList),window.source1=res.source,window.tomanual="false",window.tomanual=res.tomanual,window.wsDomain=res.wsDomain,window.wsSwitch=res.wsSwitch,exports.sessionId=res.sessionId,"true"==res.tomanual?$(".service-online").show():$(".service-online").hide(),window.defaultInput=res.speechcraft,"true"==res.isLogin?(window.isLogin="1",sendRequest("welcome",2),exports.getOrder(),exports.getUserImageUrl()):(window.isLogin="0",$.inArray(window.jimiSource||"other",window.noLoginSourceList)>-1?exports.showNoLoginTips():exports.showLoginDialog(function(){window.location.reload()},!0)),window.loginRequest=!0},error:function(){exports.showNoLoginTips(),window.isLogin="0",window.noLoginSourceList=[]}}),sendRequest("defineWelcome",3)},exports.init=init}(jQuery,window,document),exports}),package("v.shortcut.login",[],function(require,exports,moudle){return $(document).on("click","[data-module='v.shortcut.login'], [data-module='v.login']",function(){var method=$(this).data("func");"function"==typeof exports[method]&&exports[method].call(this)}),exports=package("v.login")}),package("v.invite",[],function(require,exports,moudle){return function($,window,document){function sessionSatisfied(statisfied,reason,source){var data1={statisfiedType:statisfied,source:source||exports.jimiSatisfySource,evaluatetemplate:evaluatetemplate,template:inviteTemplate,templateext:exports.defaultBestSatisfy?"selected":"unselect",entrance_source:window.jimiSource};reason&&(data1.unstatisfyReason=reason),1==statisfied&&(data1.unstatisfyReason=""),$.ajax({type:"post",url:"/feedback/sessionStatisfiedType.action",data:data1})}exports.logSource=5,exports.jimiSatisfySource="0",exports.hasComment=!1,exports.isFiveFeedback=!1,exports.defaultBestSatisfy=!1,exports.showFeedbackWhenClose=!0;var inviteTemplate=1,inviteStyle=1,inviteBtnMsg=1,evaluatetemplate=1e4,isFromShortcut=!1;exports.setInviteTemplate=function(tId,eId){inviteTemplate=tId,evaluatetemplate=eId||1e4,inviteStyle=(tId-1)%3+1||1,inviteBtnMsg=inviteTemplate>3?2:1};var inviteMessages={1:"\u4e3b\u4eba\u6765\u90fd\u6765\u4e86\uff0c\u8bc4\u4ef7\u4e00\u4e2a\u5148\uff0c\u62dc\u6258\u62dc\u6258\uff5e",2:"JIMI\u7ed9\u4e3b\u4eba\u5356\u4e2a\u840c\uff0c\u7ed9\u4e2a\u8bc4\u4ef7\u62dc\u6258\u62dc\u6258\uff5e",3:"JIMI\u6b63\u5728\u6512\u4eba\u54c1\uff0c\u4e3b\u4eba\u5feb\u7ed9\u4e2a\u8bc4\u4ef7\u5427\uff0c\u62dc\u6258\u62dc\u6258\uff5e"},hasShowed=!1;exports.show=function(){if(!hasShowed&&!exports.hasComment)if(hasShowed=!0,exports.isFiveFeedback){showMes("JIMI",inviteMessages[exports.inviteStyle]+'<div class="jimi-invite-5">            <ul class="invite-star-box clearfix">              <li class="invite-star" data-score="20" data-des="\u975e\u5e38\u4e0d\u6ee1\u610f"></li>              <li class="invite-star" data-score="40" data-des="\u4e0d\u6ee1\u610f"></li>              <li class="invite-star" data-score="60" data-des="\u4e00\u822c"></li>              <li class="invite-star" data-score="80" data-des="\u6ee1\u610f"></li>              <li class="invite-star" data-score="100" data-des="\u975e\u5e38\u6ee1\u610f"></li>              <li class="invite-star-tips invite-start-tips-init">\u70b9\u51fb\u7ea2\u5fc3\u7ed9JIMI\u6253\u5206</li>            </ul>            <div class="invite-jimi-img"><img src="//static.360buyimg.com/jimi/img/invite/jimi_'+exports.inviteStyle+'_0.gif"/></div>            <div class="jimi-invite-reason common-hide">            <p>\u4e3b\u4eba\uff0c\u60a8\u4e3a\u4ec0\u4e48\u4e0d\u559c\u6b22\u6211\uff1f</p>            <label class="radio-type"><input type="checkbox" name="invitereason-check" value="\u95ee\u9898\u4e0d\u80fd\u89e3\u7b54"> \u95ee\u9898\u4e0d\u80fd\u89e3\u7b54</label>             <label class="radio-type"><input type="checkbox" name="invitereason-check" value="\u7b54\u975e\u6240\u95ee"> \u7b54\u975e\u6240\u95ee</label>             <label class="radio-type"><input type="checkbox" name="invitereason-check" value="\u56de\u7b54\u65b9\u5f0f\u4e0d\u6ee1\u610f"> \u56de\u7b54\u65b9\u5f0f\u4e0d\u6ee1\u610f</label>             <br/>            <input class="jimi-invite-reason-words" name="invitereason" type="text"/>            <p class="words-restrict words-restrict-color">\u60a8\u8fd8\u53ef\u4ee5\u8f93\u5165100\u5b57</p>            </div>            <div class="err-tip" style="color: red; width: 176px; top: 100px; left: 75px;display: none;"></div>            <a class="common-btn common-hide" href="javascript:;">\u63d0\u4ea4</a>            </div>');var $inviteWrap=$("#chatcontent .jimi-invite-5:last");$inviteWrap.find(".invite-star").mouseenter(function(){var $this=$(this);$this.addClass("invite-star-hover"),$this.prevAll(".invite-star").addClass("invite-star-hover"),$this.nextAll(".invite-star").removeClass("invite-star-hover"),$this.siblings(".invite-star-tips").removeClass("invite-start-tips-init").html($this.data("des"));var score=parseInt($this.data("score")),src="//static.360buyimg.com/jimi/img/invite/jimi_"+inviteStyle+"_"+(score>=80?"1":"2")+".gif";$inviteWrap.find(".invite-jimi-img img").attr("src")!=src&&$inviteWrap.find(".invite-jimi-img img").attr("src",src)}).click(function(){var $this=$(this);$this.addClass("invite-start-selected").siblings(".invite-start-selected").removeClass("invite-start-selected");var score=parseInt($this.data("score"));$inviteWrap.find(".common-btn").removeClass("common-hide"),80>score?$inviteWrap.find(".jimi-invite-reason").show():$inviteWrap.find(".jimi-invite-reason").hide(),autoScroll()}),$inviteWrap.find(".invite-star-box").mouseleave(function(){var $this=$(this),$select=$this.find(".invite-start-selected");if($select.length){$select.addClass("invite-star-hover"),$select.prevAll(".invite-star").addClass("invite-star-hover"),$select.nextAll(".invite-star").removeClass("invite-star-hover"),$select.siblings(".invite-star-tips").removeClass("invite-start-tips-init").html($select.data("des"));var src="//static.360buyimg.com/jimi/img/invite/jimi_"+inviteStyle+"_"+(parseInt($select.data("score"))>=80?"1":"2")+".gif";$inviteWrap.find(".invite-jimi-img img").attr("src")!=src&&$inviteWrap.find(".invite-jimi-img img").attr("src",src)}else $this.find(".invite-star").removeClass("invite-star-hover"),$this.find(".invite-star-tips").addClass("invite-start-tips-init").html("\u70b9\u51fb\u7ea2\u5fc3\u7ed9JIMI\u6253\u5206"),$this.siblings(".invite-jimi-img").find("img").attr("src","//static.360buyimg.com/jimi/img/invite/jimi_"+inviteStyle+"_0.gif")}),$inviteWrap.find("input").iCheck({checkboxClass:"icheckbox_square-blue",radioClass:"iradio_square-blue",increaseArea:"20%"}),exports.defaultBestSatisfy&&$inviteWrap.find(".invite-star:last").trigger("mouseenter").trigger("click");var timeout=null,$reasonInput=$inviteWrap.find("[name=invitereason]"),tips="\u8f93\u5165\u60a8\u8981\u53cd\u9988\u7684\u5185\u5bb9";$reasonInput.focus(function(){$(this).css("color","#333"),$(this).val()==tips&&$(this).val("")}).blur(function(){""==$(this).val()&&$(this).val(tips).css("color","#ccc")}).val(tips).css("color","#ccc");var checkLength=function(){var leftLength=100-($reasonInput.val()==tips?0:$reasonInput.val().length);return leftLength>=0?($inviteWrap.find(".words-restrict").removeClass("common-red").addClass("words-restrict-color").html("\u60a8\u8fd8\u53ef\u4ee5\u8f93\u5165"+leftLength+"\u5b57"),!0):($inviteWrap.find(".words-restrict").removeClass("words-restrict-color").addClass("common-red").html("\u60a8\u5df2\u8d85\u51fa"+-1*leftLength+"\u5b57"),!1)};$reasonInput.bind("input propertychange",checkLength),$.browser.msie&&"9.0"==$.browser.version&&setInterval(checkLength,50),$inviteWrap.find("a.common-btn").click(function(){var score=parseInt($inviteWrap.find(".invite-start-selected").data("score")),$reasons=$inviteWrap.find("[name=invitereason-check]:checked"),reason=$.trim($reasonInput.val()).substr(0,100);return 80>score&&0==$reasons.length&&(!reason||reason==tips)?($inviteWrap.find(".err-tip").html("\u8bf7\u52fe\u9009\u539f\u56e0\u6216\u7ed9JIMI\u53cd\u9988\uff0c\u8c22\u8c22").show(),clearTimeout(timeout),timeout=setTimeout(function(){$inviteWrap.find(".err-tip").fadeOut()},1e3),!1):80>score&&!checkLength()?!1:($reasons.each(function(){reason=$(this).val()+","+reason}),$inviteWrap.find(".common-btn").after('<div class="jimi-invite-thanks">\u611f\u8c22\u60a8\u7684\u8bc4\u4ef7\uff01</div>'),sessionSatisfied(score,reason,exports.logSource),exports.hasComment=!0,$inviteWrap.find(".invite-star, .common-btn").unbind(),$inviteWrap.find(".common-btn").css("background-color","#ccc"),void setTimeout(function(){$("#chatcontent .jimi_lists").has(".jimi-invite-thanks").fadeOut()},3e3))}),sessionSatisfied("18",null,exports.logSource)}else{showMes("JIMI",inviteMessages[inviteStyle]+'<div class="jimi-invite"'+(1==inviteBtnMsg?"":' style="width:295px;" ')+'>            <img src="//static.360buyimg.com/jimi/img/invite/jimi_'+inviteStyle+'_0.gif" width="120" height="120"/>            <div class="jimi-invite-control">            <a class="common-btn" data-invitetype="1" href="javascript:;">'+(1==inviteBtnMsg?"\u597d\u8bc4":"\u9001\u9c9c\u82b1")+'</a>            <a class="common-btn" data-invitetype="0" href="javascript:;">'+(1==inviteBtnMsg?"\u5dee\u8bc4":"\u62cd\u677f\u7816")+"</a>            </div>            </div>");var $inviteWrap=$("#chatcontent .jimi-invite:last");exports.defaultBestSatisfy&&$inviteWrap.find(".common-btn[data-invitetype='1']").addClass("common-btn-active"),$inviteWrap.find("a.common-btn").click(function(){var _this=$(this),_parent=_this.parent().parent(),score=parseInt(_this.data("invitetype"));_parent.find("img").attr("src","//static.360buyimg.com/jimi/img/invite/jimi_"+inviteStyle+"_"+("1"==score?"1":"2")+".gif"),_parent.find(".jimi-invite-control").replaceWith('<div class="common-red jimi-invite-thanks">\u611f\u8c22\u60a8\u7684\u8bc4\u4ef7\uff01</div>'),sessionSatisfied(score,null,exports.logSource),exports.hasComment=!0,setTimeout(function(){$("#chatcontent .jimi_lists").has($inviteWrap).fadeOut()},3e3)}),sessionSatisfied("-1",null,exports.logSource)}},exports.feedbackInit=function(){function _showSatisfyMask(){var winH=$(window).height(),winW=$(window).width(),winPosT=(winH-100)/2,winPosL=(winW-100)/2;$mask.show().css({left:0}),$unsatisfyRegion.hide(),$(".submit-opt").hide(),$satisfyRegion.show().css({top:winPosT,left:winPosL,zIndex:122}),exports.defaultBestSatisfy&&$radios.eq(0).iCheck("check")}var canComment=!0,$winCloseBtn=$("#winclose"),$winCloseBtn_top=$("#winclose_top"),$satisfyRegion=$(".satisfy"),$mask=$("#masterDiv"),$unsatisfyRegion=$("#unsatisfyRegion"),$satisfyBtn=$("#sat-y"),$unsatisfyBtn=$("#sat-n"),$JdefaultPanel=$(".satisfy-content"),$feedBackPanel=$("#J_feedback2"),$closeFeedBtn=$("#J_closeFeed2");$(".satisfy .submit-opt").html('<a class="post-btn" clstag="JIMI|keycount|home2014|myd2" href="javascript:;" style="margin-left:0;">\u63d0 \u4ea4</a>    <a class="cancel-btn" href="javascript:;" style="margin-left:51px;">\u53d6 \u6d88</a>');var $postBtn=$(".satisfy .post-btn"),$cancelBtn=$(".satisfy .cancel-btn"),$closeBtn=$("i.close"),$errTip=$("#J_errTip2"),$radios=$("input[name='satisfied']"),mustCommentflag=!0,isFiveFeedback=package("v.invite").isFiveFeedback;if(!isFiveFeedback){$(".satisfy-header").addClass("satisfy-header-new").find("h3").html("\u60a8\u5bf9JIMI\u7684\u670d\u52a1\u611f\u5230\u6ee1\u610f\u5417\uff1f"),$(".submit-opt").hide();var jimi_eval_0="//static.360buyimg.com/jimi/img/invite/jimi_eval_0.gif",jimi_eval_1="//static.360buyimg.com/jimi/img/invite/jimi_eval_1_"+evaluatetemplate+".gif",jimi_eval_2="//static.360buyimg.com/jimi/img/invite/jimi_eval_2.gif",html='      <div class="satisfy-jimi-expression fl"><img height="128" width="128" src="'+jimi_eval_0+'"/></div>      <ul class="satisfy-radio fl">        <li class="satisfy-radio-'+evaluatetemplate+'-0"><a href="javascript:;" data-score="0"></a></li>        <li class="satisfy-radio-'+evaluatetemplate+'-1"><a href="javascript:;" data-score="1"></a></li>      </ul>    ';$(".unsatisfy-reason").hide(),$("#unsatisfyRegion").hide().css("margin-top","8px"),$(".satisfy-choice").addClass("clearfix").css("padding","0px 0px 10px 5px").html(html);var $img=$(".satisfy-jimi-expression img");$feedBackPanel.css("position","absolute").css("left","80px").css("top","80px");var setImgByScore=function(scroe){1==scroe?$img.attr("src")!=jimi_eval_1&&$(".satisfy-jimi-expression img").attr("src",jimi_eval_1):0==scroe?$img.attr("src")!=jimi_eval_2&&$(".satisfy-jimi-expression img").attr("src",jimi_eval_2):$img.attr("src")!=jimi_eval_0&&$(".satisfy-jimi-expression img").attr("src",jimi_eval_0)};$(".satisfy-radio a").on("click",function(){var $this=$(this).blur(),scroe=$this.data("score");$(".satisfy-radio a").removeClass("active"),$this.addClass("active"),"0"==scroe?($(".submit-opt").show(),$("#unsatisfyRegion").show()):($(".submit-opt").hide(),$("#unsatisfyRegion").hide(),$postBtn.trigger("click"))})}if(isFiveFeedback){var html='    <input id="feedback100" type="radio" value="100" name="satisfied">    <label class="radio-type" for="feedback100">\u975e\u5e38\u6ee1\u610f</label>    <input id="feedback80"  type="radio" value="80" name="satisfied">    <label class="radio-type" for="feedback80">\u6ee1\u610f</label>    <input id="feedback60"  type="radio" value="60" name="satisfied">    <label class="radio-type" for="feedback60">\u4e00\u822c</label>    <input id="feedback40"  type="radio" value="40" name="satisfied">    <label class="radio-type" for="feedback40">\u4e0d\u6ee1\u610f</label>    <input id="feedback20"  type="radio" value="20" name="satisfied">    <label class="radio-type" for="feedback20">\u975e\u5e38\u4e0d\u6ee1\u610f</label>    ';$(".satisfy-choice").css("padding","20px 0 57px 20px").html(html),$(".satisfy-choice label").css("padding","0 16px 0 0").css("margin-right","0"),$("#feedback100,#feedback80").on("ifChecked",function(){$unsatisfyRegion.hide()}),$("#feedback60,#feedback40,#feedback20").on("ifChecked",function(){$unsatisfyRegion.show()}),$radios=$("input[name='satisfied']")}$radios.on("ifChecked",function(){$errTip.hide()}),$satisfyRegion.hide(),$JdefaultPanel.find("input").iCheck({checkboxClass:"icheckbox_square-blue",radioClass:"iradio_square-blue",increaseArea:"20%"}),$satisfyBtn.on("ifChecked",function(){$unsatisfyRegion.hide()}),$unsatisfyBtn.on("ifChecked",function(){$unsatisfyRegion.show()}),$cancelBtn.click(function(){$satisfyRegion.hide(),$mask.hide(),$errTip.hide()}),$closeBtn.click(function(){$cancelBtn.trigger("click")}),$radios.click(function(){$errTip.hide()});var hideTimeout=null;$postBtn.click(function(){var feedbackVal=$("input[name='satisfied']:checked").val();isFiveFeedback||(feedbackVal=$(".satisfy-radio a.active").data("score"));var feedbackTxt=$.trim($("#reasonIntro").val()),reason=[],reasonTxt="";if(isFiveFeedback||!$unsatisfyRegion.is(":visible")||"\u8f93\u5165\u60a8\u8981\u53cd\u9988\u7684\u5185\u5bb9"!=feedbackTxt&&""!=feedbackTxt)if(mustCommentflag&&void 0==feedbackVal)$errTip.css("width","130px"),$errTip.css("top","100px"),$errTip.css("left","155px"),$errTip.html("\u8bf7\u9009\u62e9\u60a8\u7684\u8bc4\u4ef7\uff0c\u8c22\u8c22"),$errTip.show(),clearTimeout(hideTimeout),hideTimeout=setTimeout(function(){$errTip.fadeOut()},1500);else if(!$unsatisfyRegion.is(":visible")||"\u8f93\u5165\u60a8\u8981\u53cd\u9988\u7684\u5185\u5bb9"!=feedbackTxt&&""!=feedbackTxt||$("#reason1").is(":checked")||$("#reason2").is(":checked")||$("#reason3").is(":checked")){if(!canComment)return;isFiveFeedback?$JdefaultPanel.hide():($(".satisfy-radio, #unsatisfyRegion,.submit-opt").hide(),setImgByScore(feedbackVal)),isFromShortcut&&$closeFeedBtn.hide(),$("#reason1").is(":checked")&&reason.push($("#reason1").val()),$("#reason2").is(":checked")&&reason.push($("#reason2").val()),$("#reason3").is(":checked")&&reason.push($("#reason3").val()),reason.length>0&&(reasonTxt+=reason.join(",")),""!=feedbackTxt&&"\u8f93\u5165\u6587\u5b57"!=feedbackTxt&&(reasonTxt+=","+feedbackTxt),sessionSatisfied(feedbackVal,reasonTxt),exports.hasComment=!0,$feedBackPanel.show(),function(){var now=3;isFromShortcut&&(isFiveFeedback?now=1:(now=2,$(".J_time").parent().hide())),$(".J_time").text(now);var fn=function(){$(".J_time").text(now),0==now&&(isFromShortcut?($satisfyRegion.hide(),$feedBackPanel.hide(),$mask.hide()):windowclose(),clearTimeout(fn)),now-=1,setTimeout(fn,1e3)};setTimeout(fn,0)}()}else $errTip.css("width","176px"),$errTip.css("top","240px"),$errTip.css("left","130px"),$errTip.html("\u8bf7\u52fe\u9009\u539f\u56e0\u6216\u7ed9JIMI\u53cd\u9988\uff0c\u8c22\u8c22"),$errTip.show(),clearTimeout(hideTimeout),hideTimeout=setTimeout(function(){$errTip.fadeOut()},1500);else $errTip.css("width","176px"),$errTip.css("top","265px"),$errTip.css("left","130px"),$errTip.html("\u8bf7\u8f93\u5165\u60a8\u8981\u53cd\u9988\u7684\u5185\u5bb9\u54e6\uff0c\u8c22\u8c22"),$errTip.show(),clearTimeout(hideTimeout),hideTimeout=setTimeout(function(){$errTip.fadeOut()},1500)}),$winCloseBtn_top.click(function(){return isFromShortcut=!1,exports.hasComment?void windowclose():$("#chatcontent .customer_lists").length<1?void windowclose():void(isShowSatisfyModal?(_showSatisfyMask(),exports.jimiSatisfySource="1",package("v.invite").isFiveFeedback?sessionSatisfied("18",null,"1"):sessionSatisfied("-1",null,"1")):exports.showFeedbackWhenClose?(_showSatisfyMask(),exports.jimiSatisfySource="2",package("v.invite").isFiveFeedback?sessionSatisfied("18",null,2):sessionSatisfied("-1",null,"2")):windowclose())}),$winCloseBtn.click(function(){return isFromShortcut=!1,exports.hasComment?void windowclose():void($("#chatcontent .customer_lists").length<1?windowclose():exports.showFeedbackWhenClose?(exports.jimiSatisfySource="1",_showSatisfyMask(),package("v.invite").isFiveFeedback?sessionSatisfied("18",null,"1"):sessionSatisfied("-1",null,"1")):windowclose())}),$("#reasonIntro").bind("keydown keyup change mouseup mousedown click blur",function(){var text=$("#reasonIntro").val(),textLen=text.length;"\u8f93\u5165\u60a8\u8981\u53cd\u9988\u7684\u5185\u5bb9"!=text&&(100>=textLen?(canComment=!0,$("#wordsRestrict").text("\u60a8\u8fd8\u53ef\u4ee5\u8f93\u5165"+(100-textLen)+"\u5b57").removeClass("red").addClass("words-restrict-color")):(canComment=!1,$("#wordsRestrict").text("\u60a8\u5df2\u8d85\u51fa"+(textLen-100)+"\u5b57").removeClass("words-restrict-color").addClass("red")))}),$("#reasonIntro").bind("focus",function(){var text=$("#reasonIntro").val();"\u8f93\u5165\u60a8\u8981\u53cd\u9988\u7684\u5185\u5bb9"==text&&$("#reasonIntro").val("").css("color","#333333")}),$("#reasonIntro").bind("blur",function(){var text=$("#reasonIntro").val();""==text&&$("#reasonIntro").val("\u8f93\u5165\u60a8\u8981\u53cd\u9988\u7684\u5185\u5bb9").css("color","#CCCCCC")}),$closeFeedBtn.click(windowclose),$("#wordsRestrict").addClass("words-restrict-color")},$("#j_satisfy").click(function(){if(isFromShortcut=!0,exports.hasComment)return void showMes("JIMI","\u8c22\u8c22\uff0c\u60a8\u5df2\u5bf9\u672c\u6b21\u670d\u52a1\u505a\u51fa\u8fc7\u8bc4\u4ef7\u4e86\uff01");$("#text-in").blur();var $satisfyRegion=$(".satisfy"),$mask=$("#masterDiv"),$unsatisfyRegion=$("#unsatisfyRegion"),$feedBackPanel=$("#J_feedback2"),$JdefaultPanel=$(".satisfy-content"),$radios=$("input[name='satisfied']");$(window).height(),$(window).width();$mask.show().css({left:0}),$unsatisfyRegion.hide(),$feedBackPanel.hide(),$JdefaultPanel.show(),$satisfyRegion.show().css({zIndex:122}),$radios.iCheck("uncheck"),$(".unsatisfy-reason input").iCheck("uncheck"),exports.jimiSatisfySource="0";var isFiveFeedback=package("v.invite").isFiveFeedback;isFiveFeedback?sessionSatisfied("18",null,"0"):(sessionSatisfied("-1",null,"0"),$(".submit-opt").hide(),$(".satisfy-radio a").removeClass("active"),$("#unsatisfyRegion").hide()),exports.defaultBestSatisfy&&isFiveFeedback&&$radios.eq(0).iCheck("check")})}(jQuery,window,document),exports}),package("v.chatHelper",[],function(require,exports,moudle){return function($,window,document){function moreListEvt(clickDom,showDom,num){if(clickDom&&showDom){var num=num||2;clickDom.hasClass("up")?(showDom.each(function(i,k){i>num&&$(this).hide()}),clickDom.removeClass("up"),clickDom.find(".txt").html("\u67e5\u770b\u5168\u90e8")):(clickDom.addClass("up"),showDom.show(),clickDom.find(".txt").html("\u6536\u8d77\u66f4\u591a"))}}function changeOne($wrapper,itemHeight,num){var itemHeight=itemHeight||0,num=num||3;if(!$wrapper.is(":animated")){var top=parseInt($wrapper.css("margin-top")),height=$wrapper.height(),nextTop=top-itemHeight*num;-1*(top-itemHeight*num)>=height?$wrapper.stop().animate({"margin-top":"0px"},200,"swing",function(){autoScroll()}):$wrapper.stop().animate({"margin-top":nextTop+"px"},200)}}function slideChange(param){var obj={domClass:void 0,direction:"left",num:1,ul:".slide-list",li:".slide-item",parent:".J_SlideCon",next:".J_ChangeNextOne",pre:".J_ChangePreOne",showBtn:!1};obj=$.extend({},obj,param);var $dom=obj.domClass;if(obj.domClass.length){var $parent=$dom.closest(obj.parent),$ul=$parent.find(obj.ul),$li=$ul.find(obj.li),$next=$dom.siblings(obj.next),$pre=$dom.siblings(obj.pre),w=$li.width()*obj.num,mLeft=$ul.css("marginLeft").replace("px","")||0,len=$li.length,newLeft=0;$li.show(),obj.showBtn&&($dom.hide(),$pre.show(),$li.css({width:w+"px"}),$ul.css({width:w*len+"px"}),len>2&&$next.show()),"left"==obj.direction&&(newLeft=parseInt(mLeft)+w,newLeft>=0&&$dom.hide(),$next.show()),"right"==obj.direction&&(newLeft=parseInt(mLeft)-w,Math.abs(newLeft-w)>=w*len&&$dom.hide(),$pre.show()),$ul.animate({marginLeft:newLeft+"px"})}}function drawSuggestions(sugguestions){var ul=$("#sugguestions");if(!(null==ul||ul.length>1)){for(var question=$("#text-in").val(),qestionArr=[],indexList=(sugguestions.length,[5,4,0,1,2,3]),i=1;i<sugguestions.length+1&&7>i;i++){var str="",temp=sugguestions[i-1].content,reg=new RegExp("(["+question+"])","ig");temp=temp.replace(reg,'<font color="red">$1</font>');var t=sugguestions[i-1].content;t=replaceSpecialChart(t);var type=sugguestions[i-1].commandNo?1:0,a="";sugguestions[i-1].isDefault&&(a="hover"),str+='<li class="suggestion '+a+'" faqid="'+sugguestions[i-1].id+'" onclick="javascript:sendClick('+type+","+sugguestions[i-1].id+",'"+t+"','"+sugguestions[i-1].commandNo+"',null,"+i+',null,false,true,false);">',str+="<a>"+temp+"</a></li>",qestionArr[indexList[i-1]]=str}ul.html(""),$("<ul>"+qestionArr.join("")+"</ul>").appendTo(ul),ul.data("data",sugguestions),ul.data("input",question),$(".suggestion").hover(function(){$(this).siblings(".hover").removeClass("hover"),$(this).addClass("hover")},function(){$(this).removeClass("hover")}),$("#sugguestions").show()}}function showSuggestions(text){text=text.replaceAll("&lt;","<"),text=text.replaceAll("&gt;",">"),text=text.replaceAll("&quot;",'"'),text=text.replaceAll("&qpos;","'"),text=text.replaceAll("&nbsp;"," "),text=text.replaceAll("&nbsp;"," "),text=text.replace(/<\/?.+?>/g,""),text=replaceSpecialChart(text);var promotionId=$("#promotionId").val();$.ajax({type:"post",url:"/keywordTips/keywordTips.action?t="+(new Date).getTime(),data:{input:text,source:jimiSource||"",promotionId:promotionId,productId:void 0==productId?"":productId},dataType:"JSON"}).success(function(data){var obj=data,text=$("#text-in").val().trim();return null==obj||!obj.state||text.length<=0||null==obj.data||obj.data.length<=0||!(obj.data instanceof Array)?void $("#sugguestions").hide():void drawSuggestions(obj.data)})}function showThumbnail($ele){var $thumbs=$ele.find(".js-thumbnail");if($thumbs.length){var dataLightbox="lightbox-"+Math.random();$thumbs.each(function(i){var $this=$(this),height=$this.attr("h")||60,width=$this.attr("w")||60,title=$this.attr("title")||"",src=$this.attr("src"),tempArr=src.split(".");tempArr.splice(-1,0,"thumb");var thumbSrc=tempArr.join(".");$this.replaceWith('<a class="jimi-thumb-link" data-title="'+title+'" data-lightbox="'+dataLightbox+'" href="'+thumbnailPath+src+'"><i class="jimi-thumb-zoom"></i><img src="'+thumbnailPath+thumbSrc+'" width="'+width+'" height="'+height+'" /></a>')})}}var questions={result:[]};exports.isSuggestionHelp=Math.random()<.5,exports.draw=function(){exports.isSuggestionHelp?$("#text-in").on("click",function(){var value=$(this).val();setTimeout(function(){if(!value){var html="";$.each(questions.result,function(){html+='<li class="suggestion js-send-question"><a>'+this+"</a></li>"}),html&&$("#sugguestions").html(html).show()}},50)}):($.template("chathelper",unescape(package("tmpl.chathelper"))),$("#container .chat-helper").remove(),$("#chatcontent").after($.tmpl("chathelper",questions)))},exports.getQuestions=function(){setTimeout(function(){questions.result.length||(exports.isSuggestionHelp=!0,$(window).trigger("resize"))},350),$.ajax({type:"get",url:"//sp-jimi.jd.com/space/getConsults?__="+$.cookie("_robotAccess_")+"&productId="+window.productId+"&source="+window.jimiSource+"&callback=?&type="+(isCustomerEntrance()?"5":"4"),success:function(data){data&&data.statusCode&&(questions=data.obj)},complete:function(){questions.result.length||(exports.isSuggestionHelp=!0,
$(window).trigger("resize"),$(".chat-helper").remove()),exports.draw()},dataType:"jsonp"})},$(document).on("click",function(){$(".chat-helper-guess-list").is(":visible")&&$(".chat-helper-guess-list").hide()}),$(document).on("click",".chat-helper-guess-select",function(event){$(".chat-helper-guess-list").toggle(),event.stopPropagation()}),$(document).on("click",".chat-helper-guess-list a, #sugguestions .js-send-question a",function(event){var $this=$(this);$this.blur();var question=$this.html();$(".chat-helper-guess-select span").html(question),$(".chat-helper-guess-list").hide(),$("#sugguestions").hide(),showMes("\u6211",question),sendRequest(question,0),event.stopPropagation()}),$(document).on("click",".jimi-goods-list .change-btn",function(){$(this).blur();var $wrapper=$(this).siblings(".list-panel").find(".views");changeOne($wrapper,98,3)}),$(document).on("click",".jr-licai-list .change-btn",function(){$(this).blur();var $wrapper=$(this).siblings(".list-panel").find(".views");changeOne($wrapper,138,2)}),$(document).on("click",".richMedia-list li a",function(){var item=$(this),outerDOM=item.closest(".richMedia"),classCate=outerDOM.attr("data-category"),propertyName=outerDOM.attr("data-propertyname");"1"==classCate?clickType="\u7c7b\u578b"==propertyName?"lc_type":"lc_limit":"2"==classCate&&(clickType="\u57fa\u91d1\u79cd\u7c7b"==propertyName?"jj_type":"jj_risk");var param={typeCode:"answer_ask_type",content:{message_id:outerDOM.attr("data-msgid"),interactive_id:outerDOM.attr("data-interactiveId"),click_type:clickType,ask_time:"$currentTime",code:item.attr("data-valueid"),desc:item.attr("data-valuename")}};triggerLandfill(param)}),$(document).on("click",".expand-btn",function(){$(this).fadeOut();var $expandArea=$(this).parent().parent().find(".expand-area");$expandArea.hasClass("animated")||($expandArea.stop().animate({"max-height":"1000px"},500).addClass("animated"),autoScroll())}),$(document).on("click","[data-cateid]",function(){var item=$(this),outerDOM=item.closest("span"),param={typeCode:"answer_ask_type",content:{message_id:outerDOM.attr("data-msgid"),interactive_id:outerDOM.attr("data-interactiveId"),click_type:"feedback",ask_time:"$currentTime",code:item.attr("data-cateid"),desc:item.text()}};triggerLandfill(param)}),$(document).on("click","[data-anwser]",function(){var $this=$(this),requestText=$this.html(),interactiveId=$this.closest("span").data("interactiveid")||$this.closest("ul").data("interactiveid"),feedBackNum=$this.data("position")||$this.data("id"),info={interactiveId:interactiveId,feedBackNum:feedBackNum};window.feedbackAnswerInfo=info,showMes("\u6211",requestText),sendRequest(requestText,0);var item=$(this),outerDOM=item.closest("span"),param={typeCode:"answer_ask_type",content:{message_id:outerDOM.attr("data-msgid"),interactive_id:outerDOM.attr("data-interactiveId"),click_type:"fold",ask_time:"$currentTime",code:item.attr("data-id"),desc:item.text()}};triggerLandfill(param)}),$(document).on("click","[data-send]",function(){var $this=$(this),answer=$this.data("send");answer&&(showMes("\u6211",answer),sendRequest(answer,0))}),$(document).on("click",".J_MoreList",function(){var $this=$(this),$li=$this.siblings("ul").find("li");moreListEvt($this,$li,2)}),$(document).on("click",".J_SeeDetail",function(){var $this=$(this),$li=$this.closest(".log-body").find(".log-row");moreListEvt($this,$li,2)}),$(document).on("click",".J_ActivityViewMore",function(){var $dom=$(this),$li=$dom.prev(".ai-list").find("li");moreListEvt($dom,$li,2)}),$(document).on("click",".J_ChangeOne",function(e){var $this=$(this);slideChange({domClass:$this,showBtn:!0,direction:"right"})}),$(document).on("click",".J_ChangePreOne",function(e){var $this=$(this);slideChange({domClass:$this,direction:"left"})}),$(document).on("click",".J_ChangeNextOne",function(e){var $this=$(this);slideChange({domClass:$this,direction:"right"})}),$(function(){$(".jimiClickSend").live("click",function(){var req=$(this).attr("question");sendRequest(req,0)}),$(".xiDiTips").live("click",function(){var questionId=$(this).attr("question"),showMsg=$(this).html()+"\u6709\u54ea\u4e9b\uff1f";showMes("\u6211",showMsg),sendRequest(questionId,0,void 0,"washTipsCommand")})}),exports.showSuggestions=showSuggestions;var thumbnailPath="//static.360buyimg.com/jimi/img/answer/";exports.showThumbnail=showThumbnail}(jQuery,window,document),exports}),package("v.myspace",[],function(require,exports,moudle){return function(){function getQuestion(type,callback){var data={"space-btn-tx":1,"space-btn-xh":2,"space-btn-ds":3,"space-btn-yx":4},type=data[type];type&&$.ajax({type:"get",url:questionUrl+"&type="+type,success:function(data){data.statusCode&&data.obj&&callback&&callback(data.obj.result.question)},dataType:"jsonp"})}function adaptWeather(){if(obj.weather){var result=obj.weather;obj.weather.area=result.areaId,-100==result.temperatureDay?(obj.weather.info=parseInt(result.temperatureNight)+"\xb0C",obj.weather.img="/night/"+result.phenomenaIdNight+".png",obj.weather.title=result.phenomenaStringNight):(obj.weather.info=parseInt(result.temperatureDay)+" ~ "+parseInt(result.temperatureNight)+"\xb0C",obj.weather.img="/day/"+result.phenomenaIdDay+".png",obj.weather.title=result.phenomenaStringDay)}}var sessionId=$.cookie("_robotAccess_"),weatherUrl="//sp-jimi.jd.com/space/getWeatherInfo?__="+sessionId+"&callback=?&source="+window.jimiSource,hourUrl="//sp-jimi.jd.com/space/getHourPush?__="+sessionId+"&callback=?&source="+window.jimiSource,welcomeUrl="//sp-jimi.jd.com/space/getCareWord?__="+sessionId+"&callback=?&source="+window.jimiSource,questionUrl="//sp-jimi.jd.com/space/getChatWord?__="+sessionId+"&callback=?&source="+window.jimiSource,obj={weather:null,msg:null};exports.isShowMyspace=!0,exports.draw=function(){$.template("myspace",unescape('<div class="space-weather clearfix">{{if !weather}}<p>\u6b63\u5728\u4e3a\u60a8\u83b7\u53d6\u5929\u6c14\u4fe1\u606f...</p>{{else}}<p><span>${weather.area}\uff1a</span><img alt="\u5929\u6c14" title="${weather.title}" src="//static.360buyimg.com/jimi/img/weather${weather.img}"><span>${weather.info}</span></p>{{/if}}</div><div class="space-chat clearfix"><div class="space-chat-header"></div><div class="space-chat-box"><i class="space-chat-box-arrow"></i> <i class="space-chat-box-top"></i> <i class="space-chat-box-bottom"></i><div class="space-chat-box-content" id="space-chat-content">{{if !msg}} \u4e3b\u4eba\uff0c\u6b22\u8fce\u8bbf\u95eeJIMI\uff0cJIMI\u662f\u4e00\u53ea\u6765\u81ea\u5916\u592a\u7a7a\u7684\u667a\u80fd\u673a\u5668\u9e66\u9e49\uff0c\u80fd\u966a\u60a8\u804a\u5929\u3001\u89e3\u51b3\u60a8\u7684\u95ee\u9898\uff0c\u8bb0\u5f97\u5e38\u6765\u54c8 {{else}} {{html msg}} {{/if}}</div></div></div><ul class="space-btn-group"><li class="space-btn-tx"><a href="javascript:;"><i></i>\u8c03\u620fJIMI</a></li><li class="space-btn-xh"><a href="javascript:;"><i></i>\u8bb2\u7b11\u8bdd</a></li><li class="space-btn-ds"><a href="javascript:;"><i></i>\u5bf9\u8bd7</a></li></ul>')),$("#mySpace").html($.tmpl("myspace",obj)).show()},exports.getWelcome=function(){$.ajax({type:"get",url:welcomeUrl,success:function(data){data.statusCode&&data.obj&&(obj.msg=data.obj.result,exports.draw())},dataType:"jsonp"})},exports.getWeather=function(callback){$.ajax({type:"get",url:weatherUrl,success:function(data){data.statusCode&&data.obj&&(obj.weather=data.obj.result,adaptWeather(),exports.draw())},dataType:"jsonp"})},exports.getCare=function(hour){$.ajax({type:"get",url:hourUrl+"&timePoint="+hour,success:function(data){data.statusCode&&data.obj&&(obj.msg=data.obj.result,exports.draw())},dataType:"jsonp"})},$(document).on("click","#mySpace .space-btn-group li",function(){var $this=$(this);$this.find("a").blur(),getQuestion($this.attr("class"),function(question){question&&(showMes("\u6211",question),sendRequest(question,0))})}),exports.init=function(){exports.getWelcome(),exports.getWeather(),setTimeout(function(){var oldHour=(new Date).getHours();setInterval(function(){var currentHour=(new Date).getHours();currentHour!=oldHour&&(oldHour=currentHour,exports.getCare(currentHour))},5e3)},3e5)}}(jQuery,window,document),exports}),package("v.close",[],function(require,exports,moudle){return function($,document){exports.closingFlag=!1;exports.bindWindowClose=function(){return!1}}(jQuery,window.document),exports}),package("v.adjustView",[],function(require,exports,moudle){return function($,window,document){function fMaxWin(){return $("body").addClass("jimi_revision"),$("#winmax").attr("class",package("v.myjimi").skinBgConfig.full_screen_quit_bg[package("v.myjimi").skin_type]).attr("clstag","JIMI|keycount|home2014|c5"),$(".chat-block").data("__oldHeight__",$(".chat-block").height()),$("#container").css("left","0px"),$("#container").css("right","0px"),$("#text-in").css("width",$(".edit-block").width()-55),$("#text-in").val()!=defaultInput&&$("#text-in").focus(),winState=!0,!1}function fMinWin(){$("body").removeAttr("class"),$("#winmax").attr("class",package("v.myjimi").skinBgConfig.full_screen_bg[package("v.myjimi").skin_type]).attr("clstag","JIMI|keycount|home2014|c5"),$(".chat-block").height($(".chat-block").data("__oldHeight__")),$(".inputM").width($(".inputM").data("__oldWidth")),$("#text-in").css("width",$(".edit-block").width()-55),$("#text-in").val()!=defaultInput&&$("#text-in").focus(),winState=!1;var nWinW=$("#container").width(),nWinH=$("#container").height(),nObjL=Math.round(($(window).width()-nWinW)/2);Math.round(($(window).height()-nWinH)/2);$("#container").css({right:"auto",left:nObjL})}function stopMovePropagation(e){bool=!1,e.stopPropagation()}function updateMouvePosition(e){var x=nPosX+e.pageX-nOffsetX,y=nPosY+e.pageY-nOffsetY,bW=$("#container").width()+x-$(window).width(),bH=$("#container").height()+y-$(window).height();0>bW&&$("#container").css({left:x}),0>bH&&$("#container").css({top:0})}var adaptConfig={minHeight:630,container:64,chatcontent:259,navcontent:104,inputWidth:55};exports.config=function(settings){$.extend(adaptConfig,settings)};var winState=!1;exports.fMaxWin=fMaxWin,exports.fMinWin=fMinWin,$("#container .header .logo").mousedown(function(e){e.preventDefault()});var nWinW=$("#container").width(),nWinH=$("#container").height(),nObjL=Math.round(($(window).width()-nWinW)/2);Math.round(($(window).height()-nWinH)/2);$("#container").css({left:nObjL});var bool=!1,nOffsetX=0,nOffsetY=0,nPosX=0,nPosY=0;$("#container").mousedown(function(e){if(!winState){var self=$(this);bool=!0,nOffsetX=e.pageX,nOffsetY=e.pageY,nPosX=self.offset().left,nPosY=self.offset().top}}).mouseup(function(){bool=!1}),$("#chatcontent").parent().mousedown(function(e){bool=!1,e.stopPropagation()}),$("#winmax, #winclose_top, .service-online, .container, .copyright").mousedown(function(e){stopMovePropagation(e)}),$(document).mousemove(function(e){bool&&updateMouvePosition(e)}).mouseup(function(e){bool=!1}),$(document).on("dblclick","#container > .header",function(){$("#winmax").trigger("click")}),$("#winmax").live("click",function(){winState?fMinWin():fMaxWin(),$(window).trigger("resize")}),$("#containerMin").click(function(){$(this).hide(300),$("#container").show(300)}),$("#chatcontent").mousedown(function(e){e.stopPropagation()});var windowWidthOld=$(window).width();exports.adaptHeight=function(){var wh=$(window).height(),ww=$(window).width();wh<adaptConfig.minHeight&&(wh=adaptConfig.minHeight),ww!=windowWidthOld&&(windowWidthOld=ww,winState||fMinWin()),$("#container").height(wh-adaptConfig.container),$("#chatcontent").height(wh-adaptConfig.chatcontent-(package("v.chatHelper").isSuggestionHelp?0:32)),$("#navcontent").height($("#container").height()-adaptConfig.navcontent),$("#jRightArea iframe").length>0&&$("#jRightArea iframe").attr("height",wh-adaptConfig.chatcontent-(package("v.chatHelper").isSuggestionHelp?0:32)+132),$(".intro-bar").siblings(".nano").find(".content").each(function(index,el){var item=$(this);setTimeout(function(){item.height($("#jRightArea").outerHeight()-$("#sidenav").outerHeight()-$(".intro-bar:visible").size()*$(".intro-bar").outerHeight())},10)}),$("#buyConsultDiv, #orderListDiv, #mySpace, #productDetailDiv, #myJimi").parent().height($("#container").height()-adaptConfig.navcontent),$("#navcontent .nano").nanoScroller({alwaysVisible:!1}),$("#text-in").css("width",$(".edit-block").width()-adaptConfig.inputWidth)},$(window).bind("resize",exports.adaptHeight)}(jQuery,window,document),exports}),package("v.openflashchart",[],function(require,exports,moudle){return function($,window){var flashLoading=!1,flashLoadingTime=0;window.ofc_ready=function(){flashLoading=!1};var formart=function(val,num){var multiplicand=Math.pow(10,num),result=Math.round(val*multiplicand)/multiplicand;return result},cuter=function(num){for(var str=num.toString(),len=str.length,str2="",max=Math.floor(len/3),i=0;max>i;i++){var s=str.slice(len-3,len);str=str.substr(0,len-3),str2=","+s+str2,len=str.length}return str+=str2},getDataByType=function(type,data){switch(type){case"pie-reputation":for(var colors=["#d01f3c","#356aa0","#C79810","#33FF99"],result={elements:[{type:"pie",colour:"#f08618",width:2,"font-size":12,"start-angle":0,tip:"#val#\u4e2a#label#",radius:40,colours:[],values:[]}],bg_colour:"#ffffff"},total=0,i=0,length=data.length;length>i;i++)total+=data[i].value;for(var percentTotal=0,i=0,length=data.length;length>i;i++){var percent=0;0!=total&&(i==length-1?percent=formart(100-percentTotal,2):(percent=formart(Math.round(1e4*parseFloat(data[i].value/total))/1e4*100,2),percentTotal+=percent)),result.elements[0].values.push({value:data[i].value,label:data[i].label+"\n"+percent+"%"}),result.elements[0].colours.push(colors[i%colors.length])}return msJSON.stringify(result);case"line-price-trend":for(var result={elements:[{type:"line",colour:"#f08618",width:2,"font-size":12,values:[],"dot-style":{type:"solid-dot","dot-size":4,"halo-size":0,colour:"#f08618",tip:"#x_label#<br>#val#\u5143"}},{colour:"#006600","font-size":12,type:"tags",values:[{x:0,y:0,"align-y":"center",text:""}]},{colour:"#FF0033","font-size":12,type:"tags",values:[{x:0,y:0,"align-y":"center",text:""}]}],bg_colour:"#ffffff",x_axis:{colour:"#636363","grid-colour":"#E8E8E8",labels:{labels:[]},offset:!0,steps:1},y_axis:{labels:{text:"#val#"},colour:"#636363","grid-colour":"#E8E8E8",offset:0,min:0,max:1e3,steps:200}},min={x:0,y:data[0].value},max={x:0,y:data[0].value},i=0,length=data.length;length>i;i++)result.elements[0].values.push(data[i].value),result.x_axis.labels.labels.push(data[i].label.toString()),data[i].value<min.y&&(min.x=i,min.y=data[i].value),data[i].value>max.y&&(max.x=i,max.y=data[i].value);var diff=max.y-min.y,diffDigit=Math.round(diff).toString().length-1,minChart=Math.round(min.y/Math.pow(10,diffDigit))*Math.pow(10,diffDigit)-Math.pow(10,diffDigit),maxChart=Math.round(max.y/Math.pow(10,diffDigit))*Math.pow(10,diffDigit)+Math.pow(10,diffDigit);result.y_axis.min=0>minChart?0:minChart,result.y_axis.max=0>maxChart?0:maxChart;var steps=Math.round((result.y_axis.max-result.y_axis.min)/4);result.y_axis.steps=steps;var halfStep=steps/4,minLoc=min.y-halfStep;minLoc<result.y_axis.min&&(minLoc=result.y_axis.min+halfStep);var maxLoc=max.y+halfStep;return maxLoc>result.y_axis.max&&(minLoc=result.y_axis.max-halfStep),result.elements[1].values[0].x=min.x,result.elements[1].values[0].y=minLoc,result.elements[1].values[0].text="\u6700\u4f4e\uff1a"+cuter(min.y)+"\u5143",result.elements[2].values[0].x=max.x,result.elements[2].values[0].y=maxLoc,result.elements[2].values[0].text="\u6700\u9ad8\uff1a"+cuter(max.y)+"\u5143",msJSON.stringify(result)}};exports.createChartByElement=function($dom){var whConf={"pie-reputation":["235","90"],"line-price-trend":["450","180"]};$dom.find("*[data-chartdata]").each(function(index,ele){var $ele=$(ele),chartData=$ele.data("chartdata"),data=null;chartData&&(data=$.parseJSON(decodeURIComponent(chartData)));var id=$ele.attr("id"),type=$ele.data("charttype");setTimeout(function(){exports.createFlashChart(type,data,id,whConf[type][0],whConf[type][1])},100)})},exports.createFlashChart=function(type,data,id,width,height){var $dom=$("#"+id),args=arguments;return flashLoading?(flashLoadingTime>2e3&&(flashLoadingTime=0,flashLoading=!1),void setTimeout(function(){flashLoadingTime+=100,args.callee.apply(this,args)},100)):null===data||0==data.length?void $dom.html("\u8fd8\u6ca1\u6709\u5bf9\u5e94\u6570\u636e\u54e6\uff01"):($dom.html()||$dom.html("\u6570\u636e\u52a0\u8f7d\u4e2d..."),flashLoading=!0,window.open_flash_chart_data=function(){return getDataByType(type,data)},void swfobject.embedSWF("./open-flash-chart.swf",id,width,height,"9.0.0","misc/skin/common/i/expressInstall.swf",null,{wmode:"transparent"}))}}(jQuery,window),exports}),package("v.sidebar",[],function(require,exports,moudle){return function($,window){function displayContent(id){$("#navcontent .navc-content").hide(),$("#navcontent .js-navc-"+id).show(),setTimeout(function(){$(window).trigger("resize")},200)}function adjustTab(data){data&&data.state&&data.data||($("#bydd").hide(),$("#navcontent .js-navc-bydd").hide(),$("#bydd").hasClass("current")&&$("#bydd").siblings(".side-nav-item:first").trigger("mouseover"),$("#sidenav .side-nav-item:visible").length<3&&($("#grkj").is(":visible")?$("#sidenav .side-nav-item, #sidenav .tab_arrow").width("50%"):$("#grkj").show()))}function getQA(){var qaArray={result:[]};$.ajax({type:"get",url:"/ask/commonQa.action?__="+$.cookie("_robotAccess_")+"&source="+window.jimiSource,success:function(data){!function(){if(data&&data.statusCode){qaArray=data.obj}}()},complete:function(){var newAnswer=new AnswerFactory.createAnswer("buyConsult",qaArray);newAnswer.show($("#buyConsultDiv"),!1,!1),$(window.document).trigger("faqAdded")},dataType:"json"})}function init(){getLastestMonthOrder(adjustTab),getQA(),$("#grkj").append('<i class="side-nav-new"></i>'),isCustomerEntrance()?($("#productInfo").hide(),$("#bydd").trigger("mouseover")):(getProductInfo(),package("v.myspace").isShowMyspace?($("#bydd").hide(),$("#grkj").show()):($("#bydd").show(),$("#grkj").hide())),$(".intro-bar").siblings(".nano").find(".content").each(function(index,el){var item=$(this);item.height($("#jRightArea").outerHeight()-$("#sidenav").outerHeight()-$(".intro-bar").size()*$(".intro-bar").outerHeight())}),$(".intro-bar").siblings(".nano").hide()}$(document).on("click","#sidenav .side-nav-item a",function(){$(this).blur()}),$(document).on("click",".post-title .change-btn",function(){$(this).blur();var $wrapper=$(".post-goods-area-wrapper");if(!$wrapper.is(":animated")){var top=parseInt($(".post-goods-area-wrapper").css("top")),height=$wrapper.height(),itemHeight=$wrapper.find(".post-goods-area").outerHeight(),nextTop=top-itemHeight;-1*(top-itemHeight-10)>=height?$wrapper.stop().animate({top:"0px"},200):$wrapper.stop().animate({top:nextTop+"px"},200)}}),$(document).on("mouseover","#sidenav .side-nav-item",function(){var $this=$(this),left=$this.prevAll(":visible").length*($this.prevAll(":visible:first").width()||0);$(".tab_arrow").stop().animate({left:left},200),$this.parent().find("li.current").removeClass("current"),$this.addClass("current"),displayContent($this.attr("id"))}),$(document).on("click",".intro-bar",function(){var $this=$(this),$triangle=$this.find(">div");if($triangle.hasClass("triangle-open"))$this.next().hide(),$triangle.removeClass("triangle-open").addClass("triangle-close");else{$this.siblings().find(">div.triangle-open").removeClass("triangle-open").addClass("triangle-close"),$this.siblings(".detail:visible").hide(),$this.siblings(".nano:visible").hide(),$this.next().show(),$triangle.removeClass("triangle-close").addClass("triangle-open")}return setTimeout(function(){$(window).trigger("resize")},200),!1});var needTrackHide=!1,$oderTrack=$("#orderTrack");$oderTrack.on("mouseover",function(){$(this).show()}).on("mouseout",function(){$(this).hide()}),$("#navcontent").on("mouseout",function(){$("#orderTrack").hide()}),$("#orderListDiv").on("mouseover",".unfinish",function(){needTrackHide=!1;var $this=$(this);setTimeout(function(){if(!needTrackHide){var ele=$this,orderId=$this.attr("orderNum"),position=getPosition(ele);ele.data("showOrder",!0),$.ajax({type:"get",url:"/orderTrace/orderTrace.action?t="+(new Date).getTime(),data:{orderId:orderId},dataType:"json"}).success(function(data){var trackList=data.data;data.fe=!0;for(var newList=[],i=9,j=0;i>0;i--,j++){var k=trackList.length-j-1;k>=0&&(newList[j]=trackList[k])}data.data=newList;var newAnswer=new AnswerFactory.createAnswer(data.resultType,data);position.top<420?(position.left-=430,position.top-=newList.length/2*40):(position.left-=430,newList.length>=2&&(position.top-=40*(newList.length-2))),newAnswer.show($oderTrack,!1,!1,position)})}},200)}).on("mouseout",".unfinish",function(){needTrackHide=!0,$oderTrack.hide()}),$(document).on("keyup","#productUrl",function(evt){13==evt.keyCode&&($(this).blur(),$("#product-service-search .search-button").trigger("click"))}),$(document).on("click","#product-service-search .search-button",function(){function callSuccess(data){var newAnswer=new AnswerFactory.createAnswer(data.resultType,data.data);$searchArea.children(":gt(2)").remove(),newAnswer.show($searchArea,!0,!1),$(window).trigger("resize")}function callError(){return!1}var $searchArea=$("#product-service-search .answer"),urlStr=$(this).siblings("input").val(),reg=/^(\s*)http:\/\/item.jd.com\/[0-9]{6,12}.html(.*)$/gi;return reg.test(urlStr)?void $.ajax({type:"get",url:"/productService/productService.action?t="+(new Date).getTime(),data:{url:urlStr},success:callSuccess,error:callError,dataType:"json"}):(alert("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u5546\u54c1\u8be6\u60c5\u9875\u7684\u7f51\u9875\u5730\u5740"),!1)}),$(document).on("click","#orderListDiv .productBack",function(){var orderId=$(this).attr("orderNum"),text=$(this).html(),actionUrl="/cancelOrder/cancelOrder.action";"\u8fd4\u4fee/\u9000\u6362\u8d27"==text?actionUrl="/cancelOrder/repairOrder.action":text.indexOf("\u8fdb\u5ea6\u67e5\u8be2")>=0&&(actionUrl="/cancelOrder/seeRepairOrder.action"),$.ajax({type:"get",url:actionUrl+"?t="+(new Date).getTime(),data:{orderNo:orderId},dataType:"json"}).success(function(data){var data=data;data.fe=!0;var newAnswer=new AnswerFactory.createAnswer(data.resultType,data),ele=$("#chatcontent");newAnswer.show(ele,!0,!0),setScroll(),$("#text-in").focus()})}),$(document).on("click","#orderListDiv .intro-bar .book-list a",function(e){e.stopPropagation()}),exports.init=init}(jQuery,window),exports}),package("v.answerHandle",[],function(require,exports,moudle){return function($,window,document){exports.answerRender=function(data,$replaceMsg){var answer,ele=$("#chatcontent");answer=AnswerFactory.createAnswer(data.ptype,data.answers),$replaceMsg&&$replaceMsg.removeClass().html(""),callback&&callback(data.answer),answer.show($replaceMsg||ele,!0,!0),setScroll()}}(jQuery,window,document),exports}),package("v.myjimi",[],function(require,exports,moudle){return function($,window,undefined){var config={gender:{0:"male",1:"female"},dist_url:"//static.360buyimg.com/jimi/dist/v20150522/",header_img:{novice:{0:"novice-male",1:"novice-female"},elementary:{0:"elementary-male",1:"elementary-female"},middle:{0:"middle-male",1:"middle-female"},high:{0:"high-male",1:"high-female"},top:{0:"high-male",1:"high-female"},1:"self-1",2:"self-2",3:"self-3",4:"self-4",5:"self-5"}};exports.config=config,exports.levelType="novice",exports.header_class="novice-male",exports.skin_type=1,exports.pic_type=0,exports.nickName="JIMI",exports.showIndex=function(adopt_name,event){$("#lyjimi a").text("\u6211\u7684JIMI"),$.template("myjimi.index",unescape('<div class="myjimi-index-mask-gain"><div class="myjimi-index-gain"><div class="gain-guazi"><i class="gain-pic-guazi"></i> <span class="gain-exp-guazi"></span></div><div class="gain-text"><p id="gain-text-content">\u74dc\u5b50\u8d8a\u591a\uff0c\u5347\u7ea7\u8d8a\u5feb\u54e6</p></div><div class="gain-btn-confirm"></div></div></div><div class="myjimi-index-mask-lv"><div class="myjimi-index-lv"><div class="lv-bg-round"><div class="lv-bg-header novice-male"><div class="lv-bg-flag"></div></div></div><div class="lv-text-content"><p>\u5b8c\u6210<span id="task-name"></span>\u7684\u4efb\u52a1</p><p>\u83b7\u5f97\u74dc\u5b50\u5956\u52b1</p></div><div class="gain-guazi"><i class="gain-pic-guazi"></i> <span class="gain-exp-guazi"></span></div><div class="lv-btn-confirm"></div></div></div><div class="myjimi-index-mask-sign-in"><div class="myjimi-index-sign-in"><div class="sign-in-btn-confirm"></div></div></div><div class="myjimi-index-mask-adopt-success"><div class="myjimi-index-adopt-success"><div class="text-content"><p>\u73b0\u5728\u5f00\u59cb\uff0c<span class="adopt-name"></span></p><p>\u5c31\u662f\u4e3b\u4eba\u7684\u4e13\u5c5e\u79d8\u4e66\u5566\uff01</p><p>\u4eac\u4e1c\u8d2d\u7269\u6709\u7591\u95ee</p><p>\u627e<span class="adopt-name"></span>\u89e3\u51b3\uff01</p></div><div class="adopt-success-btn-confirm"></div></div></div><div class="myjimi-index-header"><div class="myjimi-index-out"></div><div class="myjimi-index-header-container"><div class="myjimi-index-header-img novice-male"><span id="level-info"></span><div class="myjimi-index-header-flag"><i id="gender-info" class="gender-icon male"></i> <span id="age-info"></span></div></div></div><div class="myjimi-header-name"></div><div class="myjimi-index-title"></div></div><div class="myjimi-index-shake"></div><div class="myjimi-index-content"><i class="exp-icon"></i> <span class="exp-num"></span><div class="exp-progress-primary"><div class="exp-progress-secondary"></div></div><span class="exp-ratio"></span><div class="btn-help">\u517b\u6210\u5e2e\u52a9</div></div><div class="myjimi-index-task"><div class="task-body"><i class="task-flag"></i> <i class="task-left arrow-left-gray"></i> <i data-value="" class="task-icon" id="task-a"></i> <i data-value="" class="task-icon" id="task-b"></i> <i data-value="" class="task-icon" id="task-c"></i> <i class="task-right arrow-right"></i></div></div><div class="myjimi-index-skill"><div class="skill-body"><i class="skill-flag"></i> <i class="skill-left arrow-left-gray"></i> <i data-value="" class="skill-icon" id="skill-a"></i> <i data-value="" class="skill-icon" id="skill-b"></i> <i data-value="" class="skill-icon" id="skill-c"></i> <i class="skill-right arrow-right"></i></div></div><div class="myjimi-index-tip"><div class="myjimi-tip-text"><p>\u52a0\u6cb9\u5440\u4e3b\u4eba\uff01\u5347\u7ea7\u5230<span id="tip-level"></span>\u7ea7\uff0c\u5c31\u6709\u65b0\u6280\u80fdget\uff0c</p><p>\u65b0\u76ae\u80a4\u3001\u65b0\u4efb\u52a1\u5f00\u542f\u54e6\uff01</p></div></div>')),$("#myJimi").html($.tmpl("myjimi.index")).show(),bindIndexEvent(),processUserInfo(event),"new"==event&&($(".myjimi-index-mask-adopt-success").show(),$(".adopt-name").text(adopt_name))};var showMaskingGuide1=function(){var $body=$("body"),$startHtml="<div class='masking-guide-1'>                <div class='btn-next'></div>                <div class='x-close'></div>                </div>";$("#masterDiv").css({display:"block",left:0}),$body.append($startHtml).show(),$("#grkj").addClass("current").siblings().removeClass("current"),$(".js-navc-grkj").show().siblings().hide();var $index_header=$(".myjimi-index-header");$(".masking-guide-1").css({left:$index_header.offset().left-343,top:$index_header.offset().top+93}),$(".x-close").on("click",function(){$(".masking-guide-1").remove(),$("#masterDiv").hide()}),$(".btn-next").on("click",function(){$(".masking-guide-1").remove(),$("#masterDiv").hide(),showMaskingGuide2()})},showMaskingGuide2=function(){var $body=$("body"),$startHtml="<div class='masking-guide-2'>                <div class='btn-next'></div>                <div class='x-close'></div>                </div>";$("#masterDiv").css({display:"block",left:0}),$body.append($startHtml).show();var $index_task=$(".myjimi-index-task");$(".masking-guide-2").css({left:$index_task.offset().left-338,top:$index_task.offset().top-30}),$(".x-close").on("click",function(){$(".masking-guide-2").remove(),$("#masterDiv").hide()}),$(".btn-next").on("click",function(){$(".masking-guide-2").remove(),$("#masterDiv").hide(),showMaskingGuide3()})},showMaskingGuide3=function(){var $body=$("body"),$startHtml="<div class='masking-guide-3'>                <div class='btn-finish'></div>                <div class='x-close'></div>                </div>";$("#masterDiv").css({display:"block",left:0}),$body.append($startHtml).show();var $index_skill=$(".myjimi-index-skill");$(".masking-guide-3").css({left:$index_skill.offset().left-333,top:$index_skill.offset().top-25}),$(".x-close").on("click",function(){$(".masking-guide-3").remove(),$("#masterDiv").hide()}),$(".btn-finish").on("click",function(){$(".masking-guide-3").remove(),$("#masterDiv").hide()})},help_qa=[{question:"Q : \u74dc\u5b50\u662f\u4ec0\u4e48\uff1f",answer:"A : \u74dc\u5b50\u662f\u6211\u7684JIMI\u5b8c\u6210\u4efb\u52a1\u540e\u7ed9\u4e88\u7684\u5956\u52b1\u3002"},{question:"Q : \u6211\u7684JIMI\u540d\u5b57\u53ef\u4ee5\u4fee\u6539\u5417\uff1f",answer:"A : \u6211\u7684JIMI\u540d\u5b57\u4e00\u65e6\u63d0\u4ea4\u6682\u4e0d\u652f\u6301\u4fee\u6539\u3002"},{question:"Q : \u8fde\u7eed\u7684\u7b7e\u5230\u4f1a\u989d\u5916\u589e\u52a0\u74dc\u5b50\u5417\uff1f",answer:"A : \u6211\u7684JIMI\u6bcf\u65e5\u7b7e\u5230\u4e00\u6b21\u53ef\u83b7\u5f97\u5bf9\u5e94\u74dc\u5b50\u6570\u91cf\uff0c\u6f0f\u7b7e\u540e\u65e0\u6cd5\u8865\u7b7e\uff0c\u4e00\u5929\u5185\u8fde\u7eed\u7b7e\u5230\u6682\u65f6\u65e0\u989d\u5916\u74dc\u5b50\u3002"},{question:"Q : \u201c\u51fa\u7a9d\u201d\u6709\u4ec0\u4e48\u4f5c\u7528\uff1f",answer:"A : \u70b9\u51fb\u201c\u51fa\u7a9d\u201d\u540e\u53ef\u4ee5\u5c06\u6211\u7684JIMI\u653e\u7f6e\u5728\u4efb\u4f55\u4f60\u60f3\u653e\u7f6e\u7684\u7f51\u9875\u4f4d\u7f6e\u3002"},{question:"Q : \u600e\u4e48\u70b9\u4eae\u5fbd\u7ae0\uff1f\u5fbd\u7ae0\u4f1a\u706d\u5417\uff1f",answer:"A : \u6211\u7684JIMI\u6709\u5b88\u65f6\u8fbe\u4eba\u3001\u4e1a\u52a1\u8fbe\u4eba\u3001\u5a31\u4e50\u8fbe\u4eba\u7b49\u51e0\u4e2a\u5fbd\u7ae0\uff1b\u53ef\u4ee5\u901a\u8fc7\u5b8c\u6210\u4efb\u52a1\u6765\u70b9\u4eae\u5fbd\u7ae0\uff0c\u5fbd\u7ae0\u70b9\u4eae\u540e\u4e0d\u4f1a\u7184\u706d\u3002"},{question:"Q : \u6211\u7684JIMI\u662f\u600e\u4e48\u73a9\u7684\uff1f ",answer:"A : \u6211\u7684JIMI\u53ef\u4ee5\u9080\u8bf7\u597d\u53cb\u9886\u517b\u4e86\u4e00\u8d77\u73a9\uff0c\u4f5c\u8bd7\u3001\u8bb2\u7b11\u8bdd\u7b49\u3002"},{question:"Q : \u6211\u7684JIMI\u90fd\u6709\u54ea\u4e9b\u6280\u80fd\uff1f",answer:"A : \u968f\u7740JIMI\u7b49\u7ea7\u7684\u63d0\u9ad8\uff0c\u6280\u80fd\u6709\u6362\u80a4\u3001\u4eca\u65e5\u8fd0\u7a0b\u3001\u5929\u6c14\u65e9\u77e5\u9053\u7b49\u3002"},{question:"Q : \u65b0\u624b\u6280\u80fd\u8bd5\u73a9\uff0c\u600e\u4e48\u73a9\uff1f",answer:"A : \u9996\u5148\u70b9\u51fb\u6211\u7684\u65b0\u624b\u6280\u80fd\u8bd5\u73a9\uff0c\u51fa\u73b0\u7b2c\u4e00\u6b21\u73a9\u65b0\u6280\u80fd\u53ef\u4ee5\u83b7\u74dc\u5b50\u63d0\u793a\uff0c\u9009\u62e9\u5176\u4e2d\u4efb\u610f\u4e00\u4e2a\u5c55\u793a\u7684\u6280\u80fd\uff0c\u70b9\u51fb\u8bd5\u73a9\u5c31\u53ef\u4ee5\u4e86\u3002"}],bindIndexEvent=function(){$("#myJimi").on("click",".adopt-success-btn-confirm",function(){$(".myjimi-index-mask-adopt-success").hide(),package("v.myjimi.service").ajaxServices.isShowGuideFlow().success(function(resp){resp.code&&resp.data.show_guide_flow_flag&&showMaskingGuide1()})}).on("click",".myjimi-index-out",function(){if(0==$(".myjimi-move-wrapper").length){var $body=$("body"),$moveHtml="<div class='myjimi-move-wrapper'>                        <div class='myjimi-move-body'>                        </div>                        <div class='myjimi-move-shake'></div>                        <div class='myjimi-move-icon clearfix'>                        <i class='myjimi-btn-back'></i>                        <i class='myjimi-btn-shake'></i>                        </div>                        </div>";$body.append($moveHtml).show(),$(".myjimi-index-header-img").attr("class","myjimi-index-header-img"),$(".myjimi-index-out").attr("class","myjimi-index-in"),$(".myjimi-move-body").attr("class","myjimi-move-body "+exports.header_class+"-body"),
package("v.myjimi.skill").shake_pos="move",move(),$(".myjimi-btn-back").on("click",function(){$(".myjimi-index-header-img").attr("class","myjimi-index-header-img "+exports.header_class),$(".myjimi-index-in").attr("class","myjimi-index-out"),package("v.myjimi.skill").shake_pos="index",$(".myjimi-move-wrapper").remove()}),$(".myjimi-btn-shake").on("click",function(){package("v.myjimi.skill").move_flag||package("v.myjimi.service").skillSubmitService("shake",{pos:"move"},package("v.myjimi.skill").skillCallback.shake.submitCallBack)})}}).on("click",".myjimi-index-in",function(){$(".myjimi-index-header-img").attr("class","myjimi-index-header-img "+exports.header_class),$(".myjimi-index-in").attr("class","myjimi-index-out"),package("v.myjimi.skill").shake_pos="index",$(".myjimi-move-wrapper").remove()}),$(".btn-help").on("click",function(){var $body=$("body"),$helpHtml="<div class='btn-help-content'>                    <div class='help-title'>\u517b\u6210\u5e2e\u52a9</div>                    <div class='help-qa'></div>                    <div class='btn-help-ok'><div>                    </div>";$("#masterDiv").css({display:"block",left:0}),$body.append($helpHtml).show(),$.each(help_qa,function(idx,qa){var $question=$("<p></p>").attr("class","question").text(qa.question),$answer=$("<p></p>").attr("class","answer").text(qa.answer);$(".help-qa").append($question).append($answer).append($("<br/>"))}),$(".btn-help-ok").on("click",function(){$(".btn-help-content").remove(),$("#masterDiv").hide()})}),$(".exp-progress-primary").on("mouseover",function(){var $body=$("body"),$progress=$(this),$progressPop=$("<div></div>").attr("class","progress-pop").text("\u5176\u5b9e\u8fd9\u662f\u7ecf\u9a8c\u69fd\uff01").css({left:$progress.offset().left+80,top:$progress.offset().top+25});$body.append($progressPop),$progressPop.fadeIn(500)}).on("mouseout",function(){$(".progress-pop").remove()}),$(".myjimi-header-name").on("mouseover",function(){var $window=$(window),$body=$("body"),$name=$(this),$namePop=$("<div></div>").attr("class","name-pop").text("\u8fd9\u662f\u5c0fJIMI\u7684\u540d\u724c\uff01").css({right:$window.width()-$name.offset().left-$name.width(),top:$name.offset().top+35});$body.append($namePop),$namePop.fadeIn(500)}).on("mouseout",function(){$(".name-pop").remove()}),$("#level-info").on("mouseover",function(){var $body=$("body"),$level=$(this),$levelPop=$("<div></div>").attr("class","level-pop").text("\u7b49\u7ea7\u592a\u4f4e\uff0c\u4e3b\u4eba\u8981\u52aa\u529b\u554a\uff01").css({left:$level.offset().left+40,top:$level.offset().top+20});$body.append($levelPop),$levelPop.fadeIn(500)}).on("mouseout",function(){$(".level-pop").remove()})},move=function(){var sd_x,sd_y,sd_move=!1;$this=$(".myjimi-move-wrapper"),$this.mousedown(function(e){sd_move=!0,sd_x=e.pageX-$this.position().left,sd_y=e.pageY-$this.position().top}).mousemove(function(e){if(sd_move){var x=e.pageX-sd_x,y=e.pageY-sd_y;$this.css({left:x,top:y})}}).mouseup(function(){sd_move=!1})},processUserInfo=function(event){package("v.myjimi.service").ajaxServices.getUserInfo().success(function(resp){if(resp.code){var data=resp.data;"new"!=event&&data.adoptDay<3&&package("v.myjimi.service").ajaxServices.isShowGuideFlow().success(function(resp){resp.code&&resp.data.show_guide_flow_flag&&showMaskingGuide1()}),exports.nickName=data.nickName,$(".myjimi-header-name").text(data.nickName),$(".myjimi-move-name").text(data.nickName),$("#gender-info").attr("class","gender-icon "+config.gender[data.gender]),$("#age-info").text(data.adoptDay+"\u5929"),exports.levelType=data.levelType,exports.pic_type=data.picType,exports.skin_type=data.skinType,0!=exports.pic_type?exports.header_class=config.header_img[exports.pic_type]:exports.header_class=config.header_img[exports.levelType][data.gender],exports.renderJimiPic(),exports.renderPic(),exports.renderSkin(),$("#level-info").text("Lv."+data.level),$(".exp-num").text(data.exp),$(".exp-ratio").text(data.exp+"/"+data.expLimit);var primary_progress_width=$(".exp-progress-primary").width(),secondary_progress_width=Math.round(data.exp/data.expLimit*primary_progress_width);$(".exp-progress-secondary").animate({width:secondary_progress_width},1e3),package("v.myjimi.task").handleTaskInfo(data),package("v.myjimi.skill").handleSkillInfo(data),exports.showIndexTip(data.level)}})};exports.showIndexTip=function(level){(8==level||9==level)&&($(".myjimi-index-tip").show(),$("#tip-level").text("10")),(18==level||19==level)&&($(".myjimi-index-tip").show(),$("#tip-level").text("20")),(28==level||29==level)&&($(".myjimi-index-tip").show(),$("#tip-level").text("30")),(38==level||39==level)&&($(".myjimi-index-tip").show(),$("#tip-level").text("40"))},exports.renderJimiPic=function(){setTimeout(function(){$.each($(".jimi_lists"),function(idx,e){$(this).find(".header_img").attr("class","header_img fl "+exports.header_class)})},500),window.jimiHeader=exports.header_class},exports.renderPic=function(){"index"==package("v.myjimi.skill").shake_pos&&$(".myjimi-index-header-img").attr("class","myjimi-index-header-img "+exports.header_class),$(".lv-bg-header").attr("class","lv-bg-header "+exports.header_class),$(".myjimi-move-body").attr("class","myjimi-move-body "+exports.header_class+"-body")};var skinBgConfig={skinBg:{2:"i/bg-purple.png",3:"i/bg-green.png",4:"i/bg-pink.png"},full_screen_bg:{1:"full-screen",2:"full-screen-purple",3:"full-screen-green",4:"full-screen-pink"},full_screen_quit_bg:{1:"full-screen-quit",2:"full-screen-quit-purple",3:"full-screen-quit-green",4:"full-screen-quit-pink"},close_screen_bg:{1:"close-screen",2:"close-screen-purple",3:"close-screen-green",4:"close-screen-pink"}};exports.skinBgConfig=skinBgConfig,exports.renderSkin=function(){1==exports.skin_type?$(".header").css("backgroundImage",""):$(".header").css("backgroundImage","url("+config.dist_url+skinBgConfig.skinBg[exports.skin_type]+")");var $winmax=$("#winmax");-1!=$winmax.attr("class").indexOf("quit")?$winmax.attr("class",skinBgConfig.full_screen_quit_bg[exports.skin_type]):$winmax.attr("class",skinBgConfig.full_screen_bg[exports.skin_type]),$("#winclose_top").attr("class",skinBgConfig.close_screen_bg[exports.skin_type])}}(jQuery,window,void 0),exports}),package("v.myjimi.adopt",[],function(require,exports,module){return function($,window,document){exports.init=function(event){$("#lyjimi a").text("\u9886\u517bJIMI"),$("#j_teach").hide(),package("v.myjimi.service").ajaxServices.isAdopted().success(function(resp){if(resp.code)if(null==resp.data)exports.showIntro();else if(resp.data.adopted)package("v.myjimi").showIndex();else{if("adopt"==event)return void exports.showAdopt();exports.showIntro(),package("v.myjimi.service").ajaxServices.isShowGuide().success(function(resp){resp.code&&resp.data.show_guide_flag&&showMaskingStart()})}})};var showMaskingStart=function(){var $body=$("body"),$startHtml="<div class='masking-guide-start'>                <div class='btn-start'></div>                </div>";$("#masterDiv").css({display:"block",left:0}),$body.append($startHtml).show();var $tab_space=$("#lyjimi a");$(".masking-guide-start").css({left:$tab_space.offset().left-300,top:$tab_space.offset().top+15}),$(".btn-start").on("click",function(){$("#lyjimi").addClass("current").siblings().removeClass("current"),$(".tab_arrow").css({left:"238px"}),$(".js-navc-lyjimi").show().siblings().hide(),$(".masking-guide-start").remove(),$("#masterDiv").hide()})};exports.showIntro=function(){$.template("myjimi.intro",unescape('<div class="myjimi-intro-wrapper"><div class="myjimi-intro-img"><div class="myjimi-intro-flag" id="myjimi-adopt"></div></div></div>')),$("#myJimi").html($.tmpl("myjimi.intro")).show(),initIntroEvent()},exports.showAdopt=function(){$.template("myjimi.adopt",unescape('<div class="myjimi-adopt-wrapper"><div class="myjimi-adopt-avatar male" id="adopt-gender"><div class="myjimi-adopt-flag"></div></div><div class="myjimi-adopt-form"><p class="myjimi-adopt-tips">\u4e3b\u4eba\uff0c\u4e3b\u4eba\uff0c\u7ed9\u6211\u8d77\u4e2a\u540d\u5b57\u5427\uff01<br>\u4ee5\u540e\u6211\u5c31\u662f\u60a8\u7684\u4e13\u5c5eJIMI\u5566\uff01</p><div class="myjimi-adopt-name"><input class="myjimi-adopt-name-input" id="adopt-name" maxlength="10" value=""><p class="myjimi-adopt-name-error"></p></div><ul class="myjimi-adopt-gender clearfix"><li class="fl checked" id="adopt-male"><i class="icon-adopt-male"></i><i class="icon-adopt-checked"></i></li><li class="fr" id="adopt-female"><i class="icon-adopt-female"></i><i class="icon-adopt-checked"></i></li></ul></div><div class="myjimi-adopt-submit"><button class="btn btn-default" id="adopt-cancel">\u6539\u5929\u9886\u517b</button> <button class="btn btn-primary" id="adopt-ok">\u7acb\u5373\u9886\u517b</button></div></div>')),$("#myJimi").html($.tmpl("myjimi.adopt")).show(),$("#adopt-name").focus(),initAdoptEvent()};var initIntroEvent=function(){$("#myjimi-adopt").on("click",function(){package("v.myjimi.service").ajaxServices.isAdopted().success(function(resp){resp.code&&(null==resp.data?$(".jimi-noLogin-msgTips").find("a").trigger("click"):resp.data.adopted?package("v.myjimi").showIndex():exports.showAdopt())})})},initAdoptEvent=function(){$("#myJimi").on("click","#adopt-male, #adopt-female",function(){var $this=$(this),$adopt_gender=$("#adopt-gender");$this.addClass("checked").siblings("li").removeClass("checked"),"adopt-male"==$this.attr("id")?$adopt_gender.removeClass("female").addClass("male"):$adopt_gender.removeClass("male").addClass("female")}).on("click","#adopt-cancel",function(){exports.showIntro()}).on("click","#adopt-ok",function(){var adopt_name=$("#adopt-name").val().trim();if(""==adopt_name)return void $(".myjimi-adopt-name-error").text("\u4e3b\u4eba\uff0c\u7ed9\u6211\u8d77\u4e2a\u540d\u5b57\u5427").show();var data={nickName:adopt_name,gender:$("#adopt-male").hasClass("checked")?0:1,invitingUser:window.invitingUser};package("v.myjimi.service").ajaxServices.adoptJimi(data).success(function(resp){resp.code&&(resp.data.exist?$(".myjimi-adopt-name-error").text("\u4e3b\u4eba\uff0c\u8fd9\u4e2a\u540d\u5b57\u5df2\u7ecf\u6709\u5566").show():package("v.myjimi").showIndex(adopt_name,"new"))})})}}(jQuery,window,document),exports}),package("v.myjimi.service",[],function(require,exports,module){return function($,window,document){exports.ajaxServices=function(){var domain="//uu-jimi.jd.com",services={isAdopted:{method:"POST",url:"/myJimi/isAdopted"},adoptJimi:{method:"POST",url:"/myJimi/adoptJimi"},getUserInfo:{method:"POST",url:"/myJimi/getUserInfo"},updateUserSkinAndPic:{method:"POST",url:"/myJimi/updateUserSkinAndPic"},isShowGuide:{method:"POST",url:"/myJimi/isShowGuide"},isShowGuideFlow:{method:"POST",url:"/myJimi/isShowGuideFlow"}};return $.each(services,function(funcName,request){services[funcName]=function(data){return data=data||{},$.ajax({method:request.method,url:domain+request.url,cache:!1,dataType:"jsonp",data:data})}}),services}(),exports.taskProcessService=function(taskName,callback){$.ajax({method:"POST",url:"//uu-jimi.jd.com/myJimi/processTask",cache:!1,dataType:"jsonp",data:{taskName:taskName}}).success(function(resp){resp.code&&"function"==typeof callback&&callback(resp.data)})},exports.taskSubmitService=function(taskName,extInfo,callback){$.ajax({method:"POST",url:"//uu-jimi.jd.com/myJimi/submitTask",cache:!1,dataType:"jsonp",data:{taskName:taskName,extInfo:JSON.stringify(extInfo)}}).success(function(resp){resp.code&&("function"==typeof callback&&callback(resp.data,extInfo),null!=resp.data.taskResult.expGain&&package("v.myjimi.task").showExpGainTip(resp.data,taskName,extInfo))})},exports.skillProcessService=function(skillName,callback){$.ajax({method:"POST",url:"//uu-jimi.jd.com/myJimi/processSkill",cache:!1,dataType:"jsonp",data:{skillName:skillName}}).success(function(resp){resp.code&&"function"==typeof callback&&callback(resp.data)})},exports.skillSubmitService=function(skillName,extInfo,callback){$.ajax({method:"POST",url:"//uu-jimi.jd.com/myJimi/submitSkill",cache:!1,dataType:"jsonp",data:{skillName:skillName,extInfo:JSON.stringify(extInfo)}}).success(function(resp){resp.code?"function"==typeof callback&&callback(resp.data,extInfo):"function"==typeof callback&&callback(resp.data,null)})}}(jQuery,window,document),exports}),package("v.myjimi.task",[],function(require,exports,moudle){var task_config={title:{fun_master:"\u5a31\u4e50\u8fbe\u4eba",time_master:"\u5b88\u65f6\u8fbe\u4eba",bussiness_master:"\u4e1a\u52a1\u8fbe\u4eba",hot_heart:"\u70ed\u5fc3\u80a0",test_master:"\u4f17\u6d4b\u8fbe\u4eba"},task:{bussiness:"task-bussiness",invite_friend_adopt:"task-invite-friend-adopt",invite_friend_wechat:"task-invite-friend-wechat",sign_in:"task-sign-in",try_novice:"task-try-novice",try_high:"task-try-high",try_middle:"task-try-middle",try_elementary:"task-try-elementary",knowledge_qa:"task-knowledge-qa",talk_qa:"task-talk-qa"},taskName:{bussiness:"\u719f\u6089JIMI\u4e1a\u52a1",invite_friend_adopt:"\u9080\u8bf7\u597d\u53cb\u9886\u517b",invite_friend_wechat:"\u9080\u8bf7\u597d\u53cb\u5173\u6ce8",sign_in:"\u6bcf\u65e5\u7b7e\u5230",try_novice:"\u65b0\u624b\u6280\u80fd\u8bd5\u73a9",try_high:"\u9ad8\u7ea7\u6280\u80fd\u8bd5\u73a9",try_middle:"\u4e2d\u7ea7\u6280\u80fd\u8bd5\u73a9",try_elementary:"\u521d\u7ea7\u6280\u80fd\u8bd5\u73a9",knowledge_qa:"\u77e5\u8bc6\u95ee\u7b54",talk_qa:"\u4e92\u8bc9\u8877\u80a0"},taskDesc:{bussiness:"\u719f\u6089JIMI\u7684\u4e1a\u52a1\u529f\u80fd",invite_friend_adopt:"\u9080\u8bf7\u597d\u53cb\u9886\u517bJIMI\uff0c\u597d\u53cb\u9886\u517b\u6210\u529f\uff0c\u4e3b\u4eba\u83b7\u5f97\u74dc\u5b50\u5956\u52b1",sign_in:"JIMI\u6253\u5361",try_novice:"\u8bd5\u73a9\u4efb\u610f\u65b0\u624b\u6280\u80fd\uff0c\u6bcf\u5929\u7b2c\u4e00\u6b21\u8bd5\u73a9\u6709\u74dc\u5b50\u5956\u52b1",try_high:'\u8bd5\u73a9\u9ad8\u7ea7\u6280\u80fd"\u8d85\u65f6\u7a7a\u63a5\u89e6"\u6216\u8005"\u4eba\u5de5\u670d\u52a1"\uff0c\u6bcf\u5929\u7b2c\u4e00\u6b21\u8bd5\u73a9\u6709\u74dc\u5b50\u5956\u52b1',try_middle:'\u8bd5\u73a9\u4e2d\u7ea7\u6280\u80fd"\u5411TA\u8868\u767d"\uff0c\u6bcf\u5929\u7b2c\u4e00\u6b21\u8bd5\u73a9\u6709\u74dc\u5b50\u5956\u52b1',try_elementary:'\u8bd5\u73a9\u521d\u7ea7\u6280\u80fd"\u4e13\u5c5e\u6559\u5b66"\uff0c\u6bcf\u5929\u7b2c\u4e00\u6b21\u8bd5\u73a9\u6709\u74dc\u5b50\u5956\u52b1',knowledge_qa:"\u77e5\u8bc6\u95ee\u7b54",talk_qa:"\u4e92\u8bc9\u8877\u80a0"}};exports.task_config=task_config;var taskContainer={taskName:[],taskBg:[],taskSize:0,taskIdx:0};exports.taskContainer=taskContainer,exports.handleTaskInfo=function(data){exports.showTitle(data.titleItems),exports.showTask(data.taskItems),exports.bindTaskEvent(),null!=data.invitedUser&&package("v.myjimi.task").taskSubmitService("invite_friend_adopt",{invitedUser:data.invitedUser})},exports.showTitle=function(titleItems){var $titleBody=$(".myjimi-index-title");$titleBody.html(""),$.each(titleItems,function(idx,item){var titleElem=$("<i></i>");item.mark?titleElem.attr("class","title-icon title_"+item.itemName).attr("data-value",item.itemName).attr("data-label",item.level):titleElem.attr("class","title-icon title_"+item.itemName+"_gray").attr("data-value",item.itemName),$titleBody.append(titleElem)})},exports.showTask=function(taskItems){taskContainer.taskName=[],taskContainer.taskBg=[],taskContainer.taskSize=0,taskContainer.taskIdx=0,$.each(taskItems,function(idx,item){taskContainer.taskName.push(item.itemName),item.mark?taskContainer.taskBg.push(task_config.task[item.itemName]):taskContainer.taskBg.push(task_config.task[item.itemName]+"-gray"),++taskContainer.taskSize}),taskContainer.taskSize<4&&$(".task-right").removeClass("arrow-right").addClass("arrow-right-gray"),exports.tabTask(taskContainer.taskIdx)},exports.tabTask=function(){var idx=taskContainer.taskIdx,$taskA=$("#task-a"),$taskB=$("#task-b"),$taskC=$("#task-c");$taskA.attr("data-value",taskContainer.taskName[idx]),$taskB.attr("data-value",taskContainer.taskName[idx+1]),$taskC.attr("data-value",taskContainer.taskName[idx+2]),$taskA.attr("class","task-icon "+taskContainer.taskBg[idx]),$taskB.attr("class","task-icon "+taskContainer.taskBg[idx+1]),$taskC.attr("class","task-icon "+taskContainer.taskBg[idx+2])},exports.bindTaskEvent=function(){$(".task-left").on("click",function(){var idx=taskContainer.taskIdx;0!=idx&&(idx==taskContainer.taskSize-3&&$(".task-right").removeClass("arrow-right-gray").addClass("arrow-right"),0>idx-3?(taskContainer.taskIdx=0,$(this).removeClass("arrow-left").addClass("arrow-left-gray")):taskContainer.taskIdx=idx-3,exports.tabTask())}),$(".task-right").on("click",function(){var idx=taskContainer.taskIdx;idx!=taskContainer.taskSize-3&&(0==idx&&$(".task-left").removeClass("arrow-left-gray").addClass("arrow-left"),idx+6>taskContainer.taskSize-1?(taskContainer.taskIdx=taskContainer.taskSize-3,$(this).removeClass("arrow-right").addClass("arrow-right-gray")):taskContainer.taskIdx=idx+3,exports.tabTask())}),$(".task-flag").on("mouseover",function(){var $body=$("body"),$taskFlag=$(".task-flag"),$taskFlagPop=$("<div></div>").attr("class","task-flag-pop").text("\u505a\u4efb\u52a1\u83b7\u5f97\u74dc\u5b50\uff0c\u74dc\u5b50\u8d8a\u591a\u5347\u7ea7\u8d8a\u5feb!").css({left:$taskFlag.offset().left+45,top:$taskFlag.offset().top+10});$body.append($taskFlagPop),$taskFlagPop.fadeIn(500)}).on("mouseout",function(){$(".task-flag-pop").remove()}),$(".title-icon").on("mouseover",function(){var $body=$("body"),$title=$(this),titleDesc="";titleDesc=-1!=$title.attr("class").indexOf("gray")?task_config.title[$title.attr("data-value")]:task_config.title[$title.attr("data-value")]+"  "+$title.attr("data-label")+"\u7ea7";var $titlePop=$("<div></div>").attr("class","title-pop").text(titleDesc).css({left:$title.offset().left+15,top:$title.offset().top-25});$body.append($titlePop),$titlePop.fadeIn(500)}).on("mouseout",function(){$(".title-pop").remove()}),$(".task-icon").on("mouseover",function(){var $window=$(window),$body=$("body"),$task=$(this),$taskPop=$("<div></div>").attr("class","task-pop").text(task_config.taskDesc[$task.attr("data-value")]).css({left:$task.offset().left-30,bottom:$window.height()-$task.offset().top-5});$body.append($taskPop),$taskPop.fadeIn(500)}).on("mouseout",function(){$(".task-pop").remove()}),$(".task-icon").on("click",function(){if(-1==$(this).attr("class").indexOf("gray")){var taskName=$(this).attr("data-value");"try_novice"==taskName||"invite_friend_adopt"==taskName||"try_elementary"==taskName||"try_middle"==taskName||"try_high"==taskName||"knowledge_qa"==taskName||"talk_qa"==taskName?package("v.myjimi.service").taskProcessService(taskName,taskCallback[taskName].processCallBack):package("v.myjimi.service").taskSubmitService(taskName,{},taskCallback[taskName].submitCallBack)}})},exports.showExpGainTip=function(data,taskName,extInfo){$.each($(".myjimi-index-title").find("i"),function(idx,e){var $this=$(this);-1!=$this.attr("class").indexOf(data.taskResult.title)&&-1!=$this.attr("class").indexOf("gray")&&$this.attr("class","title-icon title_"+data.taskResult.title).attr("data-label",0)}),$(".exp-num").text(data.taskResult.expUpdated),$(".exp-ratio").text(data.taskResult.expUpdated+"/"+data.expLimit),$("#level-info").text("Lv."+data.level);var secondary_progress_width=Math.round(data.taskResult.expUpdated/data.expLimit*$(".exp-progress-primary").width());$(".exp-progress-secondary").css({width:secondary_progress_width}),data.levelTypeUpdated&&(0==package("v.myjimi").pic_type&&(package("v.myjimi").header_class=package("v.myjimi").header_class.replace(package("v.myjimi").levelType,data.levelType),package("v.myjimi").renderJimiPic(),package("v.myjimi").renderPic()),package("v.myjimi").levelType=data.levelType),data.levelUpdated?($(".myjimi-index-mask-lv").show(),$(".lv-bg-flag").text("Lv."+data.level),$("#task-name").text(task_config.taskName[taskName]),$(".gain-exp-guazi").text("+"+data.taskResult.expGain),$(".lv-btn-confirm").on("click",function(){data.levelTypeUpdated?($(".myjimi-index-mask-lv").hide(),$(".myjimi-index-tip").hide(),exports.showTitle(data.titleItems),exports.showTask(data.taskItems),package("v.myjimi.skill").showSkill(data.skillItems)):($(".myjimi-index-mask-lv").hide(),package("v.myjimi").showIndexTip(data.level))})):($(".myjimi-index-mask-gain").show(),$(".gain-exp-guazi").text("+"+data.taskResult.expGain),"invite_friend_adopt"==taskName&&$("#gain-text-content").text("\u60a8\u7684\u597d\u53cb\u5df2\u6210\u529f\u9886\u517b~~"),$(".gain-btn-confirm").on("click",function(){$(".myjimi-index-mask-gain").hide()}))};var taskCallback={try_novice:{submitCallBack:function(data,extInfo){},processCallBack:function(data){var $body=$("body"),$maskingHtml="<div class='try-novice-masking'>                    <div class='masking-pop'>                    <div class='masking-text'>                    <p>\u6bcf\u5929\u7b2c\u4e00\u6b21\u8bd5\u73a9\u65b0\u624b\u6280\u80fd</p>                    <p>\u5c31\u53ef\u4ee5\u83b7\u5f97\u74dc\u5b50\u54e6</p>                    </div>                    <div class='masking-btn'>\u786e\u5b9a</div>                    </div>                    <div class='masking-circle'></div>                    </div>";$body.append($maskingHtml).show();var $skill_flag=$(".skill-flag");$(".try-novice-masking").css({left:$skill_flag.offset().left+50,top:$skill_flag.offset().top-110}),$("#masterDiv").css({display:"block",left:0}),package("v.myjimi.skill").try_novice_flag=!0,$(".masking-btn").on("click",function(){$(".try-novice-masking").remove(),$("#masterDiv").hide()})}},invite_friend_adopt:{submitCallBack:function(data,extInfo){},processCallBack:function(data){var question='"\u9080\u8bf7\u597d\u53cb\u9886\u517b"\u4efb\u52a1\u600e\u4e48\u505a\uff1f',answer="\u4e3b\u4eba\u5c06\u4e0b\u9762\u7684\u94fe\u63a5\u590d\u5236\u53d1\u9001\u7ed9\u670b\u53cb\uff0c\u9080\u8bf7\u670b\u53cb\u6765\u9886\u517b<br>JIMI\uff0c\u9886\u517b\u6210\u529f\u4e3b\u4eba\u5c31\u53ef\u4ee5\u83b7\u5f97100\u74dc\u5b50\u7684\u5f00\u5fc3\u503c\uff01<br>PS\uff1a\u8981\u572824\u5c0f\u65f6\u5185\u5b8c\u6210\u54e6<br>//jimi.jd.com/index.action?invitingUser="+$.cookie("pin");showMes("\u6211",question),showMes("JIMI",answer)}},sign_in:{submitCallBack:function(data,extInfo){data.taskResult.bussinessData.sign_in_flag||($(".myjimi-index-mask-sign-in").show(),$(".sign-in-btn-confirm").on("click",function(){$(".myjimi-index-mask-sign-in").hide()}))}},bussiness:{submitCallBack:function(data,extInfo){var question=data.taskResult.bussinessData;question&&(showMes("\u6211",question),sendRequest(question,0))}},try_elementary:{submitCallBack:function(data,extInfo){},processCallBack:function(data){package("v.myjimi.skill").try_elementary_flag=!0}},try_middle:{submitCallBack:function(data,extInfo){},processCallBack:function(data){package("v.myjimi.skill").try_middle_flag=!0}},try_high:{submitCallBack:function(data,extInfo){},processCallBack:function(data){package("v.myjimi.skill").try_high_flag=!0}},knowledge_qa:{submitCallBack:function(data,extInfo){},processCallBack:function(data){var $body=$("body"),$windowHtml="<div class='knowledge-window'>                <div class='qa-block'>                <p id='qa-1'>xx</p>                <input type='hidden' id='qa-1-a' value='1'>                 <input type='radio' id='qa-1-yes' name='qa-1-check' value='1' checked='checked' /><label for='qa-1-yes'>\u662f</label>                 <input type='radio' id='qa-1-no' name='qa-1-check' value='0' /><label for='qa-1-no'>\u5426</label>                 <p id='qa-2'>xxx</p>                <input type='hidden' id='qa-2-a' value='1'>                 <input type='radio' id='qa-2-yes' name='qa-2-check' value='1' checked='checked' /><label for='qa-2-yes'>\u662f</label>                 <input type='radio' id='qa-2-no' name='qa-2-check' value='0' /><label for='qa-2-no'>\u5426</label>                 <p id='qa-3'>xxx</p>                <input type='hidden' id='qa-3-a' value='1'>                 <input type='radio' id='qa-3-yes' name='qa-3-check' value='1' checked='checked' /><label for='qa-3-yes'>\u662f</label>                 <input type='radio' id='qa-3-no' name='qa-3-check' value='0' /><label for='qa-3-no'>\u5426</label>                 </div>                 <div class='btn-undo'></div>                 <div class='btn-do'></div>                 </div>";$("#masterDiv").css({display:"block",left:0}),$body.append($windowHtml).show();var qa_data=data.taskResult.bussinessData;$.each(qa_data,function(idx,item){$("#qa-"+(idx+1)).text(item.question),$("#qa-"+(idx+1)+"-a").val(item.answer)}),$(".btn-undo").on("click",function(){$(".knowledge-window").remove(),$("#masterDiv").hide()}),$(".btn-do").on("click",function(){var score=0;$("input[name='qa-1-check']:checked").val()==$("#qa-1-a").val()&&score++,$("input[name='qa-2-check']:checked").val()==$("#qa-2-a").val()&&score++,$("input[name='qa-3-check']:checked").val()==$("#qa-3-a").val()&&score++,$(".knowledge-window").remove();var $body=$("body"),$score_window="<div class='score-window'>                    <div class='score-img high-img'></div>                    <div class='score-tip'></div>                     <div class='score-text'></div>                    <div class='score-confirm'></div>                     </div>";$body.append($score_window).show();var score_config={0:0,1:33,2:66};if(3==score){$(".score-tip").text("\u606d\u559c\u4e3b\u4eba~~");var $score_text="<p>\u4e3b\u4eba\u8003\u4e86<span>100</span>\u5206\uff0c\u771f\u662f\u592a\u68d2\u4e86\uff0c\u597d\u5f00\u5fc3\u554a~~~</p>";$(".score-text").html($score_text),package("v.myjimi.service").taskSubmitService("knowledge_qa",null,taskCallback.knowledge_qa.submitCallBack)}else{$(".score-img").removeClass("high-img").addClass("low-img"),$(".score-tip").text("\u4e07\u5206\u9057\u61be~~");var $score_text="<p>\u4e3b\u4eba\u8003\u4e86<span>"+score_config[score]+"</span>\u5206\uff0c\u771f\u662f\u9057\u61be\u554a\uff0c\u518d\u63a5\u518d\u5389\u54e6~~~</p>";$(".score-text").html($score_text)}$(".score-confirm").on("click",function(){$(".score-window").remove(),$("#masterDiv").hide()})})}},talk_qa:{submitCallBack:function(data,extInfo){},processCallBack:function(data){var $body=$("body"),$windowHtml="<div class='talk-window'>                <div class='qa-block'>                <p id='qa-1'>xx</p>                <span class='key' id='qa-1-key' data-value=''></span><input class='qa-input' id='qa-1-input' maxlength='10'/>                <p class='alert' id='qa-1-alert'></p>                <p id='qa-2'>xxx</p>                <span class='key' id='qa-2-key' data-value=''></span><input class='qa-input' id='qa-2-input' maxlength='10'/>                <p class='alert' id='qa-2-alert'></p>                <p id='qa-3'>xxx</p>                <input type='hidden' id='qa-3-key' data-value=''>                 <input type='radio' id='qa-3-yes' name='qa-3-input' value='\u662f' checked='checked' /><label for='qa-3-yes'>\u662f</label>                 <input type='radio' id='qa-3-no' name='qa-3-input' value='\u5426' /><label for='qa-3-no'>\u5426</label>                 </div>                 <div class='btn-undo'></div>                 <div class='btn-do'></div>                 </div>";$("#masterDiv").css({display:"block",left:0}),$body.append($windowHtml).show();var qa_data=data.taskResult.bussinessData;$.each(qa_data,function(idx,item){$("#qa-"+(idx+1)).text(item.question),1==item.type||2==item.type?($("#qa-"+(idx+1)+"-key").text(item.key+" : "),$("#qa-"+(idx+1)+"-key").attr("data-value",item.key),$("#qa-"+(idx+1)+"-alert").text("\u4e3b\u4eba\u8bf7\u586b\u5199\u4e00\u4e0b"+item.key+"\u5427")):3==item.type&&$("#qa-3-key").attr("data-value",item.key)}),$(".qa-input").on("focus",function(){$(this).css("border","2px solid #8BC2E8"),$(".alert").hide()}).on("blur",function(){$(this).css("border","none")}),$(".btn-undo").on("click",function(){$(".talk-window").remove(),$("#masterDiv").hide()}),$(".btn-do").on("click",function(){var input1=$("#qa-1-input").val().trim();if(""==input1)return void $("#qa-1-alert").show();var input2=$("#qa-2-input").val().trim();if(""==input2)return void $("#qa-2-alert").show();var data={key_1:$("#qa-1-key").attr("data-value"),answer_1:input1,key_2:$("#qa-2-key").attr("data-value"),answer_2:input2,key_3:$("#qa-3-key").attr("data-value"),answer_3:$("input[name=qa-3-input]:checked").val()};package("v.myjimi.service").taskSubmitService("talk_qa",data,taskCallback.talk_qa.submitCallBack),$(".talk-window").remove(),$("#masterDiv").hide()})}}};return exports.taskCallback=taskCallback,exports}),package("v.myjimi.skill",[],function(require,exports,moudle){var skill_config={skill:{chat:"skill-chat",fortune:"skill-fortune",joke:"skill-joke",poem:"skill-poem",shake:"skill-shake",skin:"skill-skin",teach:"skill-teach",weather:"skill-weather",vindicate:"skill-vindicate",macross_contact:"skill-macross-contact",manual_service:"skill-manual-service"},skillDesc:{chat:"JIMI\u7684\u8eab\u5bb6\u90fd\u544a\u8bc9\u4f60\u5566",fortune:"\u67e5\u8fd0\u52bf\uff0c\u67e5\u661f\u5ea7",joke:"JIMI\u548c\u60a8\u804a\u7b11\u8bdd",poem:"\u6765\u548cJIMI\u6bd4\u8d5b\u5bf9\u8bd7",shake:"\u70b9\u51fb\u6709\u60ca\u559c",skin:"\u66f4\u6362JIMI\u76ae\u80a4\uff0c\u968f\u7b49\u7ea7\u5347\u9ad8\uff0c\u5f00\u542f\u65b0\u76ae\u80a4",teach:"\u4e13\u5c5e\u6559\u5b66\uff0c\u4f60\u6559\u6211\u5b66",weather:"\u5929\u6c14\u67e5\u8be2",vindicate:"\u5411TA\u8868\u767d",macross_contact:"\u8d85\u65f6\u7a7a\u63a5\u89e6",manual_service:"\u4eba\u5de5\u670d\u52a1"}};exports.skill_config=skill_config;var skillContainer={skillName:[],skillBg:[],skillSize:0,skillIdx:0};exports.skillContainer=skillContainer,exports.try_novice_flag=!1,exports.try_elementary_flag=!1,exports.try_middle_flag=!1,exports.try_high_flag=!1,exports.index_flag=!1,exports.move_flag=!1,exports.shake_pos="index";var skinConf={1:"blue-skin",2:"purple-skin",3:"green-skin",4:"pink-skin"},headerConf={1:"header-1",2:"header-2",3:"header-3",4:"header-4"};exports.skinConf=skinConf,exports.headerConf=headerConf,exports.handleSkillInfo=function(data){exports.showSkill(data.skillItems),exports.bindSkillEvent()},exports.showSkill=function(skillItems){skillContainer.skillName=[],skillContainer.skillBg=[],skillContainer.skillSize=0,skillContainer.skillIdx=0,$.each(skillItems,function(idx,item){skillContainer.skillName.push(item.itemName),item.mark?skillContainer.skillBg.push(skill_config.skill[item.itemName]):skillContainer.skillBg.push(skill_config.skill[item.itemName]+"-gray"),++skillContainer.skillSize}),exports.tabSkill(skillContainer.skillIdx)},exports.tabSkill=function(){var idx=skillContainer.skillIdx,$skillA=$("#skill-a"),$skillB=$("#skill-b"),$skillC=$("#skill-c");$skillA.attr("data-value",skillContainer.skillName[idx]),$skillB.attr("data-value",skillContainer.skillName[idx+1]),$skillC.attr("data-value",skillContainer.skillName[idx+2]),$skillA.attr("class","skill-icon icon "+skillContainer.skillBg[idx]),$skillB.attr("class","skill-icon icon "+skillContainer.skillBg[idx+1]),$skillC.attr("class","skill-icon icon "+skillContainer.skillBg[idx+2])},exports.bindSkillEvent=function(){$(".skill-left").on("click",function(){var idx=skillContainer.skillIdx;0!=idx&&(idx==skillContainer.skillSize-3&&$(".skill-right").removeClass("arrow-right-gray").addClass("arrow-right"),0>idx-3?(skillContainer.skillIdx=0,$(this).removeClass("arrow-left").addClass("arrow-left-gray")):skillContainer.skillIdx=idx-3,exports.tabSkill())}),$(".skill-right").on("click",function(){var idx=skillContainer.skillIdx;idx!=skillContainer.skillSize-3&&(0==idx&&$(".skill-left").removeClass("arrow-left-gray").addClass("arrow-left"),idx+6>skillContainer.skillSize-1?(skillContainer.skillIdx=skillContainer.skillSize-3,$(this).removeClass("arrow-right").addClass("arrow-right-gray")):skillContainer.skillIdx=idx+3,exports.tabSkill())}),$(".skill-flag").on("mouseover",function(){var $body=$("body"),$skillFlag=$(".skill-flag"),$skillFlagPop=$("<div></div>").attr("class","skill-flag-pop").text("\u7b49\u7ea7\u8d8a\u9ad8\uff0c\u6280\u80fd\u8d8a\u591a\uff01").css({left:$skillFlag.offset().left+45,top:$skillFlag.offset().top+10});$body.append($skillFlagPop),$skillFlagPop.fadeIn(500)}).on("mouseout",function(){$(".skill-flag-pop").remove();
}),$(".skill-icon").on("mouseover",function(){var $window=$(window),$body=$("body"),$skill=$(this),$skillPop=$("<div></div>").attr("class","skill-pop").text(skill_config.skillDesc[$skill.attr("data-value")]).css({left:$skill.offset().left-30,bottom:$window.height()-$skill.offset().top-5});$body.append($skillPop),$skillPop.fadeIn(500)}).on("mouseout",function(){$(".skill-pop").remove()}),$(".skill-icon").on("click",function(){if(-1==$(this).attr("class").indexOf("gray")){var skillName=$(this).attr("data-value");if(exports.try_novice_flag&&(exports.try_novice_flag=!1,package("v.myjimi.service").taskSubmitService("try_novice",{skillName:skillName},package("v.myjimi.task").taskCallback.try_novice.submitCallBack)),"teach"==skillName&&exports.try_elementary_flag&&(exports.try_elementary_flag=!1,package("v.myjimi.service").taskSubmitService("try_elementary",{skillName:skillName},package("v.myjimi.task").taskCallback.try_elementary.submitCallBack)),"vindicate"==skillName&&exports.try_middle_flag&&(exports.try_middle_flag=!1,package("v.myjimi.service").taskSubmitService("try_middle",{skillName:skillName},package("v.myjimi.task").taskCallback.try_middle.submitCallBack)),"macross_contact"!=skillName&&"manual_service"!=skillName||!exports.try_high_flag||(exports.try_high_flag=!1,package("v.myjimi.service").taskSubmitService("try_high",{skillName:skillName},package("v.myjimi.task").taskCallback.try_high.submitCallBack)),"skin"==skillName||"teach"==skillName||"vindicate"==skillName||"macross_contact"==skillName||"manual_service"==skillName)return void package("v.myjimi.service").skillProcessService(skillName,skillCallback[skillName].processCallBack);var extInfo={};if("shake"==skillName){if("move"==exports.shake_pos&&exports.move_flag)return;if("index"==exports.shake_pos&&exports.index_flag)return;extInfo={pos:exports.shake_pos}}package("v.myjimi.service").skillSubmitService(skillName,extInfo,skillCallback[skillName].submitCallBack)}})};var skillCallback={chat:{submitCallBack:function(data,extInfo){var question=data.skillResult.bussinessData;question&&sendRequest(question,0)}},joke:{submitCallBack:function(data,extInfo){var question="\u7b11\u8bdd";showMes("\u6211",question),sendRequest(question,0)}},poem:{submitCallBack:function(data,extInfo){var question=data.skillResult.bussinessData;question&&(showMes("\u6211",question),sendRequest(question,0))}},fortune:{submitCallBack:function(data,extInfo){var question="\u4eca\u65e5\u8fd0\u52bf";showMes("\u6211",question),sendRequest(question,0)}},weather:{submitCallBack:function(data,extInfo){var question="\u5929\u6c14";showMes("\u6211",question),sendRequest(question,0)}},skin:{submitCallBack:function(data,extInfo){package("v.myjimi.service").ajaxServices.updateUserSkinAndPic(extInfo)},processCallBack:function(data){var $body=$("body"),$skinHtml="<div class='myjimi-skin-window'>                <div class='skin-bg-block'>                <ul class='clearfix'>                <li class='fl skin-bg skin-checked'><i id='blue-skin' class='icon-skin bg-blue'></i>                <i class='icon-skin-checked'></i></li>                <li class='fl skin-bg'><i id='purple-skin' class='icon-skin bg-purple'></i>                <i class='icon-skin-checked'></i></li>                <li class='fl skin-bg'><i id='green-skin' class='icon-skin bg-green'></i>                <i class='icon-skin-checked'></i></li>                <li class='fl skin-bg'><i id='pink-skin' class='icon-skin bg-pink'></i>                <i class='icon-skin-checked'></i></li>                </ul>                </div>                <div class='skin-header-block'>                <ul class='clearfix'>                <li class='fl header-bg'><i id='header-1' class='icon-header header-self-1'></i>                <i class='icon-header-checked'></i></li>                <li class='fl header-bg'><i id='header-2' class='icon-header header-self-2'></i>                <i class='icon-header-checked'></i></li>                <li class='fl header-bg'><i id='header-3' class='icon-header header-self-3'></i>                <i class='icon-header-checked'></i></li>                <li class='fl header-bg'><i id='header-4' class='icon-header header-self-4'></i>                <i class='icon-header-checked'></i></li>                </ul>                </div>                <div class='skin-btn-confirm'></div>                <div class='skin-btn-cancle'></div>                </div>";$("#masterDiv").css({display:"block",left:0}),$body.append($skinHtml).show(),"novice"==package("v.myjimi").levelType?($("#green-skin").removeClass("bg-green").addClass("bg-green-gray"),$("#pink-skin").removeClass("bg-pink").addClass("bg-pink-gray")):"elementary"==package("v.myjimi").levelType&&$("#pink-skin").removeClass("bg-pink").addClass("bg-pink-gray"),$("#"+skinConf[package("v.myjimi").skin_type]).parent().addClass("skin-checked").siblings("li").removeClass("skin-checked"),0!=package("v.myjimi").pic_type&&$("#"+headerConf[package("v.myjimi").pic_type]).parent().addClass("header-checked").siblings("li").removeClass("header-checked"),$(".skin-bg").on("click",function(){-1==$(this).find(".icon-skin").attr("class").indexOf("gray")&&$(this).addClass("skin-checked").siblings("li").removeClass("skin-checked")}),$(".header-bg").on("click",function(){-1==$(this).find(".icon-header").attr("class").indexOf("gray")&&$(this).addClass("header-checked").siblings("li").removeClass("header-checked")}),$(".skin-btn-confirm").on("click",function(){var update_flag=!1;$.each($(".skin-bg"),function(idx,e){$(this).hasClass("skin-checked")&&package("v.myjimi").skin_type!=idx+1&&(update_flag=!0,package("v.myjimi").skin_type=idx+1,package("v.myjimi").renderSkin())}),$.each($(".header-bg"),function(idx,e){$(this).hasClass("header-checked")&&package("v.myjimi").pic_type!=idx+1&&(update_flag=!0,package("v.myjimi").pic_type=idx+1,package("v.myjimi").header_class=package("v.myjimi").config.header_img[package("v.myjimi").pic_type],package("v.myjimi").renderJimiPic(),package("v.myjimi").renderPic())}),update_flag&&package("v.myjimi.service").skillSubmitService("skin",{skinType:package("v.myjimi").skin_type,picType:package("v.myjimi").pic_type},skillCallback.skin.submitCallBack),$(".myjimi-skin-window").remove(),$("#masterDiv").hide()}),$(".skin-btn-cancle").on("click",function(){$(".myjimi-skin-window").remove(),$("#masterDiv").hide()})}},shake:{submitCallBack:function(data,extInfo){if("move"==exports.shake_pos){exports.move_flag=!0;var $move_shake=$(".myjimi-move-shake"),$move_body=$(".myjimi-move-body"),$move_icon=$(".myjimi-move-icon");$move_body.hide(),$move_icon.hide();var r_move=Math.floor(5*Math.random()+1);$move_shake.attr("class","myjimi-move-shake shake-"+r_move).show(),setTimeout(function(){$move_shake.attr("class","myjimi-move-shake").hide(),$move_body.show(),$move_icon.show(),exports.move_flag=!1},3e3)}if("index"==exports.shake_pos){exports.index_flag=!0;var $index_shake=$(".myjimi-index-shake"),$index_header=$(".myjimi-index-header-img");$index_header.attr("class","myjimi-index-header-img");var r_index=Math.floor(5*Math.random()+1);$index_shake.attr("class","myjimi-index-shake shake-"+r_index).css({top:$index_header.offset().top-82,left:$index_header.offset().left-64}).show(),setTimeout(function(){$index_shake.attr("class","myjimi-index-shake").hide(),$index_header.attr("class","myjimi-index-header-img "+package("v.myjimi").header_class),exports.index_flag=!1},3e3)}}},teach:{submitCallBack:function(data,extInfo){$("#text-head").find("h3").text("\u4e13\u5c5e\u6559\u5b66\uff0c\u4f60\u6559\u6211\u5b66\uff0c\u7a0d\u540e\u6765\u8003\u8003\u6211\u5427"),null!=extInfo?($(".suc-tip").show(),setTimeout(function(){$(".suc-tip").hide()},1e3)):($(".err-tip").show(),setTimeout(function(){$(".err-tip").hide()},1e3))},processCallBack:function(data){$("#j_teach").trigger("click"),$(".popup-teach").css("z-index",1600)}},vindicate:{submitCallBack:function(data,extInfo){},processCallBack:function(data){var $body=$("body"),$vindicateWindow="<div class='vindicate-window'>                <div class='close-btn'></div>                <div class='vindicate-intro'>                <p>Duang~~~</p>                <p><span id='vindicate-name'></span>\u4ee3\u66ff\u4e3b\u4eba\u5411TA\u8868\u767d\u5566\uff01</p>                </div>                 <div class='check-block'>                <p>\u4e3b\u4eba\u662f\u60f3\u533f\u540d\u5462\uff0c\u8fd8\u662f\u60f3\u76f4\u63a5\u4e00\u70b9\uff1f</p>                <input type='radio' name='vindicate-check' value='\u533f\u540d\u5427' id='check1' checked='checked'/><label for='check1'>\u533f\u540d\u5427</label>                <input type='radio' name='vindicate-check' value='\u8bb0\u5f97@\u6211' id='check2' /><label for='check2'>\u8bb0\u5f97@\u6211</label>                </div>                <div class='weibo-block'>                    <p>\u4e3b\u4eba\u60a8\u7684\u5fae\u535a\u8d26\u6237\u662f\u4ec0\u4e48\u5462\uff1f</p>                    <input class='weibo-input vindicate-input' maxlength='20' />                    <div class='weibo-alert vindicate-alert'>                    <i class='btn-alert'></i>                    <span>\u4e3b\u4eba\u586b\u5199\u4e00\u4e0b\u60a8\u7684\u5fae\u535a\u8d26\u6237\u5427</span>                    </div>                </div>                <div class='weibo-ta-block'>                    <p>\u4e3b\u4ebaTA\u7684\u5fae\u535a\u8d26\u6237\u662f\u4ec0\u4e48\u5462\uff1f</p>                    <input class='weibo-ta-input vindicate-input' maxlength='20' />                    <div class='weibo-ta-alert vindicate-alert'>                    <i class='btn-alert'></i>                    <span>\u4e3b\u4eba\u586b\u5199\u4e00\u4e0bTA\u7684\u5fae\u535a\u8d26\u6237\u5427</span>                    </div>                </div>                <div class='word-block'>                    <p>\u4e3b\u4eba\u60a8\u60f3\u5bf9TA\u8bf4\u70b9\u4ec0\u4e48\u5462\uff1f</p>                    <textarea class='word-input vindicate-input' maxlength='30' rows='2' cols='30' placeholder='\u6700\u591a\u8f93\u516530\u4e2a\u5b57\u54e6' />                    <div class='word-alert vindicate-alert'>                    <i class='btn-alert'></i>                    <span>\u4e3b\u4eba\u60a8\u8fd8\u6ca1\u7559\u8a00\u5462</span>                    </div>                </div>                <div class='vindicate-confirm'></div>                </div>";$("#masterDiv").css({display:"block",left:0}),$body.append($vindicateWindow).show(),$("#vindicate-name").text(package("v.myjimi").nickName),$(".vindicate-input").on("focus",function(){$(this).css("border","2px solid #8BC2E8"),$(".vindicate-alert").hide()}).on("blur",function(){$(this).css("border","none")}),$(".close-btn").on("click",function(){$(".vindicate-window").remove(),$("#masterDiv").hide()}),$(".vindicate-confirm").on("click",function(){var weibo=$(".weibo-input").val().trim();if(""==weibo)return void $(".weibo-alert").show();var weibo_ta=$(".weibo-ta-input").val().trim();if(""==weibo_ta)return void $(".weibo-ta-alert").show();var word=$(".word-input").val().trim();if(""==word)return void $(".word-alert").show();var data={check_item:$("input[name='vindicate-check']:checked").val(),weibo:weibo,weibo_ta:weibo_ta,word:word};package("v.myjimi.service").skillSubmitService("vindicate",data,skillCallback.vindicate.submitCallBack),$(".vindicate-window").remove(),$("#masterDiv").hide()})}},macross_contact:{submitCallBack:function(data,extInfo){},processCallBack:function(data){var $body=$("body"),$macrossWindow="<div class='macross-window'>                <div class='close-btn'></div>                <div class='macross-intro'>                <p>\u5c06\u6b64\u65f6\u6b64\u523b\u7684\u5fc3\u60c5\u4fdd\u9c9c</p>                <p>\u5bc4\u7ed9\u672a\u6765\u7684\u81ea\u5df1~~~</p>                </div>                 <div class='check-block'>                <p>\u8bf7\u4e3b\u4eba\u9009\u62e9\u4e00\u4e0b\u5bc4\u4fe1\u65b9\u5f0f\u5462\uff1f</p>                <input type='radio' name='macross-check' value='\u5fae\u535a\u79c1\u4fe1' id='check1' checked='checked'/><label for='check1'>\u5fae\u535a\u79c1\u4fe1</label>                <input type='radio' name='macross-check' value='\u7535\u5b50\u90ae\u4ef6' id='check2' /><label for='check2'>\u7535\u5b50\u90ae\u4ef6</label>                <input type='radio' name='macross-check' value='\u5fae\u4fe1\u8ba2\u9605\u53f7' id='check3' /><label for='check3'>\u5fae\u4fe1\u8ba2\u9605\u53f7</label>                </div>                <div class='account-block'>                    <p>\u4e3b\u4eba\u7684\u5fae\u535a/\u5fae\u4fe1/Email\u8d26\u6237\u662f\u5565\u5462\uff1f</p>                    <input class='account-input macross-input' maxlength='20' />                    <div class='account-alert macross-alert'>                    <i class='btn-alert'></i>                    <span>\u4e3b\u4eba\u586b\u5199\u4e00\u4e0b\u60a8\u7684\u8d26\u6237\u5427</span>                    </div>                </div>                <div class='expect-block'>                    <span class='desc'>\u4e3b\u4eba\u60f3\u591a\u4e45\u540e\u6536\u5230\u5462\uff1f</span>                    <input class='expect-input macross-input' maxlength='3' />                    <span class='desc'>\u5929</span>                    <div class='expect-alert macross-alert'>                    <i class='btn-alert'></i>                    <span class='alert'>\u8bf7\u586b\u5199\u6574\u6570</span>                    </div>                </div>                <div class='msg-block'>                    <p>\u7559\u4e0b\u4e3b\u4eba\u60f3\u8bf4\u7684\u8bdd\u5462\uff1f</p>                    <textarea class='msg-input macross-input' maxlength='30' rows='2' cols='30' placeholder='\u6700\u591a\u8f93\u516530\u4e2a\u5b57\u54e6' />                    <div class='msg-alert macross-alert'>                    <i class='btn-alert'></i>                    <span>\u4e3b\u4eba\u60a8\u8fd8\u6ca1\u7559\u8a00\u5462</span>                    </div>                </div>                <div class='macross-confirm'></div>                </div>";$("#masterDiv").css({display:"block",left:0}),$body.append($macrossWindow).show(),$(".expect-alert").hide(),$(".macross-input").on("focus",function(){$(this).css("border","2px solid #8BC2E8"),$(".macross-alert").hide()}).on("blur",function(){$(this).css("border","none")}),$(".close-btn").on("click",function(){$(".macross-window").remove(),$("#masterDiv").hide()}),$(".macross-confirm").on("click",function(){var account=$(".account-input").val().trim();if(""==account)return void $(".account-alert").show();var expect=$(".expect-input").val().trim(),reg=/^[0-9]*[1-9][0-9]*$/;if(""==expect||!reg.test(expect))return void $(".expect-alert").show();var msg=$(".msg-input").val().trim();if(""==msg)return void $(".msg-alert").show();var data={check_item:$("input[name='macross-check']:checked").val(),account:account,expect:parseInt(expect),msg:msg};package("v.myjimi.service").skillSubmitService("macross_contact",data,skillCallback.macross_contact.submitCallBack),$(".macross-window").remove(),$("#masterDiv").hide()})}},manual_service:{submitCallBack:function(data,extInfo){},processCallBack:function(data){var $body=$("body"),$manualWindow="<div class='manual-window'>                <div class='close-btn'></div>                <div class='manual-intro'>                <p>Duang~~~</p>                <p><span id='manual-name'>XXX</span>\u5df2\u7ecf\u81ea\u5b66\u4e86\u201c\u4eba\u5de5VIP\u670d\u52a1\u201d\u5566\uff01</p>                </div>                 <div class='contact-block'>                <p>\u4e3b\u4eba\u7559\u4e0b\u65b9\u4fbf\u7684\u8054\u7cfb\u65b9\u5f0f\u5462</p>                <input class='contact-input manual-input' maxlength='20' />                <div class='contact-alert manual-alert'>                <i class='btn-alert'></i>                <span>\u4e3b\u4eba\u7559\u4e2a\u8054\u7cfb\u65b9\u5f0f\u5427</span>                </div>                </div>                <div class='question-block'>                <p>\u4e3b\u4eba\u7684\u8d2d\u7269\u7591\u95ee\u5199\u4e00\u4e0b\u5462</p>                <textarea class='question-input manual-input' maxlength='30' rows='3' cols='30' placeholder='\u6700\u591a\u8f93\u516530\u4e2a\u5b57\u54e6' />                <div class='question-alert manual-alert'>                <i class='btn-alert'></i>                <span>\u4e3b\u4eba\u60a8\u6709\u4ec0\u4e48\u7591\u95ee\u5462</span>                </div>                </div>                <div class='manual-confirm'></div>                </div>";$("#masterDiv").css({display:"block",left:0}),$body.append($manualWindow).show(),$("#manual-name").text(package("v.myjimi").nickName),$(".manual-input").on("focus",function(){$(this).css("border","2px solid #8BC2E8"),$(".manual-alert").hide()}).on("blur",function(){$(this).css("border","none")}),$(".close-btn").on("click",function(){$(".manual-window").remove(),$("#masterDiv").hide()}),$(".manual-confirm").on("click",function(){var contact=$(".contact-input").val().trim();if(""==contact)return void $(".contact-alert").show();var question=$(".question-input").val().trim();if(""==question)return void $(".question-alert").show();var data={contact:contact,question:question};package("v.myjimi.service").skillSubmitService("manual_service",data,skillCallback.manual_service.submitCallBack),$(".manual-window").remove(),$("#masterDiv").hide()})}}};return exports.skillCallback=skillCallback,exports}),package("v.animate",[],function(require,exports,moudle){return function($,window){function showPageGuide(){setTimeout(function(){var param=window.location.search;param&&-1!=param.indexOf("source=onlineOrder")||$.ajax({type:"get",url:"/welcomeMask/index.action",dataType:"json",success:function(data){if(data.welcomeMask){var $mask=$("#masterDiv");$mask.hide();$(window).height(),$(window).width();$mask.show().css({left:0});var satisfyButton=$("#j_satisfy"),offset=satisfyButton.offset(),top=offset.top,left=offset.left;$("#satisfyEvalue").show().css({position:"absolute",top:top-215,left:left-5,zIndex:200})}}})},500),$("#satisfyEvalue").bind("click",function(){$(this).hide(),$("#masterDiv").hide()})}exports.showPageGuide=showPageGuide}(jQuery,window),exports}),package("v.manual",[],function(require,exports,moudle){return Date.prototype.format=function(format){var o={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(format)&&(format=format.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var k in o)new RegExp("("+k+")").test(format)&&(format=format.replace(RegExp.$1,1==RegExp.$1.length?o[k]:("00"+o[k]).substr((""+o[k]).length)));return format},function($,window){function changeToManual(changeType,changeSource){$.ajax({type:"post",url:"/feedback/chageToManual.action",data:{changeType:changeType||1,changeSource:changeSource||3,entrance_source:window.jimiSource}})}exports.showGuide=function(showanswer){""!=showanswer&&($("#chatcontent").append('<div class="chat-tips"><div class="chat-msg"><p class="cont">'+showanswer+'</p><div class="mask"> <span class="tl"></span> <span class="tr"></span><span class="bl"></span><span class="br"></span> </div> </div></div>'),setScroll()),$(".kefu").on("click",function(){changeToManual(1,2)}),statisticAjaxReq("/userguidefeedback/updataRedis.action?value=1")},exports.bindGuideLog=function($ele){var $links=$ele.find("a");$links.each(function(){var $this=$(this);!$this.hasClass("js-msg-to-manual")&&/^\/\/chat.*\.jd\.com.*$/.test($this.attr("href"))&&($this.removeAttr("target"),$this.on("click",function(){changeToManual(1,1)}))})},$(".service-online").live("click",function(){changeToManual(1,3)}),$(document).on("click",".imJumpFlag",function(){window.open(window.manualUrl,"_blank")}),$(function(){var initURL,flag=!1,fromIM=window.location.toString().indexOf("from=im")>0,transformUrl="//chat.jd.com/jdchat/custom.action";$.ajax({type:"get",url:"/index/jimiToManualUrl.action",dataType:"json",data:{source:window.jimiSource||"",productId:window.productId||""},success:function(data){transformUrl=data.URL,flag=!0,initURL=void 0!=window.entry&&void 0!=window.chatId?transformUrl.indexOf("?")>-1?transformUrl.replace(/(\?entry=[^\"]*)/,"?entry="+window.entry+"&chatId="+window.chatId):transformUrl+"?entry="+window.entry+"&chatId="+window.chatId:transformUrl.indexOf("?")>-1?transformUrl:transformUrl+(fromIM?"?from=jimi":"?from=first"),$(".service-online").find("a").attr("href",initURL),$("#skipToOnlineService").removeAttr("target"),window.manualUrl=initURL||"//chat.jd.com/jdchat/index.action?from=first"}}),flag||(initURL=void 0!=window.entry&&void 0!=window.chatId?transformUrl+"?entry="+window.entry+"&chatId="+window.chatId:transformUrl+(fromIM?"?from=jimi":"?from=first"),$(".service-online").find("a").attr("href",initURL),$("#skipToOnlineService").removeAttr("target"))}),$(document).on("click","a.js-msg-to-manual",function(){changeToManual(1,1);var url=$("#skipToOnlineService").attr("href");try{window.open(url,"_self")}catch(e){alert("\u8f6c\u4eba\u5de5\u8df3\u8f6c\u51fa\u95ee\u9898\u4e86\uff0c\u8bf7\u70b9\u51fb\u53f3\u4e0a\u89d2\u201c\u5728\u7ebf\u5ba2\u670d\u201d\u8df3\u8f6c")}})}(jQuery,window),exports}),package("v.teach",[],function(require,exports,moudle){return function($,window){function showMask(){var $mask=$("#masterDiv");$(window).height(),$(window).width();$mask.show().css({left:0})}function initPopup(){$("#text-que-restrict").text("\u60a8\u8fd8\u53ef\u4ee5\u8f93\u516550\u5b57"),$("#text-que-restrict").css("color","#b8b8b8"),$("#text-ans-restrict").text("\u60a8\u8fd8\u53ef\u4ee5\u8f93\u5165200\u5b57"),$("#text-ans-restrict").css("color","#b8b8b8"),$("#text-que").val("\u95ee\u9898: \u73b0\u5728\u7684\u5973\u751f\u4e3a\u4ec0\u4e48\u90fd\u4e0d\u4f1a\u505a\u996d\uff1f"),$("#text-que").css("color","#b8b8b8"),$("#text-ans").val("\u7b54\u6848: \u56e0\u4e3a\u8981\u7ed9\u7537\u4eba\u7559\u4e00\u4e2a\u8868\u73b0\u7684\u673a\u4f1a\u3002"),$("#text-ans").css("color","#b8b8b8")}function closeMask(){var $mask=$("#masterDiv");$mask.hide()}function questionInput(){var text=$("#text-que").val(),textLen=text.length;"\u95ee\u9898: \u73b0\u5728\u7684\u5973\u751f\u4e3a\u4ec0\u4e48\u90fd\u4e0d\u4f1a\u505a\u996d\uff1f"!=text&&(50>=textLen&&textLen>0?(canComment1=!0,$("#text-que-restrict").text("\u60a8\u8fd8\u53ef\u4ee5\u8f93\u5165"+(50-textLen)+"\u5b57"),$("#text-que-restrict").css("color","#b8b8b8")):0==textLen?(canComment1=!1,$("#text-que-restrict").text("\u60a8\u8fd8\u53ef\u4ee5\u8f93\u516550\u5b57"),$("#text-que-restrict").css("color","#b8b8b8")):(canComment1=!1,$("#text-que-restrict").text("\u60a8\u5df2\u8d85\u51fa"+(textLen-50)+"\u5b57"),$("#text-que-restrict").css("color","#ef0a2b")))}function answerInput(){var text=$("#text-ans").val(),textLen=text.length;"\u7b54\u6848: \u56e0\u4e3a\u8981\u7ed9\u7537\u4eba\u7559\u4e00\u4e2a\u8868\u73b0\u7684\u673a\u4f1a\u3002"!=text&&(200>=textLen&&textLen>0?(canComment2=!0,$("#text-ans-restrict").text("\u60a8\u8fd8\u53ef\u4ee5\u8f93\u5165"+(200-textLen)+"\u5b57"),$("#text-ans-restrict").css("color","#b8b8b8")):0==textLen?(canComment2=!1,$("#text-ans-restrict").text("\u60a8\u8fd8\u53ef\u4ee5\u8f93\u5165200\u5b57"),$("#text-ans-restrict").css("color","#b8b8b8")):(canComment2=!1,$("#text-ans-restrict").text("\u60a8\u5df2\u8d85\u51fa"+(textLen-200)+"\u5b57"),$("#text-ans-restrict").css("color","#ef0a2b")))}function teachSubmitSuccessCallback(){$(".suc-tip").show(),setTimeout(function(){$(".suc-tip").hide()},1e3)}function teachSubmitFailCallback(){$(".err-tip").show(),setTimeout(function(){$(".err-tip").hide()},1e3)}function teachClickAndShareCount(dimension){$.ajax({type:"get",url:"/teachfeedback/teachFeedbackCount.action?dimension="+dimension})}function init(){$("#j_teach").live("click",function(){$(".popup-teach .jimi-header-img").addClass(window.jimiHeader),$(".popup-teach").is(":visible")?$(".popup-teach").hide():($("#text-head").children("h3").text("\u54c7\uff0c\u8fd9\u4e48\u597d\u73a9\uff0c\u6211\u4e5f\u53ef\u4ee5\u6559JIMI\u8bf4\u8bdd\u4e86"),showMask(),$(".popup-teach").show().css({zIndex:122}),teachClickAndShareCount(1),teachClickAndShareCount(2))}),$("#teach-cacel").live("click",function(){closeMask(),$(".popup-teach").hide(),initPopup()}),$("#teach-close").live("click",function(){closeMask(),$(".popup-teach").hide(),initPopup()}),$("#text-que").live("cut paste keyup blur focus",function(e){"cut"==e.type||"paste"==e.type?setTimeout(questionInput,400):questionInput()}),$("#text-que").live("focus",function(){var text=$("#text-que").val();"\u95ee\u9898: \u73b0\u5728\u7684\u5973\u751f\u4e3a\u4ec0\u4e48\u90fd\u4e0d\u4f1a\u505a\u996d\uff1f"==text&&($("#text-que").val(""),$("#text-que").css("color","#000")),$("#text-head").children("h3").text("\u54c7\uff0c\u8fd9\u4e48\u597d\u73a9\uff0c\u6211\u4e5f\u53ef\u4ee5\u6559JIMI\u8bf4\u8bdd\u4e86")}),$("#text-que").live("blur",function(){var text=$("#text-que").val();""==text&&($("#text-que").val("\u95ee\u9898: \u73b0\u5728\u7684\u5973\u751f\u4e3a\u4ec0\u4e48\u90fd\u4e0d\u4f1a\u505a\u996d\uff1f"),$("#text-que").css("color",""))}),$("#text-que-restrict").css("color","#b8b8b8"),$("#text-ans").live("cut paste keyup blur focus",function(e){"cut"==e.type||"paste"==e.type?setTimeout(answerInput,400):answerInput()}),$("#text-ans").live("focus",function(){var text=$("#text-ans").val();"\u7b54\u6848: \u56e0\u4e3a\u8981\u7ed9\u7537\u4eba\u7559\u4e00\u4e2a\u8868\u73b0\u7684\u673a\u4f1a\u3002"==text&&($("#text-ans").val(""),$("#text-ans").css("color","#000")),$("#text-head").children("h3").text("\u54c7\uff0c\u8fd9\u4e48\u597d\u73a9\uff0c\u6211\u4e5f\u53ef\u4ee5\u6559JIMI\u8bf4\u8bdd\u4e86")}),$("#text-ans").live("blur",function(){var text=$("#text-ans").val();""==text&&($("#text-ans").val("\u7b54\u6848: \u56e0\u4e3a\u8981\u7ed9\u7537\u4eba\u7559\u4e00\u4e2a\u8868\u73b0\u7684\u673a\u4f1a\u3002"),$("#text-ans").css("color",""))}),$("#text-ans-restrict").css("color","#b8b8b8");var $teachok=$("#teach-ok");$teachok.live("click",function(){if(!canComment1){var text=$("#text-que").val(),text1=text.replace("\u95ee\u9898: \u73b0\u5728\u7684\u5973\u751f\u4e3a\u4ec0\u4e48\u90fd\u4e0d\u4f1a\u505a\u996d\uff1f",""),textLen=text1.length;return void(0==textLen?($("#text-que-restrict").text("\u60a8\u8fd8\u6ca1\u6709\u8f93\u5165\u95ee\u9898"),$("#text-que-restrict").css("color","#ef0a2b")):($("#text-que-restrict").text("\u60a8\u7684\u95ee\u9898\u8d85\u8fc750\u5b57"),$("#text-que-restrict").css("color","#ef0a2b")))}if(!canComment2){var text=$("#text-ans").val(),text1=text.replace("\u7b54\u6848: \u56e0\u4e3a\u8981\u7ed9\u7537\u4eba\u7559\u4e00\u4e2a\u8868\u73b0\u7684\u673a\u4f1a\u3002",""),textLen=text1.length;return void(0==textLen?($("#text-ans-restrict").text("\u60a8\u8fd8\u6ca1\u6709\u8f93\u5165\u7b54\u6848"),$("#text-ans-restrict").css("color","#ef0a2b")):($("#text-ans-restrict").text("\u60a8\u7684\u7b54\u6848\u8d85\u8fc7200\u5b57"),$("#text-ans-restrict").css("color","#ef0a2b")))}canComment1=!1,canComment2=!1;var teachQuestion=$("#text-que").val(),teachAnswer=$("#text-ans").val(),data={teachQuestion:teachQuestion,teachAnswer:teachAnswer};if(isMyJimi){var teachData={question:teachQuestion,answer:teachAnswer};package("v.myjimi.service").skillSubmitService("teach",teachData,package("v.myjimi.skill").skillCallback.teach.submitCallBack)}else $.ajax({type:"post",url:"/teachfeedback/TeachFeedbackToRedis.action",data:data,success:teachSubmitSuccessCallback,error:teachSubmitFailCallback});$("#text-que").val("\u95ee\u9898: \u73b0\u5728\u7684\u5973\u751f\u4e3a\u4ec0\u4e48\u90fd\u4e0d\u4f1a\u505a\u996d\uff1f"),$("#text-que").css("color",""),$("#text-ans").val("\u7b54\u6848: \u56e0\u4e3a\u8981\u7ed9\u7537\u4eba\u7559\u4e00\u4e2a\u8868\u73b0\u7684\u673a\u4f1a\u3002"),$("#text-ans").css("color",""),$("#text-que-restrict").text("\u60a8\u8fd8\u53ef\u4ee5\u8f93\u516550\u5b57"),$("#text-que").css("color",""),$("#text-ans-restrict").text("\u60a8\u8fd8\u53ef\u4ee5\u8f93\u5165200\u5b57"),$("#text-que").css("color",""),$("#text-head").children("h3").text("\u63d0\u4ea4\u6210\u529f\uff0c\u8c22\u8c22\u53c2\u4e0e\uff0c\u8fc7\u4e24\u5929\u6765\u8003\u6211\u5427~")}),$(".bds_qzone").live("click",function(){teachClickAndShareCount(4)}),$(".bds_tsina").live("click",function(){teachClickAndShareCount(3)}),$(".bds_tqq").live("click",function(){teachClickAndShareCount(7)}),$(".bds_renren").live("click",function(){teachClickAndShareCount(5)}),$(".bds_weixin").live("click",function(){teachClickAndShareCount(6)});var sina_url="http://v.t.sina.com.cn/share/share.php?appkey=2445336821&title=";$(".icon-sina-blog").live("click",function(){window.open(sina_url+"\u6211\u8981\u53d1\u5fae\u535a","_blank")});var yixin_url="http://open.yixin.im/share?type=webpage&text=";$(".icon-tencent-weibo").live("click",function(){window.open(yixin_url+"\u6211\u8981\u53d1yixin","_blank")})}var canComment1=!1,canComment2=!1;exports.init=init}(jQuery,window),exports}),package("v.statistic",[],function(require,exports,moudle){return function($,window,document){function init(){function getBasePara(){return{robot_id:"",source:jimiSource||"",session_id:"",event_type:1,version:"jimi-web"}}var basePara=null;triggerLandfill=function(para){var statisticUrl="http://chat-dc.jd.com/sendMsg/send.html",content=$.extend(para.content,basePara||getBasePara());content.user_pin=$.cookie("pin");var img=new Image,src=statisticUrl+"?typeCode="+para.typeCode+"&content="+JSON.stringify(content);img.src=src,img.style.display="none",document.body.appendChild(img)},$("#buyConsultDiv .intro-bar").live("click",function(){var question=$(this).text(),data={description:question};statisticAjaxReq("/newData/dataAction.action",$.extend(data,{type:8})),sendSpReq({data:"9|"+question})}),$(document).on("mouseover","#sidenav .side-nav-item",function(){var type=$(this).data("type")||0;statisticAjaxReq("/newData/dataAction.action",{type:type});var spTypeMap={46:"1",47:"2|"+(window.isCustomerEntrance()?"\u552e\u540e":"\u552e\u524d"),48:"3",45:"4"};type&&sendSpReq({data:spTypeMap[type]})}),$(document).on("click",".space-btn-group li",function(){var spTypeMap={"space-btn-tx":"8|\u8c03\u620f","space-btn-xh":"8|\u8bb2\u7b11\u8bdd","space-btn-ds":"8|\u5bf9\u8bd7"},$this=$(this);$.each(spTypeMap,function(i){$this.hasClass(i)&&sendSpReq({data:this})})}),$(document).on("click","#sugguestions .js-send-question a",function(){var question=$(this).html();sendSpReq({data:"11|"+question})}),$(document).on("click",".chat-helper-guess-list a",function(){var question=$(this).html();sendSpReq({data:"10|"+question})}),$(document).on("click",".jimi-goods-list .change-btn",function(){var msgid=$(this).prev().find(".views").data("msgid");triggerLandfill({typeCode:"search_scene_log",content:{component_type:2,message_id:msgid}})}),$(document).on("click",".jimi-goods-list .goods-detail img",function(){var pid=$(this).parent().data("pid"),msgid=$(this).parent().parent().parent().data("msgid");triggerLandfill({typeCode:"search_scene_log",content:{component_type:3,component_content:pid,message_id:msgid}})}),$(document).on("click",".jimi-goods-list .goods-title a",function(){var pid=$(this).parent().parent().prev().data("pid"),msgid=$(this).parent().parent().parent().parent().data("msgid");triggerLandfill({typeCode:"search_scene_log",content:{component_type:3,component_content:pid,message_id:msgid}})}),$(document).on("click",".jimi-goods-list .btn-wrap a",function(){var $this=$(this);if($this.is(".append-btn")){var pid=$(this).parent().parent().prev().data("pid"),msgid=$(this).parent().parent().parent().parent().data("msgid");triggerLandfill({typeCode:"search_scene_log",content:{component_type:1,component_content:pid,message_id:msgid}})}if($this.is(".note-btn")&&statisticAjaxReq("/collectdot/dot.action",{type:"recommend_addattention"}),$this.is(".ask-btn")){var pid=$(this).parent().parent().prev().data("pid"),msgid=$(this).parent().parent().parent().parent().data("msgid");triggerLandfill({typeCode:"search_scene_log",content:{component_type:0,
component_content:pid,message_id:msgid}})}}),$(document).on("click",".f-card .c-link",function(){var $q=$(this),parLst=$q.closest(".f-card"),param={},c_content="";param.event_time=(new Date).getTime(),param.component_type=$q.attr("data-type"),param.component_id=$q.attr("data-id"),param.component_location=$q.attr("data-position"),param.card_id=parLst.attr("data-id"),c_content=0==param.component_type?$q.find("img").attr("src"):$q.text(),param.component_content=c_content,param.card_type=parLst.attr("data-type")||1,param.uuid=parLst.attr("data-uuid"),param.cid=$q.attr("data-sid")||parLst.attr("data-sid"),triggerLandfill({typeCode:"jimi_dc_wrkf_2_log_question_cards",content:param})}),$(document).on("click",".fast-entry .f-link-a",function(){var $q=$(this),param={};param.event_time=(new Date).getTime(),param.entry_id=$q.attr("data-id"),param.entry_type=$q.attr("data-type"),param.entry_content=$q.text(),param.location=$q.attr("data-position"),param.cid=$q.closest(".fast-entry").data("sid"),triggerLandfill({typeCode:"jimi_dc_wrkf_2_log_quick_entry",content:param})}),function(){var parser=new UAParser,browser=parser.getBrowser(),os=parser.getOS(),device=parser.getDevice(),terminal="Unknown";device.type&&(terminal=device.type+(device.vendor?"|"+device.vendor:"")+(device.model?"|"+device.model:""));var param={terminal:terminal,browser:browser.name+"|"+browser.version,os:os.name+"|"+os.version};statisticAjaxReq("/newData/terminalDataAction.action",param);var getClsQuery=function(clsType){return'[clstag="JIMI|keycount|home2014|'+clsType+'"]'},dataActionMap=[{cls:"c4",type:21},{cls:"c5",type:22},{cls:"c2",type:19},{cls:"c1",type:18},{cls:"sp1",type:14},{cls:"sp3",type:15},{cls:"sp2",type:16},{cls:"sp4",type:17},{cls:"gh1",type:13},{cls:"dd1",type:9},{cls:"dd2",type:10},{cls:"dd3",type:11},{cls:"dd4",type:12},{cls:"sp5",type:34},{cls:"dl1",type:35},{cls:"dl2",type:36},{cls:"dl3",type:37},{cls:"dd5",type:3},{cls:"kj1",type:1},{cls:"kj2",type:2}];$(dataActionMap).each(function(){var query=getClsQuery(this.cls),type=this.type;$(document).on("click",query,function(){statisticAjaxReq("/newData/dataAction.action",{type:type})})}),function(){var prefix="JIMI|keycount|home2014|",addList=[{query:"#district-consult-select",cls:"kj1"},{query:"#product-service-search .search-button",cls:"kj2"},{query:"#orderListDiv .intro-bar",cls:"dd5"}],tryTime=5e3,interval=null;interval=setInterval(function(){var addDone=!0;$.each(addList,function(){var $dom=$(this.query);$dom.length?$dom.attr("clstag",prefix+this.cls):addDone=!1}),addDone||0>=tryTime?clearInterval(interval):tryTime-=200},200)}()}()}exports.init=init}(jQuery,window,document),exports}),function($,window,document){function unsatisfiedLog(data){$.ajax({type:"post",url:"/teachfeedback/unsatisfiedLog.action",data:data,dataType:"JSON"})}function unsatisityAnswerInput(ele){var answer=$(ele).val();if(answer.length>200){var newAnswer=answer.substr(0,200);$(ele).val(newAnswer)}}$(".anwserSatisify").live("click",function(){var resultType=$(this).attr("resulttype"),answer=$(this).attr("answer"),question=$(this).attr("requesttext"),html="",teachObj=new Object;teachObj.teachQuestion=question,teachObj.teachAnswer=answer,teachObj.resultType=resultType,teachObj.SaOrUnsaType="Satisfied",unsatisfiedLog(teachObj);var td=$(this).parents("td");if($(this).parent(".btn-area").remove(),$(td).attr("class","mm"),html='<p align="right"><br/><span>\u611f\u8c22\u60a8\u7684\u53cd\u9988\uff01</span></p>',$(td).append(html),"baiduAnswer"==resultType){var data={teachQuestion:question,teachAnswer:answer,teachType:"5"};$.ajax({type:"post",url:"/teachfeedback/TeachFeedbackToRedis.action",data:data})}}),$(".anwserSatisify").live("click",function(){$.ajax({type:"get",url:"/ask/checkSimpleSatisfy.action",dataType:"json",success:function(data){data.satisfyFlag&&(isShowSatisfyModal=!0)}})}),$(".anwserUnsatisify").live("click",function(){var resultType=$(this).attr("resulttype"),answer=$(this).attr("answer"),question=$(this).attr("requestText"),td=$(this).parents("td");$(td).attr("class","mm");var html="",teachObj=new Object;teachObj.teachQuestion=question,teachObj.teachAnswer=answer,teachObj.resultType=resultType,teachObj.SaOrUnsaType="UnSatisfied",unsatisfiedLog(teachObj);var chatCategory=["chatAccurate","chatSensitive","chatNormal","chatTeach"];if(-1==$.inArray(resultType,chatCategory)&&"chatNoAnswer"!=resultType&&"baiduAnswer"!=resultType)$(this).parent(".btn-area").remove(),html='<p align="right"><span>\u611f\u8c22\u60a8\u7684\u53cd\u9988\uff01\u6211\u4eec\u4f1a\u5c3d\u5feb\u4fee\u6b63\u7b54\u6848\uff01</span></p>',$(td).append(html);else{var temp=$(this).parents(".jimi_lists"),o=new Object;o.title="\u8fd9\u4e2a\u95ee\u9898JIMI\u56de\u7b54\u7684\u4e0d\u597d\uff0c\u6559\u6211\u56de\u7b54\u5427\u3002O(\u2229_\u2229)O",o.question=question,"chatAccurate"==resultType?o.trainType=6:"chatSensitive"==resultType?o.trainType=7:"chatNormal"==resultType?o.trainType=8:"chatTeach"==resultType?o.trainType=9:"baiduAnswer"==resultType&&(o.trainType=10),temp.after($("#unsatisifyAndUnknown").tmpl(o)),temp.remove()}}),$(".answerInputButton").live("click",function(){var question=$(this).attr("question"),answer=$(this).siblings("input").val(),trainType=$(this).attr("trainType"),talk=$(this).parents(".jimi_lists"),data={teachQuestion:question,teachAnswer:answer,teachType:trainType};""!=answer&&$.ajax({type:"post",url:"/teachfeedback/TeachFeedbackToRedis.action",data:data,dataType:"JSON",success:function(){var html='<div class="jimi_lists clearfix"><div class="header_img '+window.jimiHeader+' fl"></div><table cellspacing="0" cellpadding="0" class="msg"><tbody><tr><td class="lt"></td><td class="tt"></td><td class="rt"></td></tr><tr><td class="lm"><span></span></td><td class="mm"><div class="msg-teach-ok"><p class="msg-teach-title">\u6536\u5230\uff01\u8fc7\u51e0\u5929\u518d\u6765\u8003\u8003\u6211\u5427\u3002O(\u2229_\u2229)O</p></div></td><td class="rm"></td></tr><tr><td class="lb"></td><td class="bm"></td><td class="rb"></td></tr></tbody></table></div>';talk.after(html),talk.remove()}})}),$(".unsatisityAnswerInput").live("cut paste keyup blur focus",function(e){unsatisityAnswerInput(this)}),$(".unsatisityAnswerInput").live("focus",function(){$(this).attr("placeholder","")}),$(".unsatisityAnswerInput").live("blur",function(){var text=$(this).val();""==text&&($(this).attr("placeholder","\u8fd9\u91cc\u53ef\u4ee5\u8f93\u5165\u7b54\u6848\uff0c\u70b9\u51fb\u201c\u786e\u5b9a\u201d\u3002"),$("#text-ans").css("color",""))}),$(document).on("keydown",".unsatisityAnswerInput",function(e){var keycode=e?e.which:window.event.keyCode;13==keycode&&$(this).siblings(".answerInputButton").trigger("click")}),window.onbeforeunload=function(event){var allNum=$("#chatcontent").find(".customer_lists").length;$.ajax({type:"post",url:"/sessionChatNumRecord.action",data:{chatNum:allNum}})}}(jQuery,window,document),function(Class,$,window,document){function searchCounting(){setTimeout(function(){var item=searchResult.shift();$("#chatcontent .d-searching").replaceWith(item),setScroll()},2600)}function getImgHeight(src,callback){var image=new Image;image.src=src,image.onload=function(){callback&&callback(this.height)},image.onError=function(){this.src="//img11.360buyimg.com/cms/jfs/t3211/282/7459002355/6243/da613c39/58b63e4eN6a288a5c.png"}}function setJimiImgShow(item){function imgAdjust(num){$.each(imgArr,function(i,n){getImgHeight($(n).attr("src"),function(h){imgListMaxH=Math.max(h,imgListMaxH),li.css("max-height",imgListMaxH),lists.css("height",li.height())})})}var lists=item.find(".J_TextImageList"),dialog=item.find(".p_img_show"),p_width=parseInt(dialog.width()),li=lists.find("li"),len=li.length,overMax=3,width="",imgArr=li.find("img"),imgListMaxH=0;lists.css("width",p_width),len>overMax?(width=parseInt(p_width/overMax)-3,li.css("width",width),lists.find(".sub-lst-03").addClass("sub-lst-num")):(lists.find(".sub-lst-03").removeClass("sub-lst-num").addClass("sub-lst-auto"),len>=2&&(width=parseInt(p_width/len)-3,li.css("width",width))),imgAdjust()}function createSearching(){return'<div class="d-searching"><img src="//img12.360buyimg.com/cms/jfs/t4885/63/1335810260/72106/cb011ebf/58ef760dN911d2bc8.gif" /></div>'}if(!Class)throw new Error("Class is necessary");window.getJimiHeader=function(){return window.jimiHeader=window.jimiHeader||"jimi"+(Math.round(10*Math.random())%4+1),window.jimiHeader};var jimiHeader=getJimiHeader(),package=window["package"]||function(){},Question=Class.extend({shellPre:'<div class="customer_lists clearfix"><div class="header_img '+jimiHeader+'"  style="background: url(//static.360buyimg.com/jimi/dist/v20140121/i/img1.png) no-repeat center;"><div class="header_img_hover"></div></div><table class="msg" cellspacing="0" cellpadding="0"><tbody><tr><td class="lt"></td><td class="tt"></td><td class="rt"></td></tr><tr><td class="lm"></td><td class="mm">',shellPos:'</td><td class="rm"><span></span></td></tr><tr><td class="lb"></td><td class="bm"></td><td class="rb"></td></tr><tr><td></td><td class="time">',shellPos2:"</td><td></td></tr></tbody></table></div>",init:function(data){this.data=data,this.shellPre='<div class="customer_lists clearfix"><div class="header_img '+window.jimiHeader+'"  style="background: url(//static.360buyimg.com/jimi/dist/v20140121/i/img1.png) no-repeat center;"><div class="header_img_hover"></div></div><table class="msg" cellspacing="0" cellpadding="0"><tbody><tr><td class="lt"></td><td class="tt"></td><td class="rt"></td></tr><tr><td class="lm"></td><td class="mm">'},getName:function(){return"Question"},show:function(ele,isAppend,isAddShell){var html="";if(isAddShell){var userImageUrl=package("v.login").userImageUrl;if(""==userImageUrl||void 0===userImageUrl)html=this.shellPre+this.data+this.shellPos+this.shellPos2;else{var userShellPre='<div class="customer_lists clearfix"><div class="header_img '+window.jimiHeader+'" style="background: url('+userImageUrl+') no-repeat center;"><div class="header_img_hover"></div></div><table class="msg" cellspacing="0" cellpadding="0"><tbody><tr><td class="lt"></td><td class="tt"></td><td class="rt"></td></tr><tr><td class="lm"></td><td class="mm">';html=userShellPre+this.data+this.shellPos+this.shellPos2}}isAppend||$(ele).html(""),$(ele).hasClass("chat-block")?($(document).trigger("questionPreAdd"),$(html).appendTo("#chatcontent"),$(document).trigger("questionAdded")):$(html).appendTo($(ele)),$(ele).show()}}),AbstractAnswer=Class.extend({init:function(data){this.data=data},show:function(){}}),TemplateAnswer=AbstractAnswer.extend({shellPre:'<div class="jimi_lists clearfix"><div class="header_img '+jimiHeader+' fl"></div><table class="msg" cellspacing="0" cellpadding="0"><tbody><tr><td class="lt"></td><td class="tt"></td><td class="rt"></td></tr><tr><td class="lm"><span></span></td><td class="mm">',shellPos:'</td><td class="rm"></td></tr><tr><td class="lb"></td><td class="bm"></td><td class="rb"></td></tr>',shellPos2:"<tr><td></td></tr></tbody></table>",init:function(data){this._super(data),this.shellPre='<div class="jimi_lists clearfix"><div class="header_img '+window.jimiHeader+' fl"></div><table class="msg" cellspacing="0" cellpadding="0"><tbody><tr><td class="lt"></td><td class="tt"></td><td class="rt"></td></tr><tr><td class="lm"><span></span></td><td class="mm">'},_dealHtml:function(html,ele,isAddShell,isAppend,position){html.length<=0&&(html="\u597d\u7d2f\uff0c\u6211\u7b54\u4e0d\u4e0a\u4e86"),isAddShell&&(html=this.shellPre+html+this.shellPos+this.shellPos2),isAppend||$(ele).html("");var $html=$(html);$(ele).hasClass("chat-block")?this.data.refreshContent||($(document).trigger("answerPreAdd"),$html.appendTo("#chatcontent")):$html.appendTo($(ele)),position?$(ele).css(position).show():$(ele).show(),package("v.openflashchart").createChartByElement($(html)),package("v.follow").getStatus($(ele)),package("v.login").delOldMsgTips(),21==this.data.answer_note&&package("v.manual").bindGuideLog($html),package("v.chatHelper").showThumbnail($html);var data=this.data,ext_property="undefined"!=typeof data.ext_property?data.ext_property:{};$(ele).hasClass("chat-block")&&ext_property.switchWare&&switchProduct(ext_property.switchWare,ext_property.refreshContent,function(){data.answer_title&&"p_fold_answer"!=data.infoType&&"p_user_feedback"!=data.infoType&&ext_property.refreshContent&&showMes("JIMI",data.answer_title),$html&&$html.appendTo("#chatcontent"),ext_property.userGuideFlag?package("v.manual").showGuide(data.code_answer):ext_property.inviteFlag&&package("v.invite").show()},!0),this.data.fe||(package("v.close").closingFlag=ext_property.closeFlag||!1,package("v.invite").showFeedbackWhenClose=ext_property.closeFlag||!0,this.data.refreshContent||(ext_property.userGuideFlag?package("v.manual").showGuide(this.data.code_answer):ext_property.inviteFlag&&package("v.invite").show())),$(ele).hasClass("chat-block")&&"undefined"!=typeof ext_property&&$(document).trigger("answerAdded",[ext_property.resultType]),setScroll()}}),searchResult=[],LocalTemplateAnswer=TemplateAnswer.extend({init:function(data){this._super(data);var answer=data.answer,msgid=data.msgid;"[object Array]"===Object.prototype.toString.call(answer,msgid)&&"[object Array]"===Object.prototype.toString.call(answer,msgid)&&(this.data.datas=answer,this.data.msgid=msgid)},show:function(ele,isAppend,isAddShell,position){var userContent=$("#chatcontent").find(".customer_lists:last-child").find(".mm"),html="",_this=this;if(this.data.jimiHeader=window.jimiHeader,$.template("template",unescape(this.tmpl)),html=$("<div></div>").append($.tmpl("template",this.data)).html(),4==this.data.answer_note){userContent.html(html),userContent.closest(".customer_lists").addClass("short_cut_msg"),setTimeout(function(){showMes("JIMI",_this.data.answer_title)},400);var ext_property=this.data.ext_property||{};$(ele).hasClass("chat-block")&&ext_property.switchWare&&switchProduct(ext_property.switchWare,ext_property.refreshContent)}else{if("p_product_data"==this.data.infoType){searchResult.push(html);var erect=createSearching();return searchCounting(),this._dealHtml(erect,ele,isAddShell,isAppend,position),void setTimeout(function(){setScroll()},200)}if("p_faq_consultdata"==this.data.infoType)return console.log(html),showMes("JIMI",_this.data.answer_title),this._dealHtml(html,ele,!1,isAppend,position),void setTimeout(function(){setScroll()},200);if("p_image_show"==this.data.infoType&&(html=html.replace(/s60x60/gi,"s100x100")),this._dealHtml(html,ele,isAddShell,isAppend,position),"p_image_show"==this.data.infoType){var item=$("#chatcontent >:last-child");1!==item.find("img").length||$.trim(this.data.answer_title)?setJimiImgShow(item):(item.find(".p_img_show").css("width","initial"),getImgHeight(item.find("img").attr("src"),function(){setScroll()}))}"p_single_image"==this.data.infoType&&getImgHeight($("#chatcontent .single-img:last").find("img").attr("src"),function(){setScroll()})}}}),interaction=LocalTemplateAnswer.extend({tmpl:'<div id="rich-media" class="richMedia" data-interactiveId="${ext_property.interactiveId}" data-msgid="${ext_property.messageid} "data-className="${ext_property.classifyName}" data-modelName="${ext_property.moduleEnglishName}" data-propertyname="${answer.attr.attr_name}" data-category="${answer.attr.category}" data-propertyid="${answer.attr.attr_id}"> <p class="richMedia-title">{{html answer_title}}</p><ul class="richMedia-list">{{each(i,v) answer.tabs}}<li><a href="javascript:;" data-valueId="${id}" data-valueName="${name}">${showName}</a></li>{{/each}}</ul></div>',getName:function(){return"interaction"}}),imgShow=LocalTemplateAnswer.extend({tmpl:'<div class="p_img_show"><p class="J_imgShow_title">{{html answer_title}}</p><div class="J_TextImageList jimi-img"><ul class="sub-lst sub-lst-03">{{each(index,image) answer}}<li><a title="" href="${bimgurl}" class="J_TextImageItem image-file"><img title="${simgurl}" class="message-img" src="${simgurl}"></a></li>{{/each}}</ul>{{if answer.length > 3}}<span class="num">${answer.length}</span>{{/if}}</div>{{if ext_property && ext_property.add_post_answer}}<div class="jimi-img-add">{{html ext_property.add_post_answer}}</div>{{/if}}</div>',getName:function(){return"imgShow"}}),OrderListAnswer=LocalTemplateAnswer.extend({tmpl:'{{each(i,v) data}}<div class="intro-bar"><ul class="clearfix"><li class="fl">\u8ba2\u5355\u7f16\u53f7\uff1a</li><li class="fl book-list"><a href="${orderDetailUrl}" target="_blank" clstag="JIMI|keycount|home2014|dd3">${orderId}</a></li><li class="fl">\u8ba2\u5355\u72b6\u6001\uff1a</li><li class="fl">${stateMsg}</li></ul>{{if i==0}}<div class="triangle-open"></div>{{else}}<div class="triangle-close"></div>{{/if}}</div>{{if i>0}}<div class="detail" style="display:none"><ul class="book-img-area clearfix">{{each wares}}<li class="fl book-img"><a href="${wareUrl}" target="_blank"><img src="${imgUrl}" alt="${name}" title="${name}" clstag="JIMI|keycount|home2014|dd4"></a></li>{{/each}}</ul>\u8ba2\u5355\u91d1\u989d\uff1a<span style="margin-right: 28px">\uffe5${orderPay}</span>\u6536\u8d27\u4eba\uff1a${consignee}<div class="book-opts">{{if stateMsg=="\u5b8c\u6210"}} {{else stateMsg=="\u5df2\u53d6\u6d88"}} {{else stateMsg==""}} {{else}} <a href="javascript:void(0);" ordernum="${orderId}" class="follow unfinish">\u5168\u7a0b\u8ddf\u8e2a<div class="triangle-open"></div></a> <a href="javascript:void(0);" ordernum="${orderId}" class="productBack" clstag="JIMI|keycount|home2014|dd2">\u53d6\u6d88\u8ba2\u5355</a> {{/if}} {{if stateFlag == 0}} <a href="javascript:void(0);" ordernum="${orderId}" class="productBack" clstag="JIMI|keycount|home2014|dd1">\u8fd4\u4fee/\u9000\u6362\u8d27</a> {{else stateFlag == 1}} <a href="javascript:void(0);" ordernum="${orderId}" class="productBack">\u8fd4\u4fee/\u9000\u6362\u8d27\u8fdb\u5ea6\u67e5\u8be2</a> {{else stateFlag == 2}} <a href="javascript:void(0);" ordernum="${orderId}" class="productBack" clstag="JIMI|keycount|home2014|dd1">\u8fd4\u4fee/\u9000\u6362\u8d27</a> <a href="javascript:void(0);" ordernum="${orderId}" class="productBack">\u8fd4\u4fee/\u9000\u6362\u8d27\u8fdb\u5ea6\u67e5\u8be2</a> {{/if}}</div></div>{{else}}<div class="detail"><ul class="book-img-area clearfix">{{each wares}}<li class="fl book-img"><a href="${wareUrl}" target="_blank"><img src="${imgUrl}" alt="${name}" title="${name}" clstag="JIMI|keycount|home2014|dd4"></a></li>{{/each}}</ul>\u8ba2\u5355\u91d1\u989d\uff1a<span style="margin-right: 28px">\uffe5${orderPay}</span>\u6536\u8d27\u4eba\uff1a${consignee}<div class="book-opts">{{if stateMsg=="\u5b8c\u6210"}} {{else stateMsg=="\u5df2\u53d6\u6d88"}} {{else stateMsg==""}} {{else}} <a href="javascript:void(0);" ordernum="${orderId}" class="follow unfinish">\u5168\u7a0b\u8ddf\u8e2a<div class="triangle-open"></div></a> <a href="javascript:void(0);" ordernum="${orderId}" class="productBack" clstag="JIMI|keycount|home2014|dd2">\u53d6\u6d88\u8ba2\u5355</a> {{/if}} {{if stateFlag == 0}} <a href="javascript:void(0);" ordernum="${orderId}" class="productBack" clstag="JIMI|keycount|home2014|dd1">\u8fd4\u4fee/\u9000\u6362\u8d27</a> {{else stateFlag == 1}} <a href="javascript:void(0);" ordernum="${orderId}" class="productBack">\u8fd4\u4fee/\u9000\u6362\u8d27\u8fdb\u5ea6\u67e5\u8be2</a> {{else stateFlag == 2}} <a href="javascript:void(0);" ordernum="${orderId}" class="productBack" clstag="JIMI|keycount|home2014|dd1">\u8fd4\u4fee/\u9000\u6362\u8d27</a> <a href="javascript:void(0);" ordernum="${orderId}" class="productBack">\u8fd4\u4fee/\u9000\u6362\u8d27\u8fdb\u5ea6\u67e5\u8be2</a> {{/if}}</div></div>{{/if}} {{/each}}',getName:function(){return"OrderListlAnswer"}}),BuyConsultAnswer=LocalTemplateAnswer.extend({tmpl:'{{if !(isCustomerEntrance())}}<div class="intro-bar">\u6211\u7684\u5730\u533a\u652f\u6301\u54ea\u4e9b\u914d\u9001\u670d\u52a1<div class="triangle-close"></div></div><div class="detail" style="display: none;position: relative;*zoom: 1"><div class="answer"><div>\u914d\u9001\u5230\uff1a<div id="district-consult-select" class="customer-address-area fl p-district"><div class="text"><div>\u8bf7\u9009\u62e9</div><b></b></div></div></div><div id="district-result"></div></div></div>{{else}} {{if result[0].robotId && result[0].robotId==1}}<div class="intro-bar">\u6211\u4e70\u7684\u5546\u54c1\u552e\u540e\u653f\u7b56\u662f\u600e\u6837<div class="triangle-close"></div></div><div class="detail" style="display: none" id="product-service-search"><div class="answer"><p>\u8bf7\u8f93\u5165\u5546\u54c1\u9875\u4e0a\u65b9\u5730\u5740\u680f\u7684\u94fe\u63a5\uff0c\u5982\u56fe\u6240\u793a\uff1a</p><div class="link-notice"><img alt="\u94fe\u63a5\u63d0\u793a" src="//static.360buyimg.com/jimi/img/product_url.png"></div><div class="search-area"><input type="text" placeholder="\u8bf7\u8f93\u5165\u5546\u54c1\u94fe\u63a5" id="productUrl"><div class="search-button"></div></div></div></div>{{/if}} {{/if}} {{each(i, v) result}}<div class="intro-bar"><span class="question">${v.question}</span><div class="triangle-close"></div></div><div class="detail" style="display:none"><div class="answer">{{html v.answer}}</div></div>{{/each}}',getName:function(){return"BuyConsultAnswer"}}),PreFaq=LocalTemplateAnswer.extend({tmpl:"<span>{{if questions}} <a class=\"pretext\">{{html initword}}\u4ee5\u4e0b\u95ee\u9898\u662f\u60a8\u5173\u5fc3\u7684\u5417\uff1a</a> {{else}} <a class=\"pretext nopre\">{{html initword}}</a> {{/if}} {{each(i,v) questions}}<br><a class=\"common-question-bg1\" onclick=\"sendData('${groupId}','${sid}','${q}',{{if answer}}'${answer}'{{else}}'0'{{/if}},this)\"><span>${q}</span></a> {{/each}}</span>",getName:function(){return"PreFaq"}}),PlainText=LocalTemplateAnswer.extend({tmpl:"<span>{{html answer}}</span>",getName:function(){return"PlainText"}}),WithSugguestionsAnswer=LocalTemplateAnswer.extend({tmpl:"<span class=\"wel\">{{html answer}} {{if conjStr}}<br><br>${conjStr}: {{/if}} {{each(i,v) relevantQuestionList}}<br>${i+1}\u3001<a onclick=\"sendClick(1,'${id}','${question}','${commandNo}','${sceneNo}')\"><span>${question}</span></a> {{/each}}</span>",getName:function(){return"WithSugguestionsAnswer"}}),OrderDetailAnswer=LocalTemplateAnswer.extend({tmpl:'<ul class="jimi-orderinfo"><li class="head">\u8ba2\u5355\u53f7\uff1a${orderId} &nbsp;&nbsp;\u8ba2\u5355\u72b6\u6001\uff1a<label class="status">${orderStateName}</label></li><li class="image">{{each details}} <span><a href="${url}" target="_blank">${name}</a></span><label class="status"><label class="multiply">\xd7</label>${num}</label>{{/each}}</li><li class="info"><p class="title">\u6536\u8d27\u4eba\u4fe1\u606f</p><p>\u6536\u8d27\u4eba\uff1a${customerName}</p><p>\u5730\u5740\uff1a${address}</p><p>\u6536\u8d27\u4eba\u7535\u8bdd\uff1a${mobile}</p></li><li class="info"><p class="title">\u652f\u4ed8\u4e0e\u914d\u9001\u65b9\u5f0f</p><p>\u652f\u4ed8\u65b9\u5f0f\uff1a${idPaymentTypeName}</p><p>\u8fd0\u8d39\uff1a\uffe5${trueTotalFee}</p>{{if expectPickTime}}<p>\u9001\u8d27\u65e5\u671f\uff1a${expectPickTime}</p>{{/if}} </li></ul>',getName:function(){return"OrderDetailAnswer"}}),OrderTrackAnswer=LocalTemplateAnswer.extend({tmpl:'<div class="jimi-order-tracking"><table cellspacing="0" cellpadding="0" width="100%">{{if !data || !data.length}}<tr><td class="time" colspan="2">\u6682\u65f6\u6ca1\u6709\u8ddf\u8e2a\u4fe1\u606f</td></tr>{{else}} {{each data}} {{if $index == 0}}<tr class="receipt">{{else}}</tr><tr>{{/if}}<td class="time">${msgTime}</td><td class="info">${content}</td></tr>{{/each}} {{/if}}</table></div>',getName:function(){return"OrderTrackAnswer"}}),DeliveryServiceAnswer=LocalTemplateAnswer.extend({tmpl:"tmpl.deliveryservice",getName:function(){return"DeliveryServiceAnswer"}}),ProductServiceAnswer=LocalTemplateAnswer.extend({tmpl:'<p class="txt-black">\u60a8\u6240\u67e5\u8be2\u7684\u5546\u54c1\u662f\uff1a</p><div class="search-result clearfix"><div class="search-result-img fl"><a href="${productUrl}" target="_blank"><img src="${absoluteImageUrl}" alt="\u5546\u54c1\u7f29\u7565\u56fe"></a></div><a href="${productUrl}" target="_blank">${productName}</a></div><p class="txt-black">\u8fd9\u6b3e\u5546\u54c1\u7684\u552e\u540e\u670d\u52a1\uff1a</p><div class="search-result-des">{{html asfInfo}}</div>',getName:function(){return"ProductServiceAnswer"}}),ProductInfoAnswer=LocalTemplateAnswer.extend({tmpl:'<div class="detail"><div class="goods-info clearfix"><div class="goods-img fl"><a target="_blank" href="//item.jd.com/${wareDetailsBean.wid}.html" clstag="JIMI|keycount|home2014|sp1"><img src="${wareDetailsBean.imageurl}" alt="\u5546\u54c1\u7f29\u7565\u56fe" style="height: 100px; width: 100px"></a></div><p><a href="//item.jd.com/${wareDetailsBean.wid}.html" title="${wareDetailsBean.wname}" target="_blank" clstag="JIMI|keycount|home2014|sp1">${wareDetailsBean.wname}</a></p><p class="txt-red" title="${wareDetailsBean.slogan}">{{html wareDetailsBean.slogan}}</p></div><ul class="goods-des"><li class="clearfix"><div class="fl label">\u4eac&nbsp;&nbsp;\u4e1c&nbsp;&nbsp;\u4ef7\uff1a</div><div class="goods-des-detail"><span class="txt-price">\uffe5${wareDetailsBean.wmeprice}</span></div></li><li class="clearfix"><div class="fl label">\u4fc3\u9500\u4fe1\u606f\uff1a</div><div class="goods-des-detail">{{html wareDetailsBean.promotion}}</div></li><li class="clearfix"><div class="fl label">\u5e93&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u5b58\uff1a</div><div class="goods-des-detail">${wareDetailsBean.stock}</div></li><li class="clearfix"><div class="fl label">\u5546\u54c1\u8bc4\u5206\uff1a</div><div class="goods-des-detail"><span class="star-${wareDetailsBean.averageScore} fl"></span><a href="//item.jd.com/${wareDetailsBean.wid}.html#product-detail" target="_blank" class="fl">{{if wareDetailsBean.commentNum}}(${wareDetailsBean.commentNum}\u6761\u8bc4\u8bba){{else}}(\u8bc4\u8bba){{/if}}</a></div></li><li class="clearfix"><div class="fl label">\u670d&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u52a1\uff1a</div><div class="goods-des-detail">{{html wareDetailsBean.service}}</div></li></ul><a href="//gate.jd.com/InitCart.aspx?pid=${wareDetailsBean.wid}&pcount=1&ptype=1" target="_blank" class="opts-buy abtest" clstag="JIMI|keycount|home2014|sp3"></a></div>{{if wareDetailsBean.noStockRecommend && wareDetailsBean.noStockRecommend.length}}<p class="post-title"><strong>{{if wareDetailsBean.recommendType==1}}\u5e97\u957f\u63a8\u8350{{else}}\u4e3a\u60a8\u63a8\u8350{{/if}}{{if wareDetailsBean.noStockRecommend.length>3}}</strong><a class="change-btn" href="javascript:;">\u6362\u4e00\u7ec4</a>{{/if}}</p><div class="detail post-goods-info-area"><div class="post-goods-area-wrapper" style="top:0">{{each(i,v) wareDetailsBean.noStockRecommend}}<div class="post-goods-area" title="${wname}"><div class="post-goods-img"><a href="//item.jd.com/${wid}.html" target="_blank" clstag="JIMI|keycount|home2014|sp1"><img src="${imageurl}" alt="\u5546\u54c1\u7f29\u7565\u56fe"></a></div><p class="post-goods-title"><a target="_blank" href="//item.jd.com/${wid}.html" clstag="JIMI|keycount|home2014|sp1">${wname}</a></p><p class="txt-price">{{if wmeprice}}\uffe5{{/if}}${wmeprice}&nbsp;</p></div>{{/each}}</div></div>{{/if}}',getName:function(){return"ProductInfoAnswer"}}),ProductRecommendListAnswer=LocalTemplateAnswer.extend({tmpl:'<span>{{if conjStr}} {{html conjStr}} {{/if}} {{if typeof(conjStr) =="undefined"}} JIMI\u4e3a\u60a8\u63a8\u8350\u4e86\u4e0b\u9762\u8fd9\u51e0\u6b3e\uff0c\u770b\u60a8\u662f\u5426\u4e2d\u610f\u5462\uff1f\u5982\u679c\u4e0d\u6ee1\u610f\uff0c\u60a8\u8fd8\u53ef\u4ee5\u544a\u8bc9\u6211\uff0c\u60a8\u60f3\u8981\u4ec0<br>\u4e48\u6837\u7684\uff0c\u6bd4\u5982\u201c\u6211\u60f3\u8981\u767d\u8272\u7684\u201d {{/if}}</span><div class="jimi-goods-list clearfix"><div class="list-panel"><div class="views"  style="margin-top: 0">{{each(i,v) data}}<div class="goods-detail clearfix"><a href="//item.jd.com/${wid}.html" target="_blank" clstag="JIMI|keycount|home2014|sp1"><img width="80" height="80" src="${imageurl}"></a><div class="goods-des-area"><p class="goods-title"><a href="//item.jd.com/${wid}.html" target="_blank" title="${wname}" clstag="JIMI|keycount|home2014|sp1">${wname}</a></p><p class="d-price"></p><ul class="goods-des clearfix"><li class="clearfix"><div class="fl label">\u4eac&nbsp;&nbsp;\u4e1c&nbsp;&nbsp;\u4ef7\uff1a</div><div class="goods-des-detail"><span class="txt-price">\uffe5${wmeprice}</span></div></li></ul><div class="btn-wrap clearfix"><a class="note-btn isAddNote" href="javascript:;" productid="${v.wid}" clstag="JIMI|keycount|home2014|sp4">\u52a0\u5173\u6ce8</a> <a class="append-btn abtest" href="//gate.jd.com/InitCart.aspx?pid=${v.wid}&pcount=1&ptype=1" target="_blank" clstag="JIMI|keycount|home2014|sp3">\u52a0\u5165\u8d2d\u7269\u8f66</a> <a productid="${wid}" href="javascript:;" class="ask-btn productConsult" clstag="JIMI|keycount|home2014|sp2">\u95eeJIMI</a></div></div></div>{{/each}}</div></div>{{if data.length > 2}} <a class="change-btn" href="javascript:;">\u6362\u4e00\u7ec4</a>     {{/if}}</div>',getName:function(){return"ProductRecommendListAnswer"},show:function(ele,isAppend,isAddShell){this.shellPre='<div class="jimi_lists clearfix"><div class="header_img '+window.jimiHeader+' fl"></div><table class="msgP" cellspacing="0" cellpadding="0"><tbody><tr><td class="lt"></td><td class="tt"></td><td class="rt"></td></tr><tr><td class="lm"><span></span></td><td class="mm">',this._super(ele,this.tmpl,isAppend,isAddShell)}}),ProductPropertyAnswer=LocalTemplateAnswer.extend({tmpl:'<div style="max-width: 450px">{{each data}}<div style="float:left"><div class="answer">${textAnswer}</div><div class="jimi-propertys-list">{{each productPropertyInfoList}} {{if propertyName}} <div>&nbsp;&nbsp; ${propertyName} :&nbsp; ${propertyValue}</div>{{else}}<div class="views" ><div class="jimi-propertys-view"><div class="goods-image"><a href="${productUrl}" target="_blank"><img src="${imageUrl}"></a></div><div class="goods-price" style="max-width: 100px;overflow: hidden"><label title="${propertyValue}">${propertyValue}</label></div></div></div>{{/if}} {{/each}} </div></div><br>{{/each}}</div>',getName:function(){return"ProductPropertyAnswer"}}),commonAndRedictAnswer=LocalTemplateAnswer.extend({tmpl:"<span class=\"wel\">{{html answer}} {{if conjStr}}<br><br>${conjStr}: {{/if}} {{each(i,v) relevantQuestionList}}<br>${i+1}\u3001<a onclick=\"sendClick(1,'${id}','${question}','${commandNo}','${sceneNo}')\"><span>${question}</span></a> {{/each}}</span>",getName:function(){return"commonAndRedictAnswer"}}),ChatAnswer=LocalTemplateAnswer.extend({tmpl:'<span data-classifyname="${classifyName}" data-requesttext="${requestText}">{{html answer}} {{if showRelationQA}} {{if conjStr}} {{if answer && relevantQuestionList.length}} <i class="common-hr"></i> {{/if}} ${conjStr}\uff1a {{/if}} {{each(i,v) relevantQuestionList}}<br><a class="common-question-bg" data-cateid="${cateId}" data-modelname="${modelName}" data-classifyname="${classifyName}" onclick=sendClick({{if commandNo}}1{{else}}0{{/if}},\'${id}{{if !commandNo}}&&&faq{{/if}}\',\'${cleanBr(question)}\',\'${commandNo}\',\'${sceneNo}\',${i+1},this)>${question}</a> {{/each}} {{/if}}</span> {{if resultTypebak =="baiduAnswer"}} <img style="vertical-align:text-top" title="\u4fe1\u606f\u6765\u81ea\u767e\u5ea6\uff0c\u4ec5\u4f9b\u53c2\u8003" alt="\u4fe1\u606f\u6765\u81ea\u767e\u5ea6\uff0c\u4ec5\u4f9b\u53c2\u8003" src="//static.360buyimg.com/jimi/img/bd_logo_gray_20140410.png"> {{/if}}',getName:function(){return"ChatAnswer"}}),FoldAnswer=LocalTemplateAnswer.extend({tmpl:'<span data-requesttext="${requestText}" data-msgid="${ext_property.messageid}" data-interactiveId="${ext_property.interactiveId}">{{html answer_title}} {{each(i,v) datas}}<p><a href="javascript:;" data-anwser="${a}" data-id="${id}">${q}</a></p>{{/each}}<p>{{html extra}}</p></span>',getName:function(){return"FoldAnswer"}}),UserFeedback=LocalTemplateAnswer.extend({tmpl:'<span data-classifyname="" data-msgid="${ext_property.messageid}" data-interactiveId="${ext_property.interactiveId}" data-requesttext="${requestText}">${answer_title} {{each(i,v) datas}}{{if v.feedbackAnswer || v.feedbackAnswer==""}}{{if i == datas.length-1}}<br/><span class="common-question-bg">{{html question}}</span>{{else}}<br><a class="common-question-bg" data-cateid="${cateId}" data-modelname="${modelName}" data-classifyname="${classifyName}" onclick="sendClick(0,\'&&&faq\',\'${cleanBr(question)}\',\'\',\'\',${i+1},this,${type},\'\',\'${cleanBr(feedbackAnswer)}\')">${question}</a>{{/if}}{{else}}<br><a class="common-question-bg" data-cateid="${cateId}" data-modelname="${modelName}" data-classifyname="${classifyName}" onclick="sendClick(0,\'&&&faq\',\'${cleanBr(question)}\',\'\',\'\',${i+1},this,false,false)">${question}</a>{{/if}}{{/each}}</span>',
getName:function(){return"UserFeedback"}}),ProductData=LocalTemplateAnswer.extend({tmpl:'{{if answer_note == 4}}{{each(i,v) answer}}<div class="goods-detail clearfix"><a target="_blank" href="//item.jd.com/${wid}.html" clstag="JIMI|keycount|home2014|sp1"><img height="100" width="100" src="${imageurl}" data-bd-imgshare-binded="1"></a><div class="goods-des-area"><p><a target="_blank" href="//item.jd.com/${wid}.html" clstag="JIMI|keycount|home2014|sp1">${wname}</a></p><p class="d-price">{{html slogan}}</p><ul class="goods-des clearfix"><li class="clearfix"><div class="fl label">\u4eac&nbsp;&nbsp;\u4e1c&nbsp;&nbsp;\u4ef7\uff1a</div><div class="goods-des-detail"><span class="txt-price">\uffe5${wmeprice}</span></div></li><li class="clearfix"><div class="fl label">\u5546\u54c1\u8bc4\u5206\uff1a</div><div class="goods-des-detail"><span class="star-${averageScore} fl"></span> <a href="//item.jd.com/${wid}.html#product-detail" target="_blank" class="fl">${comments}\u6761\u8bc4\u8bba</a></div></li><li class="clearfix"><div class="fl label">\u670d&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u52a1\uff1a</div><div class="goods-des-detail">{{html providers}}</div></li></ul><div class="btn-wrap clearfix"><a productid="${wid}" href="javascript:;" class="note-btn isAddNote" clstag="JIMI|keycount|home2014|sp4" title="\u52a0\u5173\u6ce8">\u52a0\u5173\u6ce8</a> <a target="_blank" href="//gate.jd.com/InitCart.aspx?pid=${wid}&amp;pcount=1&amp;ptype=1" class="append-btn abtest" clstag="JIMI|keycount|home2014|sp3" title="\u52a0\u5165\u8d2d\u7269\u8f66">\u52a0\u5165\u8d2d\u7269\u8f66</a></div></div></div><p></p>{{/each}} {{else}} <span data-requesttext="${requestText}">{{html answer_title}}</span><div class="jimi-goods-list clearfix"><div class="list-panel"><div class="views" data-msgid="${messageid}" style="margin-top: 0">{{each(i,v) answer}}<div class="goods-detail clearfix"><a data-pid="${wid}" href="//item.jd.com/${wid}.html" target="_blank" clstag="JIMI|keycount|home2014|sp1"><img width="80" height="80" src="${imageurl}"></a><div class="goods-des-area"><p class="goods-title"><a href="//item.jd.com/${wid}.html" target="_blank" title="${wname}" clstag="JIMI|keycount|home2014|sp1">${wname}</a>{{each(j,t) tags}}<span class="goods-tag">${tag}</span>{{/each}}<span class="goods-review">\u597d\u8bc4\u7387\uff1a${goodrate}</span></p><p class="d-price"></p><ul class="goods-des clearfix"><li class="clearfix"><div class="fl label">\u4eac&nbsp;&nbsp;\u4e1c&nbsp;&nbsp;\u4ef7\uff1a</div><div class="goods-des-detail"><span class="txt-price">\uffe5${wmeprice}</span></div></li></ul><div class="btn-wrap clearfix"><a class="note-btn isAddNote" href="javascript:;" productid="${v.wid}" clstag="JIMI|keycount|home2014|sp4">\u52a0\u5173\u6ce8</a> <a class="append-btn abtest" href="//gate.jd.com/InitCart.aspx?pid=${v.wid}&pcount=1&ptype=1" target="_blank" clstag="JIMI|keycount|home2014|sp3">\u52a0\u5165\u8d2d\u7269\u8f66</a> <a productid="${wid}" href="javascript:;" class="ask-btn productConsult" clstag="JIMI|keycount|home2014|sp2">\u95eeJIMI</a></div></div></div>{{/each}}</div></div>{{if answer.length > 2}} <a class="change-btn" href="javascript:;">\u6362\u4e00\u7ec4</a> {{/if}}</div>{{/if}}',getName:function(){return"ProductData"}}),fristCard=(LocalTemplateAnswer.extend({tmpl:'<div class="chat-helper"><div class="chat-helper-guess"><div class="chat-helper-guess-tips">JIMI\u731c\u60a8\u60f3\u95ee\uff1a</div><div class="chat-helper-guess-select"><span>{{if result.length}}${result[0]}{{/if}}</span> <b><i></i></b><ul class="chat-helper-guess-list" style="display: none">{{each(i,v) result}}<li><a title="${v}" href="javascript:;">${v}</a></li>{{/each}}</ul></div></div></div>',getName:function(){return"ChatHelper"}}),LocalTemplateAnswer.extend({tmpl:'<div class="f-card" data-id="${answer.id}" data-type="${ext_property.type}">{{if answer.img}}<ul class="img-lis">{{each(i,an) answer.img}}<li><a class="c-link" data-id="${an.id}"  data-type="0" data-position="${an.position}"  href="${an.href}"  target="_blank"><img src="${an.src}" ></a></li>{{/each}}</ul>{{/if}}{{if answer.text}}<p class="text-lis-tip">\u60a8\u662f\u5426\u60f3\u54a8\u8be2\uff1a</p><ul class="text-lis" data-interactiveId="${ext_property.interactiveId}">{{each(i,an) answer.text}}<li><a  class="c-link" data-id="${an.id}" href="javascript:;" data-anwser="${an.a}" data-type="1"  data-position="${an.position}">{{html an.q}}</a></li>{{/each}}</ul><p class="bot-note">\u5982\u679c\u6ca1\u6709\uff0c\u8bf7\u5728\u4e0b\u9762\u76f4\u63a5\u544a\u8bc9\u6211~</p>{{/if}}{{if answer.questiontip}}<p class="text-lis-tip">\u60a8\u662f\u5426\u60f3\u54a8\u8be2\uff1a</p><ul class="text-lis" data-interactiveId="${ext_property.interactiveId}">{{each(i,an) answer.questiontip}}<li><a class="c-link" data-id="${an.questionId}"  href="javascript:;" data-send="${an.question}" data-type="1"  data-position="${an.postion}">{{html an.question}}</a></li>{{/each}}</ul><p class="bot-note">\u5982\u679c\u6ca1\u6709\uff0c\u8bf7\u5728\u4e0b\u9762\u76f4\u63a5\u544a\u8bc9\u6211~</p>{{/if}}</div>',getName:function(){return"fristCard"}})),fastEntry=LocalTemplateAnswer.extend({tmpl:'<div class="fast-entry" data-sid = ${sessionId}><a  href="javascript:;" id="f-e-btn" class="f-e-btn on"></a><div class="f-e-lis">{{each(i,an) datas}}{{if an.type == 1}}<a class="f-link-a" data-id="${an.id}" target="_blank"  data-position="${an.position}" href="${an.content}" >{{html an.title}}</a>{{else}}<a class="f-link-a f-send-a" data-id="${an.id}"  data-position="${an.position}" href="javascript:;" data-send="${an.title}" >{{html an.title}}</a>{{/if}}{{/each}}</div></div>',getName:function(){return"fastEntry"}}),messageFaq=LocalTemplateAnswer.extend({tmpl:'<div class="wmessage_faq_wrap"><div class="wmessage_faq_q_wrap"><ul class="w_qu_list">{{each(i,asr) answer}}{{if i < 3 }}<li class="w_ql"><i class="w_q_icon"></i><i class="w_q_tri" {{if answer.length ===1 }} style="display:none"{{/if}}></i><span class="w_q_text">${asr.question}</span><ul class="w_au_list" {{if answer.length ===1 }} style="display:block"{{/if}} style="dispaly:{{ ? block : none}}">{{each(i,qes) asr.questionAnswers}}<li class="w_al"><i class="w_a_icon"></i><span class="w_a_text">${qes.answer}</span><div class="w_a_user_info"><span class="w_a_user_name">${qes.userPin}&nbsp;</span><span class="w_a_answer_time">${qes.date}</span></div></li>{{/each}}</ul></li>{{/if}}{{/each}}{{if answer.length > 3}}<div class="wq_more_list">{{each(i,asr) answer}}{{if i >= 3 }}<li class="w_ql"><i class="w_q_icon"></i><i class="w_q_tri"></i><span class="w_q_text">${asr.question}</span><ul class="w_au_list">    {{each(i,qes) asr.questionAnswers}}<li class="w_al"><i class="w_a_icon"></i><span class="w_a_text">${qes.answer}</span><div class="w_a_user_info"><span class="w_a_user_name">${qes.userPin}&nbsp;</span><span class="w_a_answer_time">${qes.date}</span></div></li>{{/each}}</ul></li>{{/if}}{{/each}}</div>{{/if}}</ul></div>{{if answer.length > 3 }}<div class="w_see_more"><span>\u67e5\u770b\u66f4\u591a</span> <span class="w_see_more_tri"></span></div>{{/if}}<div class="wm_from">\u6765\u81ea\u4eac\u95ee\u7b54\u54a8\u8be2</div></div>',getName:function(){return"messageFaq"}}),singleImage=LocalTemplateAnswer.extend({tmpl:'<div class="single-img"><img src="${answer.img_src}" width="100%"></div>',getName:function(){return"singleImage"}}),RemoteTemplateAnswer=TemplateAnswer.extend({tid:"",version:"",init:function(data){this._super(data),this.tid=this.data.ext_property.tid,this.version=this.data.ext_property.version}}),FormTemplateAnswer=RemoteTemplateAnswer.extend({nData:{},uuid:"",paras:{},init:function(data){this._super(data);"undefined"!=typeof data.ext_property?data.ext_property:{};"string"==typeof data.answer&&/^\{.*\}$/.test(data.answer)?(this.nData=$.parseJSON(data.answer),this.nData.msgid=data.ext_property.messageid):(this.nData=data.answer,this.nData.msgid=data.ext_property.messageid),this.uuid=this.nData.sceneUuid,"undefined"!=typeof this.nData.dataMap&&("undefined"!=typeof this.nData.dataMap[this.tid]?this.nData.dataMap=this.nData.dataMap[this.tid]:this.paras={className:this.nData.className,modelName:this.nData.modelName,sceneUuid:this.nData.sceneUuid,formCode:this.tid})},show:function(ele,isAppend,isAddShell){var that=this,scene=({uuid:this.uuid,data:this.nData,tid:this.tid,version:this.version},new Scence(this.uuid));if(null==scene.getContainer()){var $messageBody=$(that.shellPre+that.shellPos+that.shellPos2),$container=$messageBody.find(".mm");ele.append($messageBody),scene.setContainer($container)}if(scene.setForm(this.tid,this.version,this.nData),scene.render(),that.data.answer="string"==typeof that.data.answer&&that.data.answer.constructor==String?JSON.parse(that.data.answer):that.data.answer,that.data.answer.componentTitle){var titleHtml='<p class="title">'+that.data.answer.componentTitle+"</p>";scene.getContainer().prepend(titleHtml)}setScroll()}}),GeneralTemplateAnswer=RemoteTemplateAnswer.extend({init:function(data){this._super(data);var answer=data.answer,msgid=data.msgid;"[object Array]"===Object.prototype.toString.call(answer,msgid)&&(this.data.datas=answer,this.data.msgid=msgid)},show:function(ele,isAppend,isAddShell){var that=this,form=new Form(that.data,that.tid,that.version);form.getTemplate(function(html){that._dealHtml(html,ele,isAppend,isAddShell)})}});this.AnswerFactory=function(){},AnswerFactory.resultType={orderDetail:OrderDetailAnswer,orderList:OrderListAnswer,orderTrack:OrderTrackAnswer,deliveryService:DeliveryServiceAnswer,buyConsult:BuyConsultAnswer,productInfo:ProductInfoAnswer,productService:ProductServiceAnswer,propertySearch:ProductPropertyAnswer,common:WithSugguestionsAnswer,productRecommendList:ProductRecommendListAnswer,cancelOrder1:commonAndRedictAnswer,question:Question,chat:ChatAnswer,helpCenterFixedAnswer:ChatAnswer,p_plain_text_answer:PlainText,p_fold_answer:FoldAnswer,p_user_feedback:UserFeedback,p_product_data:ProductData,preFaq:PreFaq,p_img_text_answer:fristCard,p_fast_entry:fastEntry,p_interaction:interaction,p_image_show:imgShow,p_faq_consultdata:messageFaq,p_single_image:singleImage},AnswerFactory.answerType={formTemplateAnswer:FormTemplateAnswer,geneTemplateAnswer:GeneralTemplateAnswer,localTemplateAnswer:AnswerFactory.resultType},AnswerFactory.createAnswer=function(infoType,data){var tid,answerType,responseAnswers={},answer={};2==arguments.length?(responseAnswers=data,responseAnswers.infoType=infoType,answerType=infoType):1==arguments.length&&(data=infoType,responseAnswers=data.answers,responseAnswers.infoType=data.ptype,answerType=data.ptype),tid=data.tid,tid||"undefined"!=typeof responseAnswers.ext_property&&(tid=responseAnswers.ext_property.tid);var suid=responseAnswers.ext_property&&responseAnswers.ext_property.interactiveId||!1;if(suid!==!1&&(!answerType||"p_component_answer"!==answerType)){var scence=Scence.HASH[suid];scence&&scence.done()}if("p_img_text_answer"==answerType&&(responseAnswers.answer.questiontip?(responseAnswers.answer.questiontip=JSON.parse(responseAnswers.answer.questiontip),responseAnswers.ext_property.type=1):responseAnswers.ext_property.type=0),tid)switch(answerType){case"p_component_answer":answer=new AnswerFactory.answerType.formTemplateAnswer(responseAnswers);break;case"p_fold_answer":case"p_user_feedback":case"p_product_data":answer=new AnswerFactory.answerType.geneTemplateAnswer(responseAnswers);break;default:answer=new AnswerFactory.answerType.localTemplateAnswer[answerType](responseAnswers)}else answer=new AnswerFactory.answerType.localTemplateAnswer[answerType](responseAnswers);return answer}}(Class,jQuery,window,document),function($,window,document){function openSocket(){var socket=package("v.socket"),pushDataFlag=!1;1==window.wsSwitch||"true"===window.wsSwitch?socket.support()?window.userState!==!0&&"true"!==window.userState||window.loginRequest!==!0||$.ajax({type:"GET",url:"/wsAid.action",dataType:"JSON",data:{},success:function(result){if(1!=result.code)return void(pushDataFlag=!0);var aid=result.context;pushDataFlag=socket.start(aid)}}):pushDataFlag=!1:pushDataFlag=!0,pushDataFlag&&setInterval(pushData,defaultTime)}function pushData(){var commandNo="idlePushCommand",data={commandNo:commandNo,productId:void 0==productId?"":productId,source:jimiSource||""};$.ajax({type:"post",url:"/ask/ask.action",dataType:"JSON",data:data,success:function(ret){var res=JSON.parse(ret.data);if(""!=res.answers.answer){var answer,ele=$("#chatcontent");answer=AnswerFactory.createAnswer(res.ptype,res.answers),answer.show(ele,!0,!0),setScroll()}}})}var defaultTime;defaultTime=void 0!=window.idleTime?window.idleTime:12e4;var notUndefinedInterval=setInterval(function(){"undefined"!=typeof window.wsSwitch&&"undefined"!=typeof window.userState&&"undefined"!==window.loginRequest&&(clearInterval(notUndefinedInterval),openSocket())},100);$(".j-dig-tri").live("click",function(){var target=$(this).parents(".dig-w"),isClicked=$(this).attr("isClicked");if(1!=isClicked){$(this).attr("isClicked","1");var resultType=$(this).attr("resultType"),redisNum=$(this).attr("redisNum"),Obj={};Obj.resultType=resultType,Obj.redisNum=redisNum,$.ajax({type:"post",url:"/teachfeedback/setDianzanMoban.action",dataType:"JSON",data:Obj,before:function(){target.addClass("loading")},success:function(){var redisNum=target.find(".dig-txt em");target.removeClass("loading").addClass("diged"),redisNum.text(+redisNum.text()+1),target.find(".dig-tri ").text("\u8c22\u8c22\uff01")}})}})}(jQuery,window,document),function($,window,document){$(".productConsult").live("click",function(event,notShowJimiTalk,callback){var ele=$(this),wid=ele.attr("productId"),requestText=location.protocol+"//item.jd.com/"+wid+".html",postData={requestText:requestText};showMes("\u6211",requestText),package("v.componentAnswer").sendAsk(postData)}),$(".fittingsRecommendTab").live("mouseover",function(){$(this).parent().siblings("li").removeClass("current"),$(this).parent().addClass("current");var index=$($(this).parent()).index(),divs=$(this).parents("ul").siblings("div");divs.hide(),$(divs[index]).show()})}(jQuery,window,document);var switchProduct=function(switchWare,refreshContent,callback,isAsk){window.productId=switchWare,getProductInfo()},isJIMI2=!0,isMyJimi=!1,source1=!1;!function($,window){function GetQueryString(name){var reg=new RegExp("(^|&)"+name+"=([^&]*)(&|$)"),r=window.location.search.substr(1).match(reg);return null!=r?unescape(r[2]):null}var urlParamObj=parseURLParam();window.productId=urlParamObj.productId,window.jimiSource=urlParamObj.source||"other",window.promotionId=urlParamObj.promotionId,window.pagetype=urlParamObj.pagetype,window.pagevalue=urlParamObj.pagevalue,window.venderId=urlParamObj.venderId,window.orderId=urlParamObj.orderId,window.c3=urlParamObj.c3,window.terminal=urlParamObj.terminal,window.invitingUser=urlParamObj.invitingUser,window.entry=urlParamObj.entry,window.chatId=urlParamObj.chatId,window.referer=urlParamObj.referer,window.isShowSatisfyModal=!1,window.variables=GetQueryString("variables"),window.productId?window.entrance="presale":window.entrance="customer",window.cateId="",$(function(){var package=window["package"]||function(){throw new Error("function package is necessary!")}(),flowParam={t:(new Date).getTime()};window.productId&&(flowParam.productId=window.productId),window.jimiSource&&(flowParam.source=window.jimiSource),$.ajax({type:"get",url:"/welcomeMask/flowControl.action?"+$.param(flowParam),dataType:"json",success:function(res){var inviteModule=package("v.invite");inviteModule.defaultBestSatisfy="selected"==res.templateext,inviteModule.setInviteTemplate(res.template,res.evaluatetemplate),inviteModule.isFiveFeedback=5==res.windowtype,inviteModule.feedbackInit()}}),package("v.close").bindWindowClose(),package("v.shortcut.Dispatching").init(),package("v.adjustView").adaptHeight(),package("v.chatHelper").getQuestions(),package("v.sidebar").init(),package("v.teach").init(),package("v.statistic").init(),package("v.login").init()})}(jQuery,window);var defaultInput=defaultInput||$("#text-in").val()||"\u8bf7\u7b80\u8981\u63cf\u8ff0\u60a8\u7684\u95ee\u9898\uff0c\u5982\u201c\u9000\u6362\u8d27\u8fd0\u8d39\u600e\u4e48\u7b97\u201d",oldQuestion=defaultInput;Date.prototype.format=function(format){var o={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(format)&&(format=format.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var k in o)new RegExp("("+k+")").test(format)&&(format=format.replace(RegExp.$1,1==RegExp.$1.length?o[k]:("00"+o[k]).substr((""+o[k]).length)));return format},+function($,window){function textChange(){var textIn=$.trim($("#text-in").val());if("input"==changeTag&&textIn!=oldQuestion){oldQuestion=textIn,textIn.length>1e3&&(textIn=textIn.substring(0,1e3));var $tip=$("#text-in").next(".input-tips");if(textIn.length>100){$("#sugguestions").hide(),$("#text-in").val(textIn);var tips="\u6700\u591a\u8f93\u5165100\u4e2a\u5b57\uff0c\u5df2\u8d85\u51fa"+(textIn.length-100)+"\u4e2a\u5b57";return void($tip.length?$tip.find("p").html(tips):$("#text-in").after('<div class="input-tips"><span class="input-tips-l"></span><p>'+tips+'</p><span class="input-tips-r"></span><span class="input-tips-arrow"></span></div>'))}$tip.remove();var text=ReplaceTags(textIn);if($(".suggestion").removeClass("hover"),textInValue=text,oldQuestion==defaultInput){var reg=defaultInput;text=text.replaceAll(reg,"")}if(0==text.length||text==defaultInput)return void $("#sugguestions").hide();package("v.chatHelper").showSuggestions(text),window.inputString=text}}function inputKeyUp(e){var keycode=e?e.which:window.event.keyCode;switch(keycode){case 10:case 13:return add(),changeTag="input",window.event?(window.event.returnValue=!1,window.event.preventDefault&&window.event.preventDefault()):e.preventDefault(),!1;case 38:if("none"==$("#sugguestions").css("display"))return!1;var sugs=$("#sugguestions .hover");if(0==sugs.length){$(".suggestion:last").addClass("hover");var text=$(".suggestion:last a").text();changeTag="select",setTimeout(function(){$("#text-in").focus().val(text)})}else if(sugs.removeClass("hover"),sugs.prev(".suggestion").length>0){sugs.prev(".suggestion").addClass("hover");var text=sugs.prev(".suggestion").find("a").text();changeTag="select",setTimeout(function(){$("#text-in").focus().val(text)})}else changeTag="input",setTimeout(function(){$("#text-in").focus().val(textInValue)});break;case 40:if("none"==$("#sugguestions").css("display"))break;var sugs=$("#sugguestions .hover");if(0==sugs.length){$(".suggestion:first").addClass("hover");var text=$(".suggestion:first a").text();changeTag="select",$("#text-in").focus(),$("#text-in").val(text)}else if(sugs.removeClass("hover"),sugs.next(".suggestion").length>0){sugs.next(".suggestion").addClass("hover");var text=sugs.next(".hover").find("a").text();changeTag="select",$("#text-in").focus(),$("#text-in").val(text)}else changeTag="input",$("#text-in").focus(),$("#text-in").val(textInValue);break;default:changeTag="input"}}var textInValue=defaultInput,changeTag="input";$(function(){$("#text-in").val(defaultInput).css("color","#999999").focus(function(){$(this).css("color","#000000");var input=$(this).val();input==defaultInput&&$(this).val("")}).blur(function(){var input=$(this).val();setTimeout(function(){$("#sugguestions").hide()},250),""==input.trim()&&($(this).val(defaultInput),$(this).css("color","#999999"))}).bind("input propertychange",textChange).on("keydown",inputKeyUp),$.browser.msie&&"9.0"==$.browser.version&&setInterval(textChange,50),$("#winsend").click(add)});var changeTag="input"}(jQuery,window);var voluntarySocket=!1,voluntaryTimer=null;_restartVoluntary();var affixParam=null;!function(){var answer,$ele=$("#chatcontent").parent(".nano");$.ajax({type:"GET",url:"/welcome/getShortcutConfig.action",dataType:"JSON",data:{source:window.jimiSource||""},success:function(req){if(req&&1==req.code&&req.data){var param={};param.ptype="p_fast_entry",param.answers={},param.answers.answer=req.data,param.answers.sessionId=req.sessionId,answer=AnswerFactory.createAnswer(param),answer.show($ele,!0,!1),$ele.on("click","#f-e-btn",function(){var $this=$(this);$this.hasClass("on")?($this.removeClass("on"),$this.siblings(".f-e-lis").hide()):($this.addClass("on"),$this.siblings(".f-e-lis").show())})}}})}(),$(".image-file").swipebox({touchClose:!0,useSVG:!1,selector:".image-file"}),package("v.componentAnswer",[],function(require,exports,moudle){return function($){function chongzhi(){$("#chatcontent").on("click","a.paybtn",function(){var List=$(".phoneBillData"),data={};$.each(List,function(i,item){var key="parmap."+item.name;data[key]=item.value}),$.ajax({type:"get",url:"/event/handleEvent.action?t="+(new Date).getTime(),dataType:"JSON",data:data,success:function(res){if(res&&res&&1==res.code){var ob=JSON.parse(res.data);if(1==ob.answers.answer.status){var newWindow=window.open();newWindow.location.href=ob.answers.answer.url}else showMes("JIMI",ob.answers.answer.message)}else showMes("JIMI","\u5145\u503c\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\u3002")},error:function(){showMes("JIMI","\u5145\u503c\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\u3002")}})})}function getStringLen(Str){var i,len,code;if(null==Str||""==Str)return 0;for(len=Str.length,i=0;i<Str.length;i++)code=Str.charCodeAt(i),code>255&&len++;return len}function confirmMess(){var strongnameok=!1,strongphonenumok=!1;$("#chatcontent").on("click",".assure .editicon",function(){if(!$(this).hasClass("dis")){$(this).parent().find(".label").hide(),$(this).parent().find(".editicon").hide(),$(this).parent().find(".message").show();var hidevalue=$(this).parent().find("strong").text();$(this).parent().find(".message").val(hidevalue)}}),$("#chatcontent").on("keyup keydown keypress blur",'input[name="username"]',function(){var val=getStringLen($(this).val()),$submit=$(this).parents(".assure").find(".submit");val>16?0==$(this).siblings(".errortip").length&&($(this).after('<span class="errortip">\u59d3\u540d\u4e0d\u8d85\u8fc78\u4e2a\u5b57</span>'),$submit.removeClass("active")):($(this).siblings(".errortip").remove(),$(this).parents(".assure").find(".assure").addClass("active"),0==val?(0==$(this).siblings(".errortip").length&&$(this).after('<span class="errortip">\u59d3\u540d\u4e0d\u80fd\u4e3a\u7a7a</span>'),$submit.removeClass("active")):($(this).siblings(".errortip").remove(),$submit.addClass("active")))}),$("#chatcontent").on("blur",'input[name="phonenum"]',function(){var $submit=$(this).parents(".assure").find(".submit"),mobile=/(^1[3|5|8|7][0-9]\d{8}$)|(^0\d{2}[-_\uff0d\u2014]?\d{8}$)|(^0\d{3}[-_\uff0d\u2014]?\d{7}$)/;mobile.test($(this).val())?($(this).siblings(".errortip").remove(),$submit.addClass("active")):0==$(this).siblings(".errortip").length&&($(this).after('<span class="errortip">\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u7535\u8bdd\u53f7\u7801</span>'),$submit.removeClass("active"))}),$("#chatcontent").on("click",".assure .submit",function(){if($(this).hasClass("active")){var data={},widgets=[],availableArray=$(this).parents(".assure").find('[wrStatus="w"]');$.each(availableArray,function(i,item){var reg=/^widget_/;if(reg.test($(item).attr("code"))){var tmpobject={},tmpvalues=[];if(tmpobject.widgetCode=$(item).attr("code"),""==$(item).val())if($(item).siblings().find("input[name=iswrap]:checked").length>0)tmpvalues.push($(item).siblings().find("input[name=iswrap]:checked").val());else{var value1=$(item).siblings("strong").text();$(item).is('input[name="username"]')&&(""!=value1?(strongnameok=!0,$(item).siblings(".editicon").css("visibility","hidden")):(strongnameok=!1,0==$(item).siblings(".errortip").length&&($(item).siblings(".editicon").after('<span class="errortip">\u59d3\u540d\u4e0d\u80fd\u4e3a\u7a7a</span>'),$(item).parents(".assure").find(".submit").removeClass("active")))),$(item).is('input[name="phonenum"]')&&(""!=value1?(strongphonenumok=!0,$(item).siblings(".editicon").css("visibility","hidden")):(0==$(item).siblings(".errortip").length&&($(item).siblings(".editicon").after('<span class="errortip">\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u7535\u8bdd\u53f7\u7801</span>'),$(item).parents(".assure").find(".submit").removeClass("active")),strongphonenumok=!1)),tmpvalues.push(value1)}else tmpvalues.push($(item).val());tmpobject.value=tmpvalues,widgets.push(tmpobject)}else{var key="form."+$(item).attr("code");data[key]=item.value}}),$.each(widgets,function(i,item){var key1="form.widgets["+i+"].widgetCode";data[key1]=item.widgetCode,$.each(item.value,function(k,a){var key2="form.widgets["+i+"].value["+k+"]";data[key2]=a})}),_.extend(data,{requestText:"form submit",source:window.jimiSource});var $input=$(this).parents(".assure").find(".label"),inputname=$input.siblings("input[name=username]").val(),inputnum=$input.siblings("input[name=phonenum]").val(),$p=$(this).parents(".assure");""!=inputname&&($input.show(),$p.find("input[name=username]").siblings(".label").text(inputname),$p.find(".message").hide()),""!=inputnum&&($input.show(),$p.find("input[name=phonenum]").siblings(".label").text(inputnum),$p.find(".message").hide());var flag2,flag1=strongnameok&&strongphonenumok;if(flag2=0==$(this).parents(".assure").find(".errortip").length?!0:!1,flag1||flag2)sendAsk(data),$(this).removeClass("active");else{0==$(this).siblings(".errortip").length&&$(this).before('<span class="errortip">\u4fe1\u606f\u4e0d\u7b26\u5408\u89c4\u8303\uff01</span>');var self=$(this);setTimeout(function(){self.siblings(".errortip").remove()},2e3)}}})}function chooseOrder(){$("#chatcontent").on("click",".orderlist .morecheckbox input:checkbox",function(){$(this).prop("checked")?(compproductId=$(this).parents(".morecheckbox").find(".ordersku").text(),activeBtn($(this)),resetBtn($(this)),resetCheckbox($(this))):disableBtn($(this))}),$("#chatcontent").on("click",".orderlist .singlecheckbox input:checkbox",function(){$(this).prop("checked")?(compproductId=$(this).parents(".singlecheckbox").find(".ordersku").text(),activeBtn($(this)),resetBtn($(this)),resetCheckbox($(this))):disableBtn($(this))}),$("#chatcontent").on("click",".richMedia-list a",function(){var item=$(this),interaction=item.closest(".richMedia"),json={className:interaction.attr("data-className"),modelName:interaction.attr("data-modelName"),sceneUuid:"",category:interaction.attr("data-category"),propertyId:interaction.attr("data-propertyid"),propertyName:interaction.attr("data-propertyname"),valueId:item.attr("data-valueid"),valueName:item.attr("data-valuename")},para={source:window.jimiSource,requestText:item.attr("data-valuename"),clickselect:JSON.stringify(json)};showMes("\u6211",item.attr("data-valuename")),sendAsk(para)}),$("#chatcontent").on("click","[link_question]",function(){var item=$(this),question=item.attr("link_question"),askBackSubmitType=item.attr("askBackSubmitType");if(!question)return!1;var para={source:window.jimiSource,requestText:question};return"undefined"!=typeof askBackSubmitType&&(para.askBackSubmitType=askBackSubmitType),showMes("\u6211",question),sendAsk(para),!1}),!function(){function showNext(btn){var form=btn.closest(".jimi_lists");"undefined"==typeof form.data("pageIndex")&&form.data("pageIndex",1);var pageIndex=form.data("pageIndex");pageIndex++,form.find(".moreprolist:lt("+pageNum*pageIndex+")").removeClass("noshow"),scrollTo(form.find(".moreprolist").eq(Math.min(form.find(".moreprolist").length-1,pageNum*(pageIndex-1))),form),0===form.find(".moreprolist:hidden").length?(btn.hide(),btn.parent(".btnarea").siblings(".goodtip").show(),form.data("pageIndex",1)):form.data("pageIndex",pageIndex)}var pageNum=2;$("#chatcontent").on("click",".orderlist .morebtn",function(){showNext($(this))})}(),$("#chatcontent").on("click",".orderlistform .submit",function(){if($(this).hasClass("active")){var data={},widgets=[];data.form={};var necessaryArray=$(this).parents(".orderlistform").find('[wrStatus="w"]');$.each(necessaryArray,function(i,item){var reg=/^widget_/;reg.test($(item).attr("code"))||(data.form[$(item).attr("code")]=item.value)});var $checked=$(this).parents(".orderlist").find("input:checkbox:checked");if(1==$checked.length){var availableArray=$checked.parents(".orderinfo").siblings(".title").find('[wrStatus="w"]');if(availableArray.length>0){var tmpwidgets=[],tmpobject1={},tmpvalues1={};$.each(availableArray,function(k,a){var code=$(a).attr("code");"undefined"==typeof tmpobject1[code]&&(tmpobject1[code]={}),tmpobject1[code].widgetCode=$(a).attr("code"),"undefined"==typeof tmpvalues1[code]&&(tmpvalues1[code]=[]);var tempOrderId=$(a).attr("orderid");"undefined"!=typeof tempOrderId&&tmpvalues1[code].push(tempOrderId),tmpobject1[code].value=tmpvalues1[code]});var availableArray1=$checked.closest("li").find('[wrStatus="w"]');$.each(availableArray1,function(i,item){var tmpobject={},tmpvalues=[];tmpobject.widgetCode=$(item).attr("code");var values=$(item).text()||$(item).attr("orderid");tmpvalues.push(values),tmpobject.value=tmpvalues,tmpwidgets.push(tmpobject)});for(var code in tmpobject1)tmpwidgets.push(tmpobject1[code]);widgets=handledata(tmpwidgets)}}else{var tmpwidgets=[],tmpobject1={},tmpvalues1=[];$.each($checked,function(i,item){if(0==i){var availableArray22=$(item).parents(".orderinfo").siblings(".title").find('[wrStatus="w"]');availableArray22.length>0&&$.each(availableArray22,function(k,a){tmpobject1.widgetCode=$(a).attr("code"),tmpvalues1.push($(a).attr("orderid")),tmpobject1.value=tmpvalues1})}var availableArray33=$(item).closest("li").find('[wrStatus="w"]');$.each(availableArray33,function(i,item){var tmpobject={},tmpvalues=[];tmpobject.widgetCode=$(item).attr("code");var values=$(item).text()||$(item).attr("orderid");tmpvalues.push(values),tmpobject.value=tmpvalues,tmpwidgets.push(tmpobject)})}),tmpwidgets.push(tmpobject1),widgets=handledata(tmpwidgets)}data.form.widgets=widgets,data.form=JSON.stringify(data.form),_.extend(data,{requestText:"form submit",source:window.jimiSource}),sendAsk(data)}}),$("#chatcontent").on("click",".orderlistform .rechoose",function(){if(!$(this).hasClass("dis")){var $checked=$(this).parents(".orderlistform").find("input:checkbox"),$parents=$checked.parents(".moreprolist");$checked.parents(".moreprolist").siblings(".moreprolist").removeClass("noshow1");var $par=$(this).parents(".orderlistform");$par.find(".moreprolist:gt(1)").removeClass("noshow").addClass("noshow"),$par.find(".morebtn").show(),$par.find(".goodtip").hide(),$checked.parents(".orderlistform").find(".rtitle").text("\u8bf7\u9009\u62e9\u60a8\u9047\u5230\u95ee\u9898\u7684\u8ba2\u5355\u53ca\u5546\u54c1\uff1a"),$parents.find(".footer").show(),$parents.find(".footer1").remove();var $li=$parents.find(".orderinfo >li");$li.not($li.has("input:checkbox:checked")).show(),$parents.find(".mycheckbox").show(),$.each($checked,function(i,item){$(item).attr("checked",!1)}),$parents.find(".p-img").removeClass("single1"),$parents.siblings(".btnarea").show(),$parents.find(".oper").show(),$parents.find(".oper1").remove(),$checked.attr("checked",!1)}})}function handledata(obj){var json={};$.each(obj,function(i,n){json[n.widgetCode]?json[n.widgetCode].push(n.value):json[n.widgetCode]=[n.value]});var result=[],result1=[];for(var a in json){var temp={};temp.widgetCode=a,temp.values=json[a],result.push(temp)}return $.each(result,function(i,item){var tmp={};tmp.widgetCode=item.widgetCode;var tmpvalues=[];$.each(item.values,function(k,a){for(var j=0;j<a.length;j++)tmpvalues.push(a[j])}),tmp.value=tmpvalues,result1.push(tmp)}),result1}function resetBtn(obj){var curr=obj,otherForm=curr.parents(".jimi_lists ").siblings(".jimi_lists ").find(".orderlist .submit");otherForm.length>0&&$.each(otherForm,function(i,item){$(item).removeClass("active")})}function resetCheckbox(obj){var curr=obj,otherForm=curr.parents(".jimi_lists ").siblings(".jimi_lists ").find(".orderlist input:checkbox");otherForm.length>0&&$.each(otherForm,function(i,item){$(item).attr("checked",!1)}),$checked=curr.parents(".moreprolist").siblings().find("input:checked"),
$checked.length>0&&$.each($checked,function(i,item){$(item).prop("checked",!1)})}function activeBtn(obj){var curr=obj,currbtn=curr.parents(".orderlist").find(".submit");currbtn.hasClass("active")||currbtn.hasClass("noactive")||currbtn.addClass("active")}function disableBtn(obj){var curr=obj,more=curr.parents(".morecheckbox"),single=curr.parents(".singlecheckbox");if(single.length>0){var currbtn=curr.parents(".orderlist").find(".submit");currbtn.removeClass("active")}if(more.length>0){var checked=curr.parents(".orderinfo").find("input:checkbox:checked");if(0==checked.length){var currbtn=curr.parents(".orderlist").find(".submit");currbtn.removeClass("active")}}}function sendAsk(postdata,callback){function errorAlert(){$("#text-in").focus()}$.ajax({type:"post",url:"/ask/ask.action?t="+(new Date).getTime(),data:postdata,success:function(ret){var tid,version,res=JSON.parse(ret.data);res.tid&&(tid=res.tid),"object"==typeof res.chatinfo&&res.chatinfo.version&&(version=res.chatinfo.version),"string"==typeof res.data&&/^\{.*\}$/.test(res.data)&&(res=JSON.parse(res.data)),"string"==typeof res.answers&&/^\{.*\}$/.test(res.answers)&&(res.answers=JSON.parse(res.answers)),"string"==typeof res.answers.answer&&/^\{.*\}$/.test(res.answers.answer)&&(res.answers.answer=JSON.parse(res.answers.answer));var $replaceMsg="",ext_property="undefined"!=typeof res.answers.ext_property?res.answers.ext_property:{};res.answers.hasOwnProperty("ext_property")||(res.answers.ext_property={}),tid&&(res.answers.ext_property.tid=tid),version&&(res.answers.ext_property.version=version),ext_property.inviteFlag&&(isShowSatisfyModal=!0),/<a class="js-msg-to-manual"/.test(res.answers.answer)&&getProduct(),void 0!=ext_property.add_post_answer&&(res.answers.extra=ext_property.add_post_answer),void 0!=window.entry&&void 0!=window.chatId&&(21==res.answers.answer_note?res.answers.answer=res.answers.answer.replace(/(\?entry=[^\"]*)/,"?entry="+window.entry+"&chatId="+window.chatId):12==res.answers.answer_note&&/.*chat.*jd\.com.*/.test(res.answers.answer)&&(res.answers.answer=res.answers.answer.replace(/(\?entry=[^\"]*)/,"?entry="+window.entry+"&chatId="+window.chatId))),exports.callbackSuccess2(res,$replaceMsg,callback)},error:errorAlert,dataType:"JSON"})}function getProduct(){function callSuccess(data){if(data&&data.state){var newAnswer=new AnswerFactory.createAnswer(data.resultType,data),ele=$("#productDetailDiv");newAnswer.show(ele,!1,!1);var param=skipImParamBuild(data.wareDetailsBean),skipURL="//chat.jd.com/index.action?"+param;$(".service-online").find("a").attr("href",skipURL),$.ajax({type:"get",url:"//chat1.jd.com/api/checkChat?pid="+compproductId,dataType:"jsonp",success:function(data){1!=data.code&&3!=data.code?$(".service-online").hide():$(".service-online").show()},error:function(data){$(".service-online").hide()}}),$(window).trigger("resize")}}$.ajax({type:"get",url:"/product/getProductInfo.action?t="+(new Date).getTime(),data:{productId:compproductId},success:callSuccess,dataType:"json"})}chongzhi(),confirmMess();var compproductId;chooseOrder(),exports.sendAsk=sendAsk,exports.callbackSuccess2=function(data,$replaceMsg,callback){var ele=$("#chatcontent");$replaceMsg&&$replaceMsg.removeClass().html(""),AnswerFactory.createAnswer(data).show($replaceMsg||ele,!0,!0),setScroll(),callback&&callback(data)}}(jQuery),exports}),function(w,u){function judger(type,value){return"undefined"==typeof REG[type]?!0:!!value.match(REG[type])}function validator(form,callback){var items=form.find("[validate]:not([readonly])");items.each(function(i,n){var item=$(n);item.data("isLegal",!0),item.focus(function(){}).blur(function(){var self=$(this),type=self.attr("validate"),value=$.trim(self.val());if(""==value)return void self.data("isLegal",!0).removeClass(illegal);var result=judger(type,value);self.data("isLegal",result),result?self.removeClass(illegal):self.addClass(illegal)})}),form.find(".form_button_submit").click(function(){var result=!0;items.each(function(i,n){$(n).data("isLegal")||(result=!1)}),result&&callback()})}function Form(data,tid,version){var that=this;if(that.formItem=null,that.data={},that.data=data,that.tid=tid.replace(/_{2}\d+$/,""),that.version=version,that.data.dataMap)for(var a in that.data.dataMap)"string"==typeof data.dataMap[a]&&(data.dataMap[a]=data.dataMap[a].replace(/<[^>]+>/g,""))}var REG={num:/^\d+$/g,mail:/^[a-z0-9]+([._\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$/g,date:/^\d{4}(\-|\/|\.)\d{1,2}\1\d{1,2}$/g,phonenum:/^1[34578]\d{9}$/g},illegal="illegal";Form.prototype.evt=function(){var that=this;validator(that.formItem,function(){var formData=Form.getData(that.formItem);Form.paras.widgets=formData,"function"==typeof Form.feedback&&Form.feedback(JSON.stringify(Form.paras))}),that.formItem.find(".form_select").each(function(i,n){1!=$(n).find("select").length&&$(n).find("select:not(:last)").change(function(){Form.renderEnum($(this))})}),that.formItem.find("button.form_button_backward").click(function(){Form.lastHTML=null;var uuid=$(this).data("uuid"),html=Form.histories[uuid].list.shift(),item=$(this).closest(".jimi_lists");replaceMsg(html,item),that.setItem(item)})},Form.prototype.setItem=function(item){if(this.formItem=item,"undefined"!=typeof Form.histories[Form.uuid]&&Form.histories[Form.uuid].list.length&&item.find(".customize-form-button").length){var btn=$('<button class="form_button form_button_backward" value="\u4e0a\u4e00\u6b65">\u4e0a\u4e00\u6b65</button>');console.log(11),item.find(".customize-form-button").append(btn.data("uuid",Form.uuid))}Form.item=item,this.evt()},Form.prototype.getTemplate=function(callback){var that=this;return"string"==typeof Form.templates[that.tid]?(callback.call(that,Form.templates[that.tid]),Form.lastHTML=Form.templates[that.tid],void Form.store()):void $.ajax({url:"http://jimi1.jd.com/template/getTemplate.action",data:{componentCode:that.tid,version:that.version,source:jimiSource},dataType:"text",success:function(data){if(data=data.replace(/\t/g,""),data=$.parseJSON(data),1==data.code){var html=data.template.componentHtml;html=Form.transformation(html).replace(/\&nbsp;/g,"").replace(/\&gt;/g,">").replace(/\&lt;/g,"<"),$.template("template",unescape(html)),html=$("<div></div>").append($.tmpl("template",that.data)).html(),Form.templates[that.tid]=html,callback.call(that,html),Form.lastHTML=html,Form.store()}}})},Form.enumAPI="http://jimi1.jd.com/template/getComponentEnum.action",Form.uuid=null,Form.emptyEnum='<option value="">--\u8bf7\u9009\u62e9--</option>',Form.renderEnum=function(item){if(item.nextAll("select").html(Form.emptyEnum),""!=item.val()){var enumType=item.closest(".form_select").attr("enum-type");$.ajax({url:Form.enumAPI,data:{parentId:item.val(),enumType:enumType},dataType:"json",success:function(data){if("1"==data.code){var options="",lists=JSON.parse(data.enumList);$.each(lists,function(i,n){options+='<option value="'+n.id+'">'+n.enumName+"</option>"}),item.next("select").append($(options))}}})}},Form.transformation=function(html){var div=$("<div>"+html+"</div>");return div.find('.customize-form-body>[class*="form_"]').each(function(i,n){var item=$(n);item.hasClass("form_input")&&item.find("input").attr("value","${dataMap."+item.attr("widget-code")+"}")}),div.html()},Form.getData=function(item){var tmp=[];return item.find('.customize-form-body>[class*="form_"]').each(function(i,n){var item=$(n),cls=item.attr("class"),obj={};switch(cls){case"form_input":if(item.find("input").attr("readonly"))return;var values=[];values.push(item.find("input").val()),obj.value=values,obj.widgetCode=item.attr("widget-code"),tmp.push(obj);break;case"form_radio":var value=item.find("input:radio:checked").val();if("undefined"==typeof value)return;var values=[];values.push(value),obj.value=values,obj.widgetCode=item.attr("widget-code"),tmp.push(obj);break;case"form_select":var value=[];item.find("select").each(function(){value.push($(this).find("option:selected").text())});var values=[];values.push(value.join(" ")),obj.value=values,obj.widgetCode=item.attr("widget-code"),tmp.push(obj)}}),tmp},Form.feedback=function(data){Form.formData=data,sendRequest("submitform",0)},w.Form=Form,Form.lastHTML=null,Form.histories={},Form.templates={},Form.store=function(){Form.uuid&&("undefined"==typeof Form.histories[Form.uuid]&&(Form.histories[Form.uuid]={list:[],item:null}),5==Form.histories[Form.uuid].list.length&&Form.histories[Form.uuid].list.pop(),Form.histories[Form.uuid].list.unshift(Form.lastHTML),Form.histories[Form.uuid].item=Form.item)}}(window,void 0),+function($){function getBasePara(){return{robot_id:"",source:jimiSource||"",session_id:"",event_type:1}}var Scene=function(uuid){return"undefined"!=typeof Scene.HASH[uuid]?Scene.HASH[uuid]:(this.uuid=uuid,this.curForm=null,this.$container=null,void(Scene.HASH[uuid]=this))},basePara=null;triggerLandfill=function(para){var statisticUrl="http://chat-dc.jd.com/sendMsg/send.html",content=$.extend(para.content,basePara||getBasePara());content.user_pin=$.cookie("pin");var img=new Image,src=statisticUrl+"?typeCode="+para.typeCode+"&content="+JSON.stringify(content);img.src=src,img.style.display="none",document.body.appendChild(img)},Scene.prototype.getUUID=function(){return this.uuid},Scene.prototype.setContainer=function($container){this.$container=$container,this.bindEvt()},Scene.prototype.getContainer=function(){return this.$container},Scene.prototype.render=function(){if(null==this.$container)throw new Error("the message container is not define");this.$container.html(""),this.$container.append(this.curForm.getHtml()),this.curForm.setValidateField()},Scene.prototype.setForm=function(tid,version,data){var form=new CustomForm(tid,version,data);null!=this.curForm&&(this.curForm.setNext(form),form.setPrev(this.curForm)),this.curForm=form},Scene.prototype.done=function(){this.curForm.submited()},Scene.prototype.bindEvt=function(){var that=this;this.$container.on("click",".form_button_cancel",function(){that.curForm.canceled()}),this.$container.on("click",".form_button_prev",function(){that.curForm=that.curForm.prev,that.render()}),this.$container.on("click",".form_button_submit",function(){var postData=that.curForm.getPostData();0!=postData&&package("v.componentAnswer").sendAsk(postData)}),this.$container.on("focus",'input[type="text"]',function(){var $this=$(this),secret=$this.data("secret");"undefined"!=typeof secret&&""!==secret&&(1==secret||"true"==secret)&&($this.data("secret",!1),$this.val(""))}),this.$container.on("blur",'input[type="text"]',function(){var $this=$(this),secret=$this.data("secret"),value=$this.val().trim(),secretValue=$this.data("value"),oldValue=$this.data("old");"undefined"!=typeof secret&&""!==secret&&(0==secret||"false"==secret)&&""==value&&secretValue&&oldValue&&($this.data("secret",!0),$this.val(oldValue))}),this.$container.on("click",".J_JimiAskLink,.J_JimiAskBtn",function(evt){var $target=$(evt.currentTarget);if(!$target.hasClass("J_JimiAskBtn")||!$target.hasClass("disabled")){var text=$target.html(),ptag=$target.data("tag"),requestData={requestText:text,ptag:ptag,source:window.jimiSource};$target.hasClass("J_JimiAskBtn")&&$target.parent("span").find("span").addClass("disabled"),showMes("\u6211",requestData.requestText),package("v.componentAnswer").sendAsk(requestData)}}),this.$container.on("click","button.price-notice-btn",function(){var data=that.curForm.data,noticeData=data.dataMap[0],html='<div class="customize-form"><div class="customize-form-head ui-droppable"><span class="form_text">\u964d\u4ef7\u901a\u77e5</span></div><div class="customize-form-body ui-droppable"><div class="form_input"><span class="form_name">\u5f53\u524d\u4ef7\u683c</span><input type="text" readonly="readonly" name="curPrice"></div><div class="form_input"><span class="form_name">\u671f\u671b\u4ef7\u683c</span><input type="text" name="hopePrice"></div><div class="form_input"><span class="form_name">\u624b\u673a\u53f7\u7801</span><input type="text"  name="phone"></div></div><div class="customize-form-button ui-droppable"><button value="\u63d0\u4ea4" class="form_button form_button_submit price_notice_submit">\u63d0\u4ea4</button><button value="\u53d6\u6d88" class="form_button form_button_cancel price_notice_cancel">\u53d6\u6d88</button></div></div>',shellPre='<div class="jimi_lists clearfix"><div class="header_img '+window.jimiHeader+' fl"></div><table class="msg" cellspacing="0" cellpadding="0"><tbody><tr><td class="lt"></td><td class="tt"></td><td class="rt"></td></tr><tr><td class="lm"><span></span></td><td class="mm">',shellPos='</td><td class="rm"></td></tr><tr><td class="lb"></td><td class="bm"></td><td class="rb"></td></tr><tr><td></td></tr></tbody></table>',$answerHtml=$(shellPre+html+shellPos);$("#chatcontent").append($answerHtml),setScroll(),$answerHtml.find('input[name="curPrice"]').val("\uffe5"+noticeData.price),$answerHtml.find('input[name="curPrice"]').data("cur",noticeData.price),$answerHtml.find('input[name="phone"]').val(noticeData.displayPhone),$answerHtml.find('input[name="phone"]').data("display",noticeData.displayPhone),$answerHtml.find('input[name="phone"]').data("secret",noticeData.secretPhone),$answerHtml.on("click","button.price_notice_submit",function(){var postData=that.curForm.getPostData();postData.form=JSON.parse(postData.form);var curPrice=$answerHtml.find('input[name="curPrice"]').data("cur");curPrice=Number(curPrice);var hopePrice=$answerHtml.find('input[name="hopePrice"]').val();hopePrice=Number(hopePrice);var phone=$answerHtml.find('input[name="phone"]').val(),displayPhone=$answerHtml.find('input[name="phone"]').data("display"),secret=$answerHtml.find('input[name="phone"]').data("secret");if(!/^[0-9]+([.]{1}[0-9]+){0,1}$/.test(hopePrice))return $answerHtml.find('input[name="hopePrice"]').val(""),$answerHtml.find('input[name="hopePrice"]').attr("placeholder","\u8bf7\u8f93\u5165\u6b63\u786e\u683c\u5f0f\u7684\u4ef7\u683c"),void $answerHtml.find('input[name="hopePrice"]').addClass("error");if($answerHtml.find('input[name="hopePrice"]').removeClass("error"),hopePrice>curPrice||0>=hopePrice)return $answerHtml.find('input[name="hopePrice"]').val(""),$answerHtml.find('input[name="hopePrice"]').addClass("error"),void $answerHtml.find('input[name="hopePrice"]').attr("placeholder","\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u4ef7\u683c");if($answerHtml.find('input[name="hopePrice"]').removeClass("error"),!/(^1\d{10}$)|(^1\d{2}\*{5}\d{3}$)/.test(phone))return $answerHtml.find('input[name="phone"]').val(""),$answerHtml.find('input[name="phone"]').attr("placeholder","\u8bf7\u8f93\u5165\u6b63\u786e\u683c\u5f0f\u7684\u624b\u673a\u53f7\u7801"),void $answerHtml.find('input[name="phone"]').addClass("error");if($answerHtml.find('input[name="phone"]').removeClass("error"),postData.form.widgets.push({widgetCode:"widget_notify_hope_price",value:[hopePrice]}),displayPhone==phone){var secretData={widgetCode:"widget_notify_phone",value:[secret]},isSecretData={widgetCode:"widget_notify_phone_secret",value:["true"]};postData.form.widgets.push(secretData),postData.form.widgets.push(isSecretData)}else{var secretData={widgetCode:"widget_notify_phone",value:[phone]},isSecretData={widgetCode:"widget_notify_phone_secret",value:["false"]};postData.form.widgets.push(secretData),postData.form.widgets.push(isSecretData)}postData.form=JSON.stringify(postData.form),package("v.componentAnswer").sendAsk(postData);var param={typeCode:"jimi_dc_top_ten_scene_form",content:{message_id:data.msgid,second_class:data.className,model_name:data.modelName,scene_uuid:data.sceneUuid,component_content:2,component_type:data.componentType,component_code:data.templateComponentCode,component_name:data.templateName}};triggerLandfill(param),$(this).closest("div.jimi_lists").remove()});var param={typeCode:"jimi_dc_top_ten_scene_form",content:{message_id:data.msgid,second_class:data.className,model_name:data.modelName,scene_uuid:data.sceneUuid,component_content:3,component_type:data.componentType,component_code:data.templateComponentCode,component_name:data.templateName}};triggerLandfill(param),$answerHtml.on("click","button.price_notice_cancel",function(){$(this).closest("div.jimi_lists").remove()})}),this.$container.on("click",".J_ApplyRepair",function(){var data=that.curForm.data,param={typeCode:"jimi_dc_top_ten_scene_form",content:{message_id:data.msgid,second_class:data.className,model_name:data.modelName,scene_uuid:data.sceneUuid,component_type:data.componentType,component_code:data.templateComponentCode,component_name:data.templateName}};triggerLandfill(param)}),this.$container.on("click",".J_WeReminOrderBtn",function(){var data=that.curForm.data,param={typeCode:"jimi_dc_top_ten_scene_form",content:{message_id:data.msgid,second_class:data.className,model_name:data.modelName,scene_uuid:data.sceneUuid,component_type:data.componentType,component_code:data.templateComponentCode,component_name:data.templateName,component_content:0}};triggerLandfill(param)}),this.$container.on("click",".imJumpFlag",function(){var data=that.curForm.data,param={typeCode:"jimi_dc_top_ten_scene_form",content:{message_id:data.msgid,second_class:data.className,model_name:data.modelName,scene_uuid:data.sceneUuid,component_type:data.componentType,component_code:data.templateComponentCode,component_name:data.templateName,component_content:1}};triggerLandfill(param)}),this.$container.on("click",".J_WeReminOrderBtn",function(){var data=that.curForm.data;data.dataMap[0];if(!$('.customize-form[data-key="'+data.sceneUuid+'"]').length){var html='<div class="customize-form" data-key="'+data.sceneUuid+'"><div class="customize-form-head ui-droppable"><span class="form_text">\u6211\u8981\u50ac\u5355</span></div><div class="customize-form-body ui-droppable"><div class="form_input J_ReType"><span class="form_name">\u56de\u590d\u65b9\u5f0f</span><p class="p-tab-con"><span class="mtype on" data-val="1">\u77ed\u4fe1\u56de\u590d</span><span class="mtype" data-val="2">\u7535\u8bdd\u56de\u590d</span></p><p class="tips">\u4ec5\u652f\u6301\u624b\u673a\u53f7\u7801</p></div><div class="form_input"><span class="form_name">\u624b\u673a\u53f7\u7801</span><input type="text" maxlength="11" name="phone" placeholder="\u8bf7\u8f93\u5165\u624b\u673a\u53f7\u7801" ></div><div class="form_input"><span class="form_name">\u7559\u8a00\u4fe1\u606f</span><textarea rows="5" cols="50"  name="message" placeholder="\u8bf7\u8f93\u5165\u7559\u8a00\u3001\u6211\u4eec\u4f1a\u5c3d\u5feb\u4e3a\u4f60\u5904\u7406..." ></textarea></div></div><div class="customize-form-button ui-droppable"><button value="\u63d0\u4ea4" class="form_button form_button_submit J_RemindSubmit">\u63d0\u4ea4</button><button value="\u53d6\u6d88" class="form_button form_button_cancel J_RemindCancel">\u53d6\u6d88</button></div></div>',shellPre='<div class="jimi_lists clearfix"><div class="header_img '+window.jimiHeader+' fl"></div><table class="msg" cellspacing="0" cellpadding="0"><tbody><tr><td class="lt"></td><td class="tt"></td><td class="rt"></td></tr><tr><td class="lm"><span></span></td><td class="mm">',shellPos='</td><td class="rm"></td></tr><tr><td class="lb"></td><td class="bm"></td><td class="rb"></td></tr><tr><td></td></tr></tbody></table>',$answerHtml=$(shellPre+html+shellPos);$("#chatcontent").append($answerHtml),setScroll(),$answerHtml.on("click",".mtype",function(){var $mtype=$(this);$mtype.hasClass("on")||($mtype.addClass("on"),$mtype.siblings(".mtype").removeClass("on"))}),$answerHtml.on("click","button.J_RemindSubmit",function(){var postData=that.curForm.getPostData();postData.form=JSON.parse(postData.form);var reType=$answerHtml.find(".J_ReType span.on").attr("data-val")||"",mes=$answerHtml.find('textarea[name="message"]').val()||"",phone=$answerHtml.find('input[name="phone"]').val()||"";return/(^1\d{10}$)|(^1\d{2}\*{5}\d{3}$)/.test(phone)?($answerHtml.find('input[name="phone"]').removeClass("error"),mes?($answerHtml.find('textarea[name="message"]').removeClass("error"),postData.form.widgets=[{widgetCode:"widget_reminder_mobile",value:[phone]},{widgetCode:"widget_reminder_type",value:[reType]},{widgetCode:"widget_reminder_content",value:[mes]}],postData.form=JSON.stringify(postData.form),package("v.componentAnswer").sendAsk(postData),void $(this).closest("div.jimi_lists").remove()):($answerHtml.find('textarea[name="message"]').attr("placeholder","\u8bf7\u8f93\u5165\u7559\u8a00\u3001\u6211\u4eec\u4f1a\u5c3d\u5feb\u4e3a\u4f60\u5904\u7406..."),$answerHtml.find('textarea[name="message"]').addClass("error"),!1)):($answerHtml.find('input[name="phone"]').val(""),$answerHtml.find('input[name="phone"]').attr("placeholder","\u8bf7\u8f93\u5165\u6b63\u786e\u683c\u5f0f\u7684\u624b\u673a\u53f7\u7801"),$answerHtml.find('input[name="phone"]').addClass("error"),!1)});var param={typeCode:"jimi_dc_top_ten_scene_form",content:{message_id:data.msgid,second_class:data.className,model_name:data.modelName,scene_uuid:data.sceneUuid,component_type:data.componentType,component_code:data.templateComponentCode,component_name:data.templateName}};triggerLandfill(param),$answerHtml.on("click","button.J_RemindCancel",function(){$(this).closest("div.jimi_lists").remove()})}}),this.$container.on("click",".J_ViewProduct li",function(){var data=that.curForm.data,postData={form:{className:data.className,modelName:data.modelName,formCode:data.templateComponentCode,sceneUuid:data.sceneUuid,widgets:[]}};postData.form.widgets=[{widgetCode:"widget_ware_id",value:[$(this).attr("pid")]}],postData.form=JSON.stringify(postData.form),postData.requestText="form submit",postData.source=window.jimiSource,package("v.componentAnswer").sendAsk(postData);var param={typeCode:"jimi_dc_top_ten_scene_form",content:{message_id:data.msgid,second_class:data.className,model_name:data.modelName,scene_uuid:data.sceneUuid,component_type:data.componentType,component_code:data.templateComponentCode,component_name:data.templateName}};triggerLandfill(param)}),this.$container.on("click",".J_Coupon li",function(){var $dom=$(this);if($dom.hasClass("off"))return!1;var cid=$dom.attr("data-id"),data=that.curForm.data,postData={form:{className:data.className,modelName:data.modelName,formCode:data.templateComponentCode,sceneUuid:data.sceneUuid,widgets:[cid]}};postData.form.widgets=[{widgetCode:"widget_coupon_rule_id",value:[$dom.attr("data-id")]},{widgetCode:"widget_coupon_key",value:[$dom.attr("data-key")]}],postData.form=JSON.stringify(postData.form),postData.requestText="form submit",postData.source=window.jimiSource,package("v.componentAnswer").sendAsk(postData,function(data){if(1==data.crmSync){$dom.addClass("off");var $p=$dom.parent(".J_Coupon"),val=$p.attr("data-off")||"";val=val+cid+",",$(".J_Coupon").attr("data-off",val),$('.J_Coupon li[data-id="'+cid+'"]').addClass("off")}});var param={typeCode:"jimi_dc_top_ten_scene_form",content:{message_id:data.msgid,second_class:data.className,model_name:data.modelName,scene_uuid:data.sceneUuid,component_type:data.componentType,component_code:data.templateComponentCode,component_name:data.templateName}};triggerLandfill(param)}),this.$container.on("click",".change-btn",function(){var data=that.curForm.data,clickType="";clickType="\u7406\u8d22\u5217\u8868"==data.templateName?"lc_change":"\u57fa\u91d1\u5217\u8868"==data.templateName?"jj_change":"";var param={typeCode:"answer_ask_type",content:{message_id:data.msgid,interactive_id:data.sceneUuid,click_type:clickType,ask_time:"$currentTime",refer:encodeURIComponent(location.href),code:""}};triggerLandfill(param)}),this.$container.on("click",".btn-buy",function(){var data=that.curForm.data,clickType="";clickType="\u7406\u8d22\u5217\u8868"==data.templateName?"lc_buy":"\u57fa\u91d1\u5217\u8868"==data.templateName?"jj_buy":"";var param={typeCode:"answer_ask_type",content:{message_id:data.msgid,interactive_id:data.sceneUuid,click_type:clickType,ask_time:"$currentTime",refer:encodeURIComponent(location.href),code:""}};triggerLandfill(param)}),this.$container.on("click",".repayment",function(){var data=that.curForm.data,item=$(this),clickType="";clickType="\u767d\u6761\u8d26\u5355\u660e\u7ec6"==data.templateName?"\u5206\u671f"==item.text()?"bt_repayback":"bt_payback":"jt_payback";var param={typeCode:"answer_ask_type",content:{message_id:data.msgid,interactive_id:data.sceneUuid,click_type:clickType,ask_time:"$currentTime",refer:encodeURIComponent(location.href),code:""}};triggerLandfill(param)}),this.$container.on("click",".pay-now, .jtRepayNow",function(){var data=that.curForm.data,clickType="\u91d1\u6761\u5f85\u8fd8\u6b3e\u8d26\u5355"==data.templateName?"jt_now":"bt_imme_repayment",param={typeCode:"answer_ask_type",content:{message_id:data.msgid,interactive_id:data.sceneUuid,click_type:clickType,ask_time:"$currentTime",refer:encodeURIComponent(location.href),code:""}};triggerLandfill(param)})},$("#chatcontent").on("click",".w_ql .w_q_text",function(e){$(this).parent().siblings().length>1&&($(this).parent().find("ul").toggle(),$.each($(this).parent().siblings("li"),function(i,v){$(v).find("ul").hide()}),$.each($(this).parent().parent().siblings("li"),function(i,v){$(v).find("ul").hide()}),$.each($(this).parent().siblings(".wq_more_list").find("li"),function(i,v){$(v).find("ul").hide()}))}),$("#chatcontent").on("click",".w_ql .w_q_tri",function(e){$(this).parent().siblings().length>1&&($(this).parent().find("ul").toggle(),$.each($(this).parent().siblings("li"),function(i,v){$(v).find("ul").hide()}),$.each($(this).parent().parent().siblings("li"),function(i,v){$(v).find("ul").hide()}),$.each($(this).parent().siblings(".wq_more_list").find("li"),function(i,v){$(v).find("ul").hide()}))}),$("#chatcontent").on("click",".w_see_more",function(e){$(".wq_more_list").length>0&&($(".wq_more_list").fadeToggle("fast"),$(".w_see_more_tri").toggleClass("show_or_hide_more_tri"),$(".w_see_more_tri").hasClass("show_or_hide_more_tri")?$(this).find("span").eq(0).text("\u6536\u8d77\u5217\u8868"):$(this).find("span").eq(0).text("\u70b9\u51fb\u67e5\u770b\u66f4\u591a"))}),Scene.HASH={},Scene.destroy=function(uuid){"undefined"!=typeof Scene.HASH[uuid]&&(Scene.HASH[uuid]=void 0)};var CustomForm=function(tid,version,data){this.tid=tid.replace(/_{2}\d+$/,""),this.version=version,this.data=data,this.prev=null,this.next=null,this.$html=null,this.initTemplate()};CustomForm.prototype.initTemplate=function(){var that=this;$.ajax({url:"/template/getTemplate.action",dataType:"text",data:{componentCode:that.tid,version:that.version,source:window.jimiSource},async:!1}).done(function(result){if(result=JSON.parse(result.replace(/\t/g,"")),1==result.code){var html=result.template&&result.template.componentHtml,$html=$("<div>"+html+"</div>");$html.find('.customize-form-body>[class*="form_"]').each(function(i,n){var $item=$(n);$item.hasClass("form_input")&&($item.find("input").attr("value","${dataMap."+$item.attr("widget-code")+".displayValue}"),$item.find("input").attr("data-secret","${dataMap."+$item.attr("widget-code")+".isSecret}"),$item.find("input").attr("data-value","{{if dataMap."+$item.attr("widget-code")+".secretValue}}${dataMap."+$item.attr("widget-code")+'.secretValue}{{else}}""{{/if}}'),$item.find("input").attr("data-old","${dataMap."+$item.attr("widget-code")+".displayValue}"))}),that.data.dataMap="string"==typeof that.data.dataMap&&that.data.dataMap.constructor==String?JSON.parse(that.data.dataMap):that.data.dataMap,html=$html.html().replace(/\&nbsp;/g,"").replace(/\&gt;/g,">").replace(/\&lt;/g,"<"),$.template("template",unescape(html)),$html=$("<div></div>").append($.tmpl("template",that.data)),that.$html=$html,that.bindSelectEvt()}})},CustomForm.prototype.setNext=function(next){return this.next=next,this},CustomForm.prototype.getNext=function(){return this.next},CustomForm.prototype.setPrev=function(prev){this.prev=prev;var preStepBtn='<button class="form_button form_button_prev">\u4e0a\u4e00\u6b65</button>',btnHtml=this.$html.find(".customize-form-button").html();return btnHtml=preStepBtn+btnHtml,this.$html.find(".customize-form-button").html(btnHtml),this},CustomForm.prototype.setValidateField=function(){var validateField='<span class="error-msg"></span>',btnHtml=this.$html.find(".customize-form-button").html();this.$html.find(".customize-form-button").html(validateField+btnHtml)},CustomForm.prototype.getPrev=function(){return this.prev},CustomForm.prototype.getHtml=function(){return this.$html},CustomForm.prototype.getPostData=function(){for(var data=this.data,postData={form:{className:data.className,modelName:data.modelName,formCode:data.templateComponentCode,sceneUuid:data.sceneUuid,widgets:[]},source:window.jimiSource},$widgetsContainer=this.$html.find("div[widget-code]"),i=0,len=$widgetsContainer.length;len>i;i++){var $item=$($widgetsContainer[i]),inputObj={};if(inputObj.widgetCode=$item.attr("widget-code"),inputObj.value=[],$item.find('input[type="text"]').length>0){var $input=$item.find('input[type="text"]'),secret=$input.data("secret"),curValue={};if("true"==secret||1==secret)curValue.isSecret=!0,curValue.displayValue=$input.data("old"),curValue.secretValue=$input.data("value");else{if(!this.validate($input))return!1;curValue.isSecret=!1,curValue.displayValue=$input.val()}inputObj.value.push(curValue)}else if($item.find('input[type="radio"]').length>0){var $radios=$item.find('input[type="radio"]');$radios.each(function(_,i){var $radio=$(i);$radio.is(":checked")&&inputObj.value.push($radio.val())})}else if($item.find("select").length>0){var $selects=$item.find("select"),value=[];$selects.each(function(_,i){var $select=$(i),selectValue=$select.find("option:selected").html();"--\u8bf7\u9009\u62e9--"!=selectValue&&value.push(selectValue)}),inputObj.value.push(value.join(","))}else if($item.find('input[type="checkbox"]').length>0){var $checkboxes=$item.find('input[type="checkbox"]'),value=[];$checkboxes.each(function(_,i){var $checkbox=$(i);$checkbox.is(":checked")&&value.push($checkbox.val())}),inputObj.value.push(value.join(","))}postData.form.widgets.push(inputObj)}return postData.form=JSON.stringify(postData.form),postData.requestText="form submit",postData.source=window.jimiSource,postData},CustomForm.prototype.validate=function($ele){var textValue=$ele.val();if(/^\s*$/.test(textValue)){$ele.addClass("error");var name=$ele.closest(".form_input").find(".form_name").html();return this.$html.find(".customize-form-button .error-msg").html(name+"\u5fc5\u586b"),!1}if($ele.removeClass("error"),this.$html.find(".customize-form-button .error-msg").html(""),"undefined"!=typeof $ele.attr("validate")){var validateName=$ele.attr("validate"),val=$ele.val();("num"===validateName||"drop-down-numeral"===validateName)&&(val=val.replace(/,\s*/g,""));var regexObj=CustomForm.REGEX[validateName];if("undefined"!=typeof regexObj){var regex=regexObj.regex;if(!regex.test(val))return $ele.addClass("error"),this.$html.find(".customize-form-button .error-msg").html(regexObj.msg),!1;$ele.removeClass("error"),this.$html.find(".customize-form-button .error-msg").html("")}}return!0},CustomForm.prototype.canceled=function(){var $html=this.$html;$html.find('input[type="text"]').addClass("disabled"),$html.find("input").attr("disabled","true"),$html.find("select").attr("disabled","true"),$html.find(".form_button_prev").remove(),$html.find(".form_button_submit").remove(),$html.find(".form_button_cancel").addClass("disabled"),$html.find(".form_button_cancel").html("\u5df2\u53d6\u6d88")},CustomForm.prototype.bindSelectEvt=function(){this.$html.find(".form_select").each(function(index,item){var $formSelect=$(item);if(!($formSelect.find("select").length<=1)){var enumType=$formSelect.attr("enum-type");$formSelect.on("change","select:not(:last)",function(){var $curItem=$(this),value=$curItem.find("option:selected").val();if("undefined"!=typeof value&&""!=value&&null!=value)$.ajax({url:"/template/getComponentEnum.action",type:"GET",dataType:"JSON",data:{parentId:value,enumType:enumType}}).done(function(result){if(1==result.code){var list;list="string"==typeof result.enumList?JSON.parse(result.enumList):result.enumList;for(var option='<option value="">--\u8bf7\u9009\u62e9--</option>',i=0,len=list.length;len>i;i++){
var l=list[i];option+='<option value="'+l.id+'">'+l.enumName+"</option>"}var $next=$curItem.next("select");for($next.html(option);;){if($next=$next.next("select"),0==$next.length)break;$next.html("<option>--\u8bf7\u9009\u62e9--</option>")}}});else for(var $next=$curItem;;){if($next=$next.next("select"),0==$next.length)break;$next.html("<option>--\u8bf7\u9009\u62e9--</option>")}})}})},CustomForm.prototype.submited=function(){var $html=this.$html;$html.find('input[type="text"]').addClass("disabled"),$html.find("input").attr("disabled","true"),$html.find("select").attr("disabled","true"),$html.find(".form_button_cancel").hide(),$html.find(".form_button_prev").hide(),$html.find(".form_button_submit").addClass("disabled"),$html.find(".form_button_submit").html("\u5df2\u63d0\u4ea4"),$html.find(".form_button_submit").attr("disabled","true")},CustomForm.REGEX={num:{regex:/^[1-9]\d*(\.\d+)?$/,msg:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u6570\u5b57\u683c\u5f0f"},"drop-down-numeral":{regex:/^[1-9]\d*(\.\d+)?$/,msg:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u6570\u5b57\u683c\u5f0f"},mail:{regex:/^[a-z0-9]+([._\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$/,msg:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u90ae\u4ef6\u683c\u5f0f"},"drop-down-mail":{regex:/^[a-z0-9]+([._\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$/,msg:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u90ae\u4ef6\u683c\u5f0f"},date:{regex:/^\d{4}[.\/-]\d{1,2}[.\/-]\d{1,2}(\s+\d{1,2}:\d{1,2}:\d{1,2})?$/,msg:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u65e5\u671f\u683c\u5f0f"},"drop-down-date":{regex:/^\d{4}[.\/-]\d{1,2}[.\/-]\d{1,2}(\s+\d{1,2}:\d{1,2}:\d{1,2})?$/,msg:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u65e5\u671f\u683c\u5f0f"},phonenum:{regex:/^1[34578]\d{9}$/,msg:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7\u7801\u683c\u5f0f"},"drop-down-phone":{regex:/^1[34578]\d{9}$/,msg:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7\u7801\u683c\u5f0f"}},window.Scence=Scene,window.CustomForm=CustomForm}(jQuery),package("v.socket",[],function(require,exports,moudle){function support(){return!!window.WebSocket}function start(aid){if(!support())throw new Error("this browser dose not support WebSocket!");if(!window.socketObject){try{var pin=$.cookie("pin"),_robotAccess_=$.cookie("_robotAccess_"),clientType="web",wsDomain=window.wsDomain,protocol=location.protocol;"http:"===protocol?wsDomain="ws://"+wsDomain:"https:"==protocol&&(wsDomain="wss://"+wsDomain),socket=new WebSocket(wsDomain+"?pin="+pin+"&robotAccess="+_robotAccess_+"&clientType="+clientType+"&aid="+aid),socket.onopen=onOpen,socket.onclose=onClose,socket.onmessage=onMessage,socket.onerror=onError,window.socketObject=socket}catch(e){return!1}return!0}socket=window.socketObject}function onOpen(){heartbeatTimer&&clearInterval(heartbeatTimer),heartbeatTimer=setInterval(function(){var pack={clientType:"web",pin:$.cookie("pin"),robotAccess:$.cookie("_robotAccess_"),type:"HeartBeat"};pack=JSON.stringify(pack),socket.send(pack)},1e4)}function voluntary(){var pack={clientType:"web",pin:$.cookie("pin"),robotAccess:$.cookie("_robotAccess_"),type:"ActivePush",data:{source:window.jimiSource}};pack=JSON.stringify(pack),socket.send(pack)}function onClose(){heartbeatTimer&&clearInterval(heartbeatTimer),delete window.socketObject}function onMessage(event){var data=event.data;if("string"==typeof data&&(data=JSON.parse(data)),"ACK"!=data.type&&(data=data.data,"string"==typeof data&&(data=JSON.parse(data)),data.answers)){var answer=data.answers.answer;answer&&(answer=AnswerFactory.createAnswer(data),answer.show($("#chatcontent"),!0,!0),setScroll())}}function onError(){delete window.socketObject}function close(){socket.close()}var socket,heartbeatTimer;return exports.start=start,exports.close=close,exports.support=support,exports.voluntary=voluntary,exports});