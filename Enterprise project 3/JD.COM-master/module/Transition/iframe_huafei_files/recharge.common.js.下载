/* virtuals-chongzhi recharge.common.js Date:2016-02-18 13:48:10 */
~function(a){"use strict";a.Recharge={};var b={addBook:'<div class="phone-book"><div class="thickbox"><div class="thickwrap"><div class="thicktitle">\u7535\u8bdd\u8584</div><div class="thickcon"><div class="search"><input data-place="\u5728\u6211\u7684\u8054\u7cfb\u4eba\u4e2d\u641c\u7d22" class="text keyword" value="\u5728\u6211\u7684\u8054\u7cfb\u4eba\u4e2d\u641c\u7d22"></div><div class="tab"><ul class="title"><li data-title="recently">\u6700\u8fd1\u5145\u503c</li><li data-title="addressList" class="curr">\u6211\u7684\u8054\u7cfb\u4eba\uff08<span class="cnum">0</span>\uff09</li></ul><div class="tab-con"><ul class="tab-booklist recently" style="display:none"></ul><ul class="tab-booklist addressList"></ul><p class="msg mlist hide">\u60a8\u7684\u7535\u8bdd\u8584\u91cc\u6682\u65e0\u8054\u7cfb\u4eba</p></div><div class="sure-sub"><input type="button" value="\u786e\u8ba4" class="btn"><a href="javascript:;" class="add">+\u6dfb\u52a0\u8054\u7cfb\u4eba</a></div></div></div><a href="javascript:;" class="thickclose">\xd7</a></div></div></div>',conRow:'<li><a class="del" href="javascript:;">\u5220\u9664</a><input class="sels" type="checkbox"><div class="name"><input value="\u59d3\u540d" class="name-txt" maxlength="6" data-place="\u59d3\u540d"><span title="\u53cc\u51fb\u53ef\u7f16\u8f91" class="na"></span></div><div class="number"><input value="\u624b\u673a\u53f7\u7801" class="number-txt" maxlength="11" data-place="\u624b\u673a\u53f7\u7801"><span title="\u53cc\u51fb\u53ef\u7f16\u8f91" class="nu"></span></div><div class="msg"></div><div style="clear:both;"></div></li>',manyli:'<li class="clearfix addLi"><div class="fore1"><div class="o-name-con"><span class="oname"></span></div><div class="fmv many-tishi"><p class="number"><input maxlength="11" skuid="" type="text" value="\u8bf7\u8f93\u5165\u624b\u673a\u53f7" class="num gray"/><span title="\u53cc\u51fb\u53ef\u7f16\u8f91" class="num-txt"></span></p><p class="tishi hide">\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7</p></div><span class="address"></span></div><div class="fore2"><div class="fmv"><span class="money" style="display:none"></span><select class="skuId"><option>100\u5143</option><option>10\u5143</option><option>20\u5143</option><option>30\u5143</option><option>50\u5143</option><option>200\u5143</option><option>300\u5143</option><option>500\u5143</option></select></div></div><div class="fore3"><b class="price">--</b></div><div class="fore4"><a href="javascript:;" class="delete">\u5220\u9664</a></div></li>',recRow:'<li><a href="javascript:;" title="\u6dfb\u52a0\u5230\u6211\u7684\u8054\u7cfb\u4eba" class="add-person">+</a><input class="sels" type="checkbox" class="checked"/><span class="name"></span><span class="number"></span></li>'};a.Recharge.template=b}(jQuery),~function(a){function b(b,c){a.getJSON("//passport.jd.com/loginservice.aspx?method=Login&callback=?",function(a){var d=a.Identity.IsAuthenticated;d?b(a):c(a)})}function c(b){jdModelCallCenter.settings={clstag1:"login|keycount|5|5",clstag2:"login|keycount|5|6",fn:function(){void 0==b&&(b=location.href),jdModelCallCenter.autoLocation(b);var c=a("#loginbar"),d=c.find(".link-logout");d.length&&d.attr("href","//passport.jd.com/uc/login?ltype=logout&returnUrl=//tuan.jd.com")}},jdModelCallCenter.login()}function d(b){var c='[name="'+b+'"]:checked';return a(c).val()}function e(b,c){var d="/json/order/search_searchPhone.action",e={mobile:b};a.ajax(d,{data:e,async:!1,dataType:"json",cache:!1,success:function(a){c&&c(a)}})}function f(b,c){var d="/json/order/search_searchHidPrice.action",e={hidParamStr:b};b&&a.ajax(d,{data:e,async:!1,cache:!1,dataType:"json",success:function(a){c&&c(a)}})}function g(b,c){var d="/json/order/search_searchSkuId.action";a.ajax(d,{data:b,async:!1,cache:!1,dataType:"json",success:function(a){c&&c(a)}})}var h=a.Recharge;h.defaultPrice={50:"7.5-10\u5143",100:"9.95-20\u5143",200:"19.9-20.5\u5143",300:"29-29.9\u5143",500:"49-50\u5143"},h.priceRangeObj={10:"9.80-11.00\u5143",20:"19.60-21.00\u5143",30:"29.40-31.00\u5143",50:"49.00-50.00\u5143",100:"98.00-100.00\u5143",200:"196.00-200.00\u5143",300:"294.00\uff0d300.00\u5143",500:"490.00\uff0d500.00\u5143"},h.priceManRangeObj={10:"10.00\u5143",20:"20.00\u5143",30:"29.61-30.00\u5143",50:"\u4f4e\u81f39.6\u6298\uff01",100:"\u4f4e\u81f39.6\u6298\uff01",200:"197.00-199.00\u5143",300:"\u4f4e\u81f39.6\u6298\uff01",500:"\u4f4e\u81f39.6\u6298\uff01"},h.priceTwManRangeObj={10:"10.00\u5143",20:"20.00\u5143",30:"\u4f4e\u81f39.75\u6298\uff01",50:"\u4f4e\u81f39.75\u6298\uff01",100:"\u4f4e\u81f39.75\u6298\uff01",200:"\u4f4e\u81f39.75\u6298\uff01",300:"\u4f4e\u81f39.75\u6298\uff01",500:"\u4f4e\u81f39.75\u6298\uff01"},h.flowRecharge=function(){return{datasrc:{},loadIspArea:function(b,c){var d="//liuliang.jd.com/ajax/search_searchPhone.action";a.get(d,{mobile:b},function(a){c&&c(a)})},loadIspAreaJsonP:function(b,c){var d="//liuliang.jd.com/ajax/search_searchPhoneJsonP.action?callback=?";a.getJSON(d,{mobile:b},function(a){c&&c(a)})},loadSku:function(b,c,d){var e="//liuliang.jd.com/ajax/search_searchSku.action";a.get(e,{areaCode:b,mutCode:c},function(a){d&&d(a)})},loadSkuJsonP:function(b,c,d){var e="//liuliang.jd.com/ajax/search_searchSkuJsonP.action?callback=?";a.getJSON(e,{areaCode:b,mutCode:c},function(a){d&&d(a)})},submitOrder:function(a){var b=a.skuId,c=a.mobile;if(a.faceAmount,a.areaUsed,a.source)var d="//liuliang.jd.com/order/order_place.action?source="+a.source+"&skuId="+b+"&mobile="+c+"&t="+(new Date).getTime();else var d="//liuliang.jd.com/order/order_place.action?skuId="+b+"&mobile="+c+"&t="+(new Date).getTime();window.open(d)}}}(),h.isLogin=b,h.login=c,h.loadSkuData=g,h.loadIspArea=e,h.loadHiddenPrice=f,h.getRadioVal=d}($),~function(a){"use strict";function b(a){return a===+a}a.Recharge;var c=/^1\d{10}$/;a.fn.placeHolder=function(){this.each(function(){var b=a(this),c=b.val();b.focus(function(){b.val()===c&&b.val(""),b.css("color","#333")}).blur(function(){""===b.val()&&b.val(c).css("color","#999")})})},a.addBook=function(d,e){function f(b,c,d){a.ajax({type:"POST",dataType:"json",url:b,data:c,success:d})}function g(b){var c="/json/order/phoneBook_queryContactList.action",d={flag:b};f(c,d,function(b){if(b.status){var c=b.contactsInfo;c.length?(a.each(c,function(b,c){var d=a(C),e=c.name,f=c.phoneNo,g=c.contactId;d.find(".name-txt").val(e).hide(),d.find(".na").text(e).show(),d.find(".number-txt").val(f).hide(),d.find(".nu").text(f).show(),d.attr({cid:g,num:f,na:e}),d.appendTo(E)}),D.text(c.length)):(E.height(50),G.text("\u60a8\u7684\u901a\u8baf\u5f55\u91cc\u6682\u65e0\u8054\u7cfb\u4eba").show())}})}function h(b,c){var d=a(C);return d.find("[data-place]").placeHolder(),E.append(d),E.scrollTop(1e3),b&&d.find(".name-txt").val(b),c&&d.find(".number-txt").val(c),H=!1,d}function i(a){var b=a.find(".name-txt"),d=a.find(".number-txt"),e=a.find(".msg"),f=b.val(),g=d.val();if(""===f||"\u59d3\u540d"===f)return e.text("\u59d3\u540d\u4e0d\u80fd\u4e3a\u7a7a").show(),b[0].focus(),H=!1;if(""===g||"\u624b\u673a\u53f7\u7801"===g)return e.text("\u624b\u673a\u53f7\u7801\u4e0d\u80fd\u4e3a\u7a7a").show(),d[0].focus(),H=!1;if(!c.test(g))return e.text("\u624b\u673a\u53f7\u7801\u4e0d\u6b63\u786e").show(),d[0].focus(),H=!1;e.hide();var h=b.next(),i=d.next();return h.text(f).show(),i.text(g).show(),b.hide(),d.hide(),H=!0}function j(c){b(c);var d=E.find("li"),e=RegExp(c);d.hide(),d.each(function(){var b=a(this),c=b.find(".na").text();e.test(c)&&b.show()}),d.each(function(){var b=a(this),c=b.find(".nu").text();e.test(c)&&b.show()})}function k(b){var c=b.target;a.contains(B[0],c)||B.remove()}function l(a,b,c){var d="/json/order/phoneBook_addContact.action",e={name:a,phoneNo:b};f(d,e,function(d){if(d.status){H=!0;var e=d.contactsInfo[0];c.attr("na",a),c.attr("num",b),c.attr("cid",e.contactId);var f=D.text()-0+1;D.text(f)}else H=!1,c.find(".name-txt").show(),c.find(".na").hide(),c.find(".number-txt").show(),c.find(".nu").hide(),alert(d.resultMsg)})}function m(a,b){var c=b.phoneNo,d=b.name,e="/json/order/phoneBook_updateContact.action";f(e,b,function(b){if(b.status)c&&a.attr("num",c),d&&a.attr("na",d);else{alert(b.resultMsg);var e=a.attr("num");a.find(".number-txt").val(e).show(),a.find(".nu").hide()}})}function n(a,b){if(a){var c="/json/order/phoneBook_delContact.action",d={contactId:a,phoneNo:b.find(".number-txt").val()};f(c,d,function(a){if(a.status){var c=parseInt(D.text(),10);c>0&&D.text(c-1),b.remove()}else alert("\u5220\u9664\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5")})}else b.remove(),H=!0}function o(){var a=w.offset(),b=a.top+u,c=a.left+v;B.css({top:b,left:c})}function p(a){var b=a.find(".name-txt").val(),c=a.find(".number-txt").val(),d=a.attr("na"),e=a.attr("num"),f=a.attr("cid"),g={contactId:f};f?(d!==b?g.name=b:e!==c&&(g.phoneNo=c),(d!==b||e!==c)&&m(a,g)):l(b,c,a)}function q(b){var c=!1;return E.find(".number-txt").each(function(){var d=a(this);return d.val()==b?c=!0:void 0}),c}var r=a(".phone-book");if(!r.length){var s=d.forOne||!1;d.dataUrl||"";var t=d.elTrigger,u=d.diffTop||0,v=d.diffLeft||0,e=e||function(){},w=a(t),x=w.offset(),y=x.top+u,z=x.left+v,A=a.Recharge.template,B=a(A.addBook);B.css({top:y,left:z}).appendTo(document.body);var C=A.conRow;A.recRow;var D=B.find(".cnum"),E=B.find(".addressList"),F=B.find(".recently"),G=B.find(".mlist"),H=!0,I="address";B.delegate(".thickclose","click",function(){B.remove()}).delegate(".keyword","keyup",function(){var b=a(this).val();"address"!==I&&B.find("li[data-title=addressList]").click(),j(b)}).delegate(".title li","click",function(){var b=a(this),c=b.attr("data-title");B.find(".title li").removeClass("curr"),b.addClass("curr"),B.find(".tab-booklist").hide(),B.find("."+c).show();var d=B.find(".add");"recently"===c?(d.hide(),I="recently"):(d.show(),I="address")}).delegate(".add","click",function(){if(B.find(".mlist").hide(),H)h();else{var a=E.find("li:last");a.find(".name-txt")[0].focus()}}).delegate(".sure-sub .btn","click",function(){var b="address"===I,c=b?E:F,d=c.find("[type=checkbox]:checked").map(function(){var c=a(this).closest("li"),d=b?c.find(".na").text():c.find(".name").text(),e=b?c.find(".nu").text():c.find(".number").text();return{name:d,mobile:e}});e(d),B.remove()}).delegate(".add-person","click",function(){var b=a(this).closest("li"),c=b.find(".number"),d=c.text();if(q(d))alert("\u8054\u7cfb\u4eba\u4e2d\u5df2\u5b58\u5728\u8be5\u53f7\u7801");else{B.find("[data-title=addressList]").click();var e=h("",d),f=e.find(".number-txt"),g=f.val();f[0].focus(),f.val(""),f.val(g)}}).delegate(".sels","click",function(){var b=a(this),c=b.closest(".tab-booklist"),d=b.prop("checked");s&&d?(c.find(".sels").prop("disabled","disabled"),b.removeProp("disabled")):c.find(".sels").removeProp("disabled")}),E.delegate(".name-txt","blur",function(){var b=a(this).closest("li"),c=i(b);c&&p(b)}).delegate(".number-txt","blur",function(){var b=a(this).closest("li"),c=i(b);c&&p(b)}).delegate(".number-txt","keyup",function(){var b=a(this).closest("li"),d=b.find(".number-txt"),e=b.find(".msg"),f=d.val();return c.test(f)?void 0:(d.val(f.replace(/\D/g,"")),e.text("\u624b\u673a\u53f7\u7801\u4e0d\u6b63\u786e").show(),d[0].focus(),H=!1)}).delegate(".name span, .number span","dblclick",function(){var b=a(this),c=b.prev(),d=c.val();c.show(),b.hide(),c[0].focus(),c.val(""),c.val(d)}).delegate(".del","click",function(b){b.stopPropagation();var c=a(this).closest("li"),d=c.attr("cid");n(d,c)}),g(1),B.find("[data-place]").placeHolder(),a(document).unbind("click",k).bind("click",k),a(window).unbind("resize",o).bind("resize",o),window.top!==window&&a(window.top.document).unbind("click",k).bind("click",k)}}}(jQuery),~function(a){"use strict";function b(b,c){c=c||"default";var d=a(b);d.focus(function(){d.val()===c&&d.val("").css("color","#000")}).blur(function(){""===d.val()&&d.val(c).css("color","#999")})}a.Recharge.placeHolder=b,a("#sms").click(function(){var b=a(this).prop("checked"),c=a("#selectZhiBianWord");b?c.show():c.hide()}),b("#inputSendName","\u9009\u586b"),b("#inputMessageArea","\u8bf7\u8f93\u5165\u4f60\u60f3\u5bf9TA\u8bf4\u7684\u8bdd\uff08\u5145\u503c\u6210\u529f\u540e\u4f1a\u77ed\u4fe1\u53d1\u81f3\u5145\u503c\u624b\u673a\uff09\uff0c\u6700\u591a34\u5b57\u54e6"),a(".preview").mouseover(function(){var b=a("#inputSendName").val(),c=a("#inputMessageArea").val(),d=a("#defaultInputMessage").val(),e=a("#inputMessageArea").val(),f=a("[name=radiobutton]:checked").val();if(null!=b&&null!=e&&d!=e){var g={sendName:b,messageContent:c,facePrice:f};a.post(pageConfig.zibianMsg,g,function(b){a("#messageFilterContent").html(b).attr("style","word-wrap:break-word;white-space:normal;")})}a("#i-preview").show()}).mouseout(function(){a("#i-preview").hide()}),a("#selectZhiBianWord").delegate("select","change",function(){var b=a(this).val();a("#inputMessageArea").val(b),a("#inputSendName").css("color","#999")})}(jQuery),$.fn.suggest=function(a){function b(a,b){return 0==a.lastIndexOf(b,0)}function c(a){for(var c=0;h.length>c;c++)if(b(h[c],a))return!0;return!1}function d(a){return a>=48&&57>=a?!0:a>=96&&105>=a?!0:8==a?!0:!1}var e=a.callbackClick,f=$('<div class="num-big">'),g="";if(g)var h=g.replace(/"/g,"").split(",");this.each(function(){function a(){if(g){for(var a="",b=h.length,c=0;b>c;c++){var d=h[c];a+='<li><div class="fl">'+d+'</div><div class="fr" data-num='+d+">X</div></li>"}a="<ul>"+a+"</ul>",l.append(a)}}function b(a,b){setTimeout(function(){parseInt(a,10);var c=a.substring(0,3),d=a.substring(3,7),e=a.substring(7,11),g="";c.length&&(g=3>c.length?c:c+"-"),d.length&&(g+=4>d.length?d:d+"-"),e.length&&(g+=e),11>=a.length&&0!=a.length?(f.text(g).appendTo(j).show(),11==a.length&&b&&setTimeout(function(){f.remove()},200)):f.remove()},50)}function i(){l.hide(),f.hide()}var j=$(this),k=j.find("input"),l=j.find(".i-list");k.keyup(function(a){var e=k.val();return""==e?(f.remove(),void l.hide()):g&&c(e)?(l.find("li").each(function(){$(this).find(".fl").text().match("^"+e)?$(this).show():$(this).hide()}),l.show(),void f.hide()):(l.hide(),d(a.keyCode)?void b(e,!0):!1)}).click(function(){var a=k.val();b(a,!1)}),l.delegate("li","mouseenter",function(){var a=$(this);a.addClass("hover")}).delegate("li","mouseleave",function(){$(this).removeClass("hover")}).delegate("li","click",function(){var a=$(this);k.val(a.find(".fl").text()),e&&e.call(k,k.val()),i()}).delegate(".fr","click",function(){var a=$(this);a.parent("li").remove()});var m=j.find(".arrow");m.click(function(){k.css("color","#333"),l.show(),f.hide()}),$(document).click(function(a){var b=a.target;b==m[0]||$(b).parents().hasClass("i-list")||i()});try{window.top!==window&&$(window.top.document).bind("click",i)}catch(n){}a()})};
